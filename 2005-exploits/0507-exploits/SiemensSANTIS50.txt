Secure Network - Security Research Advisory

Vuln name: [Siemens SANTIS 50 Authentication Vulnerability]

Systems affected:
Siemens Santis 50 Wireless router (firmware version: 4.2.8.0)

Likely to be affected:
Ericsson HN294dp
Dynalink RTA300W

Severity: medium risk
Local/Remote: Remote (limited to the LAN, with default configuration)
Vendor URL: http://www.dynalink.com.au/modemsadsl_dis.htm?prod=RTA300W#
                    http://help.virgilio.it/guide/index.jsp? id=5080&id_figlio=5541  (italian Internet provider)

Author(s): Luca Carettoni - luca.carettoni@securenetwork.it

Vendor disclosure: 17th July 2005
Vendor acknowledged: Not acknowledged
Public disclosure: 25th July 2005
Advisory number: SN-2005-01
Advisory URL: http://www.securenetwork.it/advisories/

*** SUMMARY ***

The Siemens Santis 50 Wireless router is a wi-fi (802.11b) ADSL router. It's a complete system for home and small business networks in a single device.

Some features include:
- Integrated WLAN for internet sharing
- ADSL Modem/Router/Firewall/Switch
- 10/100 Mbps 4 port switch built in
- Stateful packet inspection (SPI) firewall
- Wireless Access Point
- VPN passthrough

Telecom Italia Net (one of the largest italian Internet providers) delivers this device to its ADSL customers, so in Italy it's a common device used in SOHO and SMB networks.

The Siemens Santis50, the Ericsson HN294dp and the Dynalink RTA300W devices share the same hardware, so it's very likely that they share this vulnerability. The original project of these products was from Askey. The firmware software is from VirataGlobespan, bought by Conexant.

The tested (vulnerable) version of firmware is the 4.2.8.0

This bug provides access to the management CLI, without  authentication, after a DOS attack to a specific service port.

*** VULNERABILITY DETAILS ***

This device provides a web management interface and the classic telnet CLI for administration purposes. By default these services are available only from the local network, but can be optionally activated also on the WAN interface.

Sending trigger packets to the management port (280/http-mgmt), the device "freezes" the web interface, allowing unauthenticated  connection to the telnet CLI.

This behavior appears to be some sort of "disaster recovery mode". The set of available commands is limited to a few, but they are enough to discover informations about the configuration of the device and connections (events, traffic, ethernet addresses configuration, etc). Also critical commands like "irreversibly erase FLASH contents" are available.

*** EXPLOIT ***

A simple exploit is to use the application scanner AMAP (kudos to THC, www.thc.org).
Mojito:~ LuCa$ amap x.x.x.x 280

*** FIX INFORMATION ***

A vendor-provided fix is currently unavailable. An upgrade to a more recent version of firmware (v5.2.2 is currently available) could help, but we are unable to test this version.

An obvious workaround (and good practice) is to disable the management interface on the WAN, this obviously blocks this attack from external attackers.

*********************
*** LEGAL NOTICES ***
*********************

Secure Network (www.securenetwork.it) is an information security  company,
which provides consulting and training services, and engages in security
research and development.

We are committed to open, full disclosure of vulnerabilities,  cooperating
with software developers for properly handling disclosure issues.

This advisory is copyright © 2005 Secure Network S.r.l. Permission is
hereby granted for the redistribution of this alert, provided that it is
not altered except by reformatting it, and that due credit is given. It
may not be edited in any way without the express consent of Secure  Network
S.r.l. Permission is explicitly given for insertion in vulnerability
databases and similars, provided that due credit is given to Secure  Network

The information in the advisory is believed to be accurate at the  time of
publishing based on currently available information. This information is
provided as-is, as a free service to the community by Secure Network
research staff. There are no warranties with regard to this information.
Secure Network does not accept any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on,
this information.

If you have any comments or inquiries, or any issue with what is  reported
in this advisory, please inform us as soon as possible.

E-mail: securenetwork@securenetwork.it
GPG/PGP key: http://www.securenetwork.it/pgpkeys/Secure%20Network.asc
Phone: +39 0363 560 402
