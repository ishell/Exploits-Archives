
-- Corsaire Security Advisory --

Title: SAP Internet Graphics Server traversal issue
Date: 03.05.05
Application: SAP prior to version 6.40 Patch 11
Environment: Various
Author: Martin O'Neal [martin.oneal@corsaire.com]
Audience: General distribution
Reference: c050503-001


-- Scope --

The aim of this document is to clearly define a vulnerability in the
Internet Graphics Server application, as supplied by SAP. [1], that
would allow unauthenticated access to files outside of the web root.


-- History --

Discovered: 03.05.05 (Martin O'Neal)
Vendor notified: 11.05.05
Document released: 25.07.05

Interestingly, SAP have declined to share any information they have on
this issue, even to the extent of refusing to allow Corsaire to see the
official SAP advisory; stating that it is "SAP's policy to make it
available to their customers only". It is always a pleasure to enter
into a constructive dialog with industry professionals.


-- Overview --

The Internet Graphics Server (IGS) is a subcomponent of the SAP R/3
enterprise environment, which is accessible over HTTP via a minimalist
web server component.

By entering an HTTP document path that incorporates a directory
traversal (../..) sequence, documents outside of the web root can be
accessed with the privileges of the user that was used to start the IGS
service.


-- Analysis --

The IGS product does not appear to validate the document path that is
passed to it, prior to using operating system functions to access and
retrieve the documents.


-- Proof of Concept -

The exact path required to perform the traversal is dependent on the
actual implementation of the product, and the directory to which it is
installed. On the HP-UX platform, a working traversal path is:

http://host/htdocs/../../../../../../../../../../../../etc/passwd


-- Recommendations --

Upgrade to the latest version of the SAP IGS software, version 6.40
Patch 11.

Note: Corsaire has not had the opportunity to examine the patch, so can
not vouch for whether it truly resolves the validation issues, or merely
obscures them.

If the IGS component is not required, it can be deactivated using the
process described in SAP Note 862169.


-- CVE --

The Common Vulnerabilities and Exposures (CVE) project has assigned the
name CAN-2005-1691 to this issue. This is a candidate for inclusion in
the CVE list (http://cve.mitre.org), which standardises names for
security problems.


-- References --

[1] http://www.sap.com


-- Revision --

a. Initial release.
b. Revised to include SAP patch information.
c. Revised to include SAP patch version.


-- Distribution --

The information contained within this advisory is supplied "as-is" with
no warranties or guarantees of fitness of use or otherwise. Corsaire
accepts no responsibility for any damage caused by the use or misuse of
this information.


-- Disclaimer --

The information contained within this advisory is supplied "as-is" with
no warranties or guarantees of fitness of use or otherwise. Corsaire
accepts no responsibility for any damage caused by the use or misuse of
this information.


-- About Corsaire --

Corsaire are a leading information security consultancy, founded in 1997
in Guildford, Surrey, UK. Corsaire bring innovation, integrity and
analytical rigour to every job, which means fast and dramatic security
performance improvements. Our services centre on the delivery of
information security planning, assessment, implementation, management
and vulnerability research.

A free guide to selecting a security assessment supplier is available at
http://www.penetration-testing.com


Copyright 2005 Corsaire Limited. All rights reserved.


