SYSCP WEBFTP LOCAL FILE INCLUSION VULNERABILITY

Thomas Henlich

DESCRIPTION

Thomas Henlich has discovered a vulnerability in WebFTP, which can be
used by remote attackers to disclose potentially sensitive information
and to compromise a vulnerable system.

Input passed to the "webftp_language" parameter in "webftp.php" isn't
properly validated before being used to include files. This can be
exploited to include arbitrary files from local sources.

Successful exploitation allows execution of arbitrary local PHP scripts
on a vulnerable server with privileges of the web server daemon without
requiring authentication.

BACKGROUND

SysCP is an open-source shared server management tool for Linux servers.
The WebFTP module is a SysCP module which provides a Web interface to
manage files on a FTP server. WebFTP can be used independently from a
SysCP installation.

AFFECTED VERSIONS

- WebFTP 1.2.6
- possibly earlier versions as well component

RESOLUTION

Upgrade to version 1.2.8 or higher.

PROOF OF CONCEPT

Perform a POST request to webftp.php with a variable
webftp_language=../../<some_file>%%00

TIMELINE

2005-12-01: Initial vendor notification.
2005-12-01: Initial vendor reply.
2005-12-07: Bugfix available.
2006-01-04: Public disclosure.



