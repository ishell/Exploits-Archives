PR10-17: Various XSS and information disclosure flaws within KeyFax
response management system

http://www.omfax.co.uk

Vulnerability found: 25th August 2010

Vendor informed:

Vulnerability fixed:

Severity: Medium/High

Description:

KeyFax response management system provides professional management of
housing and other repairs; KeyFax is normally accessed using a web
browser over port 80. Various KeyFax pages are vulnerable to a
reflective XSS attacks. Other pages including the configuration file
disclose information including the operator and SQL account passwords.

Version 3.2.2.6 dated 2003-2010

The following demonstrate the XSS flaws (no authentication needed):
1) Various pages are vulnerable to XSS  (IE only)
http://target-domain.foo/keyfax32/test/response.asp?co="style%3d"x:expression(alert(1))""%20";

http://target-domain.foo/keyfax32/rs/main_rs.asp?C="style%3d"x:expression(alert(1))""%20";


Consequences:

An attacker may be able to cause execution of malicious scripting code
in the browser of a user who clicks on a link to a KeyFax response
management system based site. Such code would run within the security
context of the target domain. This type of attack can result in
non-persistent defacement of the target site, or the redirection of
confidential information (i.e.: session IDs) to unauthorised third parties.

---------------------------------------------------------------------------------------------------------------

The following demonstrate the Information disclosure flaws (no
authentication needed)

1) Account passwords can be remotely retrieved, by knowing the path of
the configuration file.

http://target-domain.foo/KFLauncher/KF_config.xml (this also contains
other username and password combinations like operator)
http://target-domain.foo/KFLauncher/KFRDROL_target-domain_config.xml

These contain the following information:-

http://target-domain.foo/kfdataview/password.asp?user=operator&pwd=operator

Provider=SQLOLEDB.1;Password=omfax;Persist Security Info=True;User
ID=keyfax;Initial Catalog=KF_target-domain_ROL_32;Data
Source=target-domain.foo

2) Information about the web site is publically disclosed by the debug
console.

http://target-domain.foo/keyfax32/includes/debug.asp

And within verbose error pages
http://target-domain.foo/keyfax32/request_sa_fl.asp?user=.

Consequences:

An attacker may be able to obtain additional information on the machines
configuration including user names and passwords, and use this
information to gain authenticated access.


Fix:


References:

http://www.procheckup.com/Vulnerabilities.php



Credits: Richard Brain of ProCheckUp Ltd (www.procheckup.com)


Legal:

Copyright 2010 ProCheckUp Ltd. All rights reserved.

Permission is granted for copying and circulating this Bulletin to the
Internet community for the purpose of alerting them to problems, if and
only if, the Bulletin is not edited or changed in any way, is attributed
to ProCheckUp, and provided such reproduction and/or distribution is
performed for non-commercial purposes.

Any other use of this information is prohibited. ProCheckUp is not
liable for any misuse of this information by any third party.
