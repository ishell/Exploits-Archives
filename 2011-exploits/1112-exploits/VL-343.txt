Title:
======
Whois Cart Billing - Multiple Web Vulnerabilities


Date:
=====
2011-12-22


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=343


VL-ID:
=====
343


Introduction:
=============
Whois.Cart() is a client/administrator tool that facilitates the many tasks involved in running an efficient
webhosting and domain registration business. The system will surgically undertake every aspect of your client
transactions; first the sale (which is most important and most overlooked), the collection of money, the
registration/transfer/renewal of domains, the provisioning of hosting space, and lastly the maintenance of all
these. A cumulation of countless development hours and thousands of user suggestions, Whois.Cart() is a
full-featured system that has retained the clean and simple ethic that most of its equal-featured competing
products have lost. It will undoubtedly become the most natural and effective resource with which you will
ever complement your business.

(Copy of the Vendor Homepage: http://whoiscart.net/product.php)


Abstract:
=========
The Vulnerability Laboratory Research Team discovered multiple vulnerabilities on the Whois.Cart Hosting Billing Solution Software.


Report-Timeline:
================
2011-11-21:	Vendor Notification
2011-12-22:	Public or Non-Public Disclosure


Status:
========
Published


Exploitation-Technique:
=======================
Remote


Severity:
=========
High


Details:
========
1.1
Multiple persistent input validation vulnerabilities are detected on the Whois.Cart Hosting Billing Solution Software.
The vulnerability allows an remote attacker or local low privileged user account to inject persistent script code like JS/HTML.
Successful exploitation can result in session hijacking, phishing & persistent content manipulation.

Vulnerable Module(s):
								[+] hostinginterfaces
								[+] domain ordering

Picture(s):
								../hostinginterfaces.png
								../xss-whoiscart.png


1.2
Another vulnerability was detected on the Whois.cart Software, and it allow a remote attacker to read all the customers cPanel
logins and passwords without encryption.


Vulnerable Module(s):
								[+] cPanel Log 


Proof of Concept:
=================
The vulnerability can be exploited by remote attackers with required user inter action or by local low privileged user accounts. 
For demonstration or reproduce ...

1.1

								[*] Persistant Cross Site Scripting

Vulnerable Module(s):
								[+] Order - Choose domain name

Review: Order page

<tr><th>Domain Setup("><script>alert(VLAB);</script>)</th><th>Price -$ 0</th><th><ahref='
delete.php?delid=401'>Delete From Cart</a></th></tr><tr><td colspan='3'></td></tr><tr><th>P1(
"><script>alert("Me!ster");</script>								<= [x]
)</th><th>Price Monthly-$ 100<br>Price Yearly-$ 1000</th><th><a href='delete.php?delid=400'>
Delete From Cart</a></th></tr><tr><td colspan='3'>P1</td></tr>


1.2
								[*] cPanel Log 

Reference(s):
http://www.[SERVER].com/whoiscart/admin/hostinginterfaces/cpanel_2_log.htm


Risk:
=====
The security risk of the persistent input validation vulnerabilities are estimated as High(-).
The security risk of the cp log access rights are estimated as low(+).


Credits:
========
Vulnerability Research Laboratory - Chokri B.A. (Me!ster)


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability-
Lab. Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of 
other media, are reserved by Vulnerability-Lab or its suppliers.

    						Copyright © 2011|Vulnerability-Lab




-- 
Website: www.vulnerability-lab.com ; vuln-lab.com or vuln-db.com
Contact: admin@vulnerability-lab.com or support@vulnerability-lab.com

