[DSECRG-11-011] SAP Crystal Reports 2008 - Multiple XSS 

SAP Crystal Report Server 2008 - multiple cross-site scripting vulnerabilities. 

SAP Crystal Report Server 2008 - Multiple cross-site scripting vulnerabilities. [DSecRG-11-011] (Internal DSECRG-00147) 


Multiple XSS vulnerabilities found in the module PerformanceManagement application SAP Crystal Report Server 2008. An attacker can intercept the cookie administrator or regular user of the system. 

Application: SAP Crystal Report Server 2008 
Versions Affected: SAP Crystal Report Server 2008 
Vendor URL:      http://www.sap.com 
Bugs: Linked XSS Vulnerability 
Exploits:        YES 
Reported: 06.08.2010 
Vendor response: 07.08.2010
Date of Public Advisory: 09.03.2011
Authors:         Dmitriy Chastuhin 
Digital Security Research Group [DSecRG] (research [at] dsecrg [dot] com) 

Details 
******* 
Using the discovered vulnerabilities, an attacker can intercept the cookie and perform any administrative actions in the system on its behalf. 

1. cross-site scripting vulnerability found in script aa-add-analytic2.jsp 
Vulnerable GET parameter "backURL"
2 cross-site scripting vulnerability found in script aa-add-validate.jsp 
Vulnerable GET parameter "pagePos" 
3 cross-site scripting vulnerability found in script aa-analytic-frameset.jsp.jsp 
Vulnerable GET parameter "entry" 
4 cross-site scripting vulnerability found in script aa-cacheparams.jsp 

Vulnerable GET parameters "MetaDataCachePeriod", "AppBuilderCachePeriod", "SessionCachePeriod", "RefreshDashboardPeriod" 
5 cross-site scripting vulnerability found in script aa-display-flash.jsp 
Vulnerable GET parameter "swf" 
6 cross-site scripting vulnerability found in script aa-dmgraph.jsp 
Vulnerable GET parameter "Sel" 
7 cross-site scripting vulnerability found in script aa-edit-goal.jsp 
Vulnerable GET parameter "defTar" 
8 cross-site scripting vulnerability found in script aa-map-frameset.jsp 
Vulnerable GET parameter "analyticToken" 
9 cross-site scripting vulnerability found in script aa-open-inlist.jsp 
Vulnerable GET parameters "url", "sWindow", "BEGIN_DATE", "END_DATE", "CURRENT_DATE", "CURRENT_SLICE" 
10 cross-site scripting vulnerability found in script aa-overviewctxt.jsp 
Vulnerable GET parameters "DocName", "Label" 


Example:
******
Working exploit will be available in commercial scanner ERPSCAN security scanner for SAP (ERPSCAN.com).

References
**********
http://dsecrg.com/pages/vul/show.php?id=311
http://www.sdn.sap.com/irj/sdn/index?rid=/webcontent/uuid/c05604f6-4eb3-2d10-eea7-ceb666083a6a
https://service.sap.com/sap/support/notes/1509610


Fix Information
*************
Solution to this issue is given in the 1509610 security note.

About
*****
Digital Security: 
Is one of the leading IT security companies in CEMEA, providing information security consulting, audit and penetration testing services, ERP and SAP security assessment, certification for ISO/IEC 27001:2005 and PCI DSS and PA DSS standards.

Digital Security Research Group:
International subdivision of Digital Security company focused on research and software development for securing business-critical systems like: enterprise applications (ERP,CRM,SRM), technology systems (SCADA, Smart Grid) and banking software. DSecRG developed new product "ERPSCAN security suite for SAP" and service "ERPSCAN Online" which can help customers to perform automated security assessments and compliance checks for SAP solutions.

Contact: research [at] dsecrg [dot] com
http://www.dsecrg.com
http://www.erpscan.com



Polyakov Alexandr. PCI QSA,PA-QSA
CTO Digital Security
Head of DSecRG
______________________
DIGITAL SECURITY
phone:  +7 812 703 1547
        +7 812 430 9130
e-mail: a.polyakov@dsec.ru  

www.dsec.ru
www.dsecrg.com www.dsecrg.ru
www.erpscan.com www.erpscan.ru
www.pcidssru.com www.pcidss.ru


-----------------------------------
This message and any attachment are confidential and may be privileged or otherwise protected 
from disclosure. If you are not the intended recipient any use, distribution, copying or disclosure 
is strictly prohibited. If you have received this message in error, please notify the sender immediately 
either by telephone or by e-mail and delete this message and any attachment from your system. Correspondence 
via e-mail is for information purposes only. Digital Security neither makes nor accepts legally binding 
statements by e-mail unless otherwise agreed. 
-----------------------------------
