Title:
======
WhiteHouse Gov Service - Persistent Web Vulnerability


Date:
=====
2011-11-04


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=308


VL-ID:
=====
308


Introduction:
=============
http://www.whitehouse.gov/


Abstract:
=========
The vulnerability-lab researcher (F0x23 & Rem0ve) discovered a persistent script code injection vulnerability on the WhiteHouse Gov website.


Report-Timeline:
================
2011-11-01:     Vendor Notification
2011-11-03:     Vendor Response/Feedback
2011-11-04:     Vendor Fix/Patch
2011-11-04:     Public or Non-Public Disclosure


Status:
========
Published


Exploitation-Technique:
=======================
Remote


Severity:
=========
High


Details:
========
A persistent script code injection vulnerability is detected on the WhiteHouse Gov website. The vulnerability allows remote 
attackers to implement/inject own malicious script code (persistent) on a web service main module of the website. The successful 
exploitation of the vulnerability results in hijacking of user-,admin- or -backend sessions, manipulation of profile content, 
redirect to external malicious targets(websites), defacement & can lead to malware infiltration via petition.


Vulnerable Module(s):
				                        [+] Profil - Location Input

Affected Module(s):
							[+] Petition - Add, Share & Sign

Picture(s):
			                              	../1.png


Proof of Concept:
=================
The vulnerabilities can be exploited by remote attackers. For demonstration or reproduce ...

PoC:
<div class="entry entry-creator ">  
    <div class="title">creator</div>    
    <div class="name">Bernd N</div><!--/name-->
    <div class="details">
      "'><INJECT/EXECUTE PERSISTENT SCRIPT CODE HERE!!><br>
      October 31, 2011<br>
      Signature # 1    </div>
          </div>
      </div>

Reference: https://wwws.whitehouse.gov/petitions/!/petition/hey/VLsNrtR1


INPUT FORM:
<span>City: </span></label>
 <input maxlength="255" name="profile_city" id="edit-profile-city" size="60" value="VA" class="form-text" type="text">
</div>
<input name="form_id" id="edit-user-profile-form" value="user_profile_form" type="hidden">
<div class="form-item clearfix" id="edit-profile-state-wrapper">
 <label for="edit-profile-state"><span>State: </span>

Reference: https://wwws.whitehouse.gov/user/5034619/edit/Personal%20Information


PoC:
                                            ../PoC.txt
                                            ../PoC-Full.txt
                                            ../PoC-Input.txt
                                            ../Reference.txt


Risk:
=====
The security risk of the persistent script code inject is estimated as high(+).


Credits:
========
Vulnerability Research Laboratory -  Alexander Fuchs (F0x23) &  Benjamin Kunz Mejri (Rem0ve)


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability-
Lab. Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of 
other media, are reserved by Vulnerability-Lab or its suppliers.

    						Copyright © 2011|Vulnerability-Lab




-- Website: www.vulnerability-lab.com ; vuln-lab.com or vuln-db.com
Contact: admin@vulnerability-lab.com or support@vulnerability-lab.com

-- 
Website: www.vulnerability-lab.com ; vuln-lab.com or vuln-db.com
Contact: admin@vulnerability-lab.com or support@vulnerability-lab.com

