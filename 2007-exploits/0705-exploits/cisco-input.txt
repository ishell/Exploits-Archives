Cisco CallManager 4.1 Input Validation Vulnerability

scip AG Vulnerability ID 2977 (03/13/2007)
http://www.scip.ch/cgi-bin/smss/showadvf.pl?id=2977

I. INTRODUCTION

Cisco CallManager, short CCM, is a professional voice-over-IP solution
that tracks active components, including among others phones, gateways,
conference bridges, transcoding resources and voicemail boxes.

II. DESCRIPTION

Marc Ruef and Stefan Friedli found a web-based vulnerability that was
identified in Cisco CallManager 4.1 and may affect earlier versions as well.

The web interface of the application fails to properly santisize data
supplied by the search-form before displaying it back to the user.
Though several filters are in place to prevent the injection of <script>
Tags or action handlers such as "onclick" or "onmouseover", it is
possible to inject html-code including common attributes. This allows
the embedding of external references, e.g. images or flash resources.
The vulnerability also allows an attacker to use the "style"-attribute
on any tag to conduct arbitrary web-based attacks.

Example:
https://example.com/CCMAdmin/serverlist.asp?findBy=servername&match=begins&pattern=<img%20src='http://www.scip.ch/scip.gif'%20style='border:%201px%20solid%20black;'>

IV. IMPACT

This vulnerability may be exploited by tricking authenticated users into
clicking a crafted link in order to conduct arbitrary web-based attacks.

V. DETECTION

Detection of web based attacks requires a specialized web proxy and/or
intrusion detection system. Patterns for detection of basic attacks are
available and easy to implement, though they may possibly fail on more
sophisticated attacks.

VI. SOLUTION

Server-side input validation should be improved to prevent the injection
of unauthorized code. Cisco has taken appropriate steps regarding this
issue, see vendor response (VII) for details.

VII. VENDOR RESPONSE

A representative of the Cisco Product Security Incident Response Team
(PSIRT) stated, that this kind of exploitation is blocked by
improvements to the web application firewall used in CallManager. The
Cisco PSIRT team has issued a formal security response available at:
http://www.cisco.com/warp/public/707/cisco-sr-20070523-ccm.shtml.

VIII. SOURCES

scip AG - Security Consulting Information Process (german)
http://www.scip.ch

scip AG Vulnerability Database (german)
http://www.scip.ch/cgi-bin/smss/showadvf.pl?id=2977

IX. DISCLOSURE TIMELINE

03/13/07        Identification of the vulnerabilities
03/13/07        Notification of the vendor
03/14/07        Response from Mark-David McLaughlin [marmclau@cisco.com]
of the PSIRT
03/19/07        Status Notification by PSIRT
03/28/07        Status Notification by PSIRT
04/18/07        Status Notification by PSIRT
04/20/07        Status Notification by PSIRT
05/02/07        Status Notification by PSIRT
05/05/07        Coordination of public release
05/16/07        Final Vendor Response received
05/23/07        Public Release

IX. CREDITS

The vulnerabilities were discovered by Marc Ruef and Stefan Friedli.

     Marc Ruef, scip AG, Zuerich, Switzerland
     maru-at-scip.ch
     http://www.scip.ch

     Stefan Friedli, scip AG, Zuerich, Switzerland
     stfr-at-scip.ch
     http://www.scip.ch

     Thanks to Mark-David McLaughlin (PSIRT) for cooperating.


A2. LEGAL NOTICES

Copyright (c) 2007 scip AG, Switzerland.

Permission is granted for the re-distribution of this alert. It may not
be edited in any way without permission of scip AG.

The information in the advisory is believed to be accurate at the time
of publishing based on currently available information. There are no
warranties with regard to this information. Neither the author nor the
publisher accepts any liability for any direct, indirect or
consequential loss or damage from use of or reliance on this advisory.


