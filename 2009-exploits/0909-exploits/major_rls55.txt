[MajorSecurity Advisory #55]moziloCMS - Directory Traversal, Cross Site Scripting and Session Fixation Issues

Details
=======
Product: moziloCMS
Security-Risk: high
Remote-Exploit: yes
Vendor-URL: http://cms.mozilo.de/
Vendor-Status: informed
Advisory-Status: published

Credits
============
Discovered by: David Vieira-Kurz
http://www.majorsecurity.info

Affected Products:
----------------------------
moziloCMS 1.10.1 and prior

Original Advisory:
============
http://www.majorsecurity.info/index_2.php?major_rls=major_rls55

Introduction
============
moziloCMS is an easy to handle content management system which works without database.

More Details
============
1. directory traversal:
---------------------
Input passed to the "file" parameter in "download.php" and to the 
"page" parameter in "index.php"is not properly verified, 
before it is used to execute the given arguments.
Acquiring access to known files outside of the web root and current directory
is possible through directory traversal techniques.
This is made possible through the use of "../../" in a HTTP request.

2. cross site scripting:
---------------------
-Input passed directly to the "gal" parameter in "gallery.php" is not properly sanitised before being returned to the user.
This can be exploited to execute arbitrary HTML and script code in a user's browser session in context of an affected site.

3. session fixation:
---------------------
The "PHPSESSID" parameter can be set to a malicious and arbitrary value.
3.1 Description:
In a session fixation attack, the attacker fixes the user's session ID before the user even logs into the target server.
After a user's session ID has been fixed, the attacker will wait for them to login.
Once the user does so, the attacker uses the predefined session ID value to assume their online identity.

Solution
=============
The Vendor has released a patch which fixes these vulnerabilities. Update to version 1.11.2.
Major thanks to Arvid of the Mozilo CMS developer team for the professional communication while 
reporting the security issues.

History/Timeline
================
16.06.2009 discovery of the vulnerabilities
16.06.2009 additional tests with other versions
17.06.2009 contacted the vendor
07.07.2009 vendor released a hotfix
21.09.2009 advisory is written
22.09.2009 MajorSecurity releases a coordinated disclosure advisory

MajorSecurity
================
MajorSecurity is a German pentest and security research project which focuses on web application security.
You can find more Information on the MajorSecurity Project at
http://www.majorsecurity.info/pentest.php
