Title:
======
Air Transfer v1.2.0 iPad iPhone - File Include Vulnerability


Date:
=====
2013-02-14


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=849


VL-ID:
=====
849


Common Vulnerability Scoring System:
====================================
6.3


Introduction:
=============
Just Drag & Drop your contents and Play: Text, Bookmark, Image and Photo, Music, Movie, Documents and more through wireless connection !
Air Transfer moves what you`re seeing or playing on Mac/PC to your iPhone/iPad with just single drag&drop! It moves whatever you want; 
text memo, website address, photo, music, movie, document and so on. The transferred items are auto-classified into 7-categories 
according to their type. You can also see or play the items in Air Transfer right away! Air Transfer works even in background mode, 
you can switch to other apps without stopping current transfer.

(Copy of the Homepage: https://itunes.apple.com/de/app/air-transfer/id521595136 )


Abstract:
=========
The Vulnerability Laboratory Research Team discovered a local file include vulnerability in the mobile Air Transfer v1.2.0 app for the apple ipad & iphone.


Report-Timeline:
================
2013-02-14:	Public Disclosure


Status:
========
Published


Affected Products:
==================
Apple AppStore
Product: Air Transfer Application - (iPad & iPhone) 1.2.0


Exploitation-Technique:
=======================
Remote


Severity:
=========
High


Details:
========
A local file include web vulnerability via POST request method is detected in the mobile WirelessFiles v1.1 app for the apple ipad & iphone.
The vulnerability allows remote attackers via POST method to inject local app webserver folders to request unauthorized local webserver files.

The vulnerbility is located in the upload file module of the webserver (http://192.168.0.10/) when processing to load a manipulated 
filename via POST. The execution of the injected path or file request will occur when the attacker is opening the generated links in the 
file dir listing. First the remote attacker drag&drop (copy) a manipulated link with system path or local files to request. He adds the local 
file request and in the secound step the attacker opens the generated link in the listing to execute the code out of the index module.

Exploitation of the web vulnerability requires low privileged application user account without user interaction.
Successful exploitation of the vulnerability results in unauthorized path or file access via local file or path include attack.


Vulnerable Application(s):
				[+] Air Transfer v1.2.0 - ITunes or AppStore (Apple)

Vulnerable Module(s):
				[+] File Upload

Vulnerable Function(s):
				[+] Drag&Drop & Listing (Web Server) [Remote]

Vulnerable Parameter(s):
				[+] name (Drop Web Addr Here)
				[+] filename (Drop Web Addr Here)

Affected Module(s):
				[+] Air Transfer Filename Index - Listing


Proof of Concept:
=================
The local file include web vulnerability can be exploited by remote attackers without required user interaction and with 
privileged application user account. For demonstration or reproduce ...


Input: (Upload)
http://192.168.0.10:8080/Upload

Example:
http://[Server]:[PORT]/[Local File or Path Include]

PoC:
http://192.168.0.10:8080/var/mobile/Applications/2D31A1B7-6A58-42CE-A5B2-EB7307BE5B6F/AirScrap2%20Lite.app/note.png
../var/mobile/Applications/2D31A1B7-6A58-42CE-A5B2-EB7307BE5B6F/AirScrap2 Lite.app/note.png

--- POST ---
=-----------------------------19781325924485
Content-Disposition: form-data; name=``[Local File or Path Include]``; filename=``[Local File or Path Include].jpg``
Content-Type: image/jpeg
ÿØÿà
192.168.0.10:8080 
---


Manually steps to reproduce ...

1.  Buy the application Air Transfer of the apple app store
2.  Install the application and start it the service on your ipad or iphone
3.  Open the air transfer file dir service application  http://192.168.0.10:8080/ 
5.  Start your browser session tamper tool to manipulate the post request live
4.  Use the Drag&Drop function to upload via http://192.168.0.10:8080/Upload and choose any random file
5.  Submit the random picture and exchange the name and filename values (POST) with your local path or file request
7.  Refresh the index listing of the main service http://192.168.0.10:8080 and open the generated link with your path/file request
8.  The path or file will be loaded and is accessable
9.  The application can be compromised by mobile webshell uploads and other malicious and persistent injected context
10. Successful reproduced ... done!


Risk:
=====
The security risk of the local file include web vulnerability is estimated as high(+).


Credits:
========
Vulnerability Laboratory [Research Team]  -    Benjamin Kunz Mejri (bkm@vulnerability-lab.com)


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. We do not approve or encourage anybody to break any vendor licenses, policies, deface websites, hack into databases 
or trade with fraud/stolen material.

Domains:    www.vulnerability-lab.com   	- www.vuln-lab.com			       - www.vulnerability-lab.com/register
Contact:    admin@vulnerability-lab.com 	- support@vulnerability-lab.com 	       - research@vulnerability-lab.com
Section:    video.vulnerability-lab.com 	- forum.vulnerability-lab.com 		       - news.vulnerability-lab.com
Social:	    twitter.com/#!/vuln_lab 		- facebook.com/VulnerabilityLab 	       - youtube.com/user/vulnerability0lab
Feeds:	    vulnerability-lab.com/rss/rss.php	- vulnerability-lab.com/rss/rss_upcoming.php   - vulnerability-lab.com/rss/rss_news.php

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. 
Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other 
media, are reserved by Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, sourcecode, videos and 
other information on this website is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), 
modify, use or edit our material contact (admin@vulnerability-lab.com or support@vulnerability-lab.com) to get a permission.

    				   	Copyright © 2013 | Vulnerability Laboratory

-- 
VULNERABILITY RESEARCH LABORATORY
LABORATORY RESEARCH TEAM
CONTACT: research@vulnerability-lab.com

