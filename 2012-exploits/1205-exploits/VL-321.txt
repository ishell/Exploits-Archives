Title:
======
China Ministry of Commerce - SQL Injection Vulnerability


Date:
=====
2012-05-01


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=321


VL-ID:
=====
321


Introduction:
=============
The Ministry of Commerce (MOFCOM; Chinese: &#21830;&#21153;&#37096; Pinyin: sh&#257;ngwù bù) of the People s
Republic of China , formerly Ministry of Foreign Trade and Economic Co-operation
(&#23545;&#22806;&#36152;&#26131;&#32463;&#27982;&#21512;&#20316;&#37096;, MOFTEC) is an executive agency of the State Council of China. It is
responsible for formulating policy on foreign trade, export and import regulations,
foreign direct investments, consumer protection, market competition and negotiating
bilateral and multilateral trade agreements. The current Commerce minister is Chen Deming.

(Copy of the Vendor Homepage: http://en.wikipedia.org/wiki/Ministry_of_Commerce_of_the_People s_Republic_of_China )


Abstract:
=========
The vulnerability-lab researcher discovered an SQL Injection vulnerability on the Chinese Ministry of Commerce website.


Report-Timeline:
================
2011-11-11:	Vendor Notification
2012-02-12:	Vendor Response/Feedback
2011-04-30:	Vendor Fix/Patch by Check
2011-05-01:	Public or Non-Public Disclosure


Status:
========
Published


Exploitation-Technique:
=======================
Remote


Severity:
=========
Critical


Details:
========
A SQL Injection vulnerability is detected on the Chinese Ministry of Commerce website. 
Remote Attackers & low privileged user accounts can execute own sql commands via injection. Successful exploitation can 
result in dbms (Server) or application (Web) compromise.

Vulnerable Module(s):
								[+] ssl_login.php

Vulnerable Para(s):		
								[+] F_email , F_password


Proof of Concept:
=================
The SQL Injection vulnerabilities can be exploited by remote attackers (pre-auth) or local low privileged user accounts.
For demonstration or reproduce ...

[*] SQL Injection via POST METHOD

Site:		mofcom.gov.cn/ssl_login.php
Path:		/
File:		ssl_login.php
Para:		F_email & F_password

Picture(s):
					../1.jpg


Solution:
=========
CLOSED BY COORDINATION OF CHINA NATIONAL VULNERABILITY DATABASE FOR INFORMATION SECURITY (CNNVD PARTNERS).



Risk:
=====
The security risk of the pre-auth SQL injection vulnerability is estimated as critical.


Credits:
========
Vulnerability Laboratory [Research Team]  -  Chokri Ben Achor (meister@vulnerability-lab.com)


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability-
Lab. Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of 
other media, are reserved by Vulnerability-Lab or its suppliers.

    						Copyright © 2012 Vulnerability-Lab

-- 
VULNERABILITY RESEARCH LABORATORY TEAM
Website: www.vulnerability-lab.com
Mail: research@vulnerability-lab.com

