1. OVERVIEW

CubeCart 4.4.6 and lower versions are vulnerable to Cross Site Scripting.


2. BACKGROUND

CubeCart is an "out of the box" ecommerce shopping cart software
solution which has been written to run on servers that have PHP &
MySQL support. With CubeCart you can quickly setup a powerful online
store which can be used to sell digital or tangible products to new
and existing customers all over the world.


3. VULNERABILITY DESCRIPTION

Multiple parameters are not properly sanitized, which allows attacker
to conduct Cross Site Scripting attack. This may allow an attacker to
create a specially crafted URL that would execute arbitrary script
code in a victim's browser.


4. VERSIONS AFFECTED

4.4.6 and lower


5. Affected URLs and Parameters

/admin.php (countiesPage parameter)
/admin.php (countriesPage parameter)
/admin.php (dStart parameter)
/admin.php (edit parameter)
/admin.php (email parameter)
/admin.php (FCKeditor parameter)
/admin.php (gc%5Bmax%5D parameter)
/admin.php (gc%5Bmin%5D parameter)
/admin.php (gc%5BproductCode%5D parameter)
/admin.php (gc%5Bweight%5D parameter)
/admin.php (gc[max] parameter)
/admin.php (gc[min] parameter)
/admin.php (gc[productCode] parameter)
/admin.php (gc[weight] parameter)
/admin.php (loc]
/admin.php (page parameter)
/admin.php (prod_master_id parameter)
/admin.php (searchStr parameter)
/admin.php (thumbName[] parameter)
/admin.php (User-Agent HTTP header)
/admin.php (yStart parameter)
/index.php (Referer HTTP header)


6. SOLUTION

The CubeCart 4.x version family is no longer maintained by the vendor.
Upgrade to the currently supported latest CubeCart version - 5.x.


7. VENDOR

CubeCart Development Team
http://cubecart.com/


8. CREDIT

Aung Khant, http://yehg.net, YGN Ethical Hacker Group, Myanmar.


9. DISCLOSURE TIME-LINE

2012-12-22: CubeCart 4.x in End-of-Support/Maintenance circle
2012-12-24: Vulnerability disclosed


10. REFERENCES

Original Advisory URL:
http://yehg.net/lab/pr0js/advisories/%5Bcubecart_4.4.6%5D_xss
CubeCart Home Page: http://cubecart.com/
CubeCart Bug-Fix Announcement:
http://forums.cubecart.com/topic/45456-cubecart-447-released/
CubeCart4 End-of-Life Announcement:
http://forums.cubecart.com/topic/46765-cubecart-v4-end-of-life-saturday-22-december/

#yehg [2012-12-24]

---------------------------------
Best regards,
YGN Ethical Hacker Group
Yangon, Myanmar
http://yehg.net
Our Lab | http://yehg.net/lab
Our Directory | http://yehg.net/hwd
