Snare for Linux Cross-Site Scripting via Log Injection


I. BACKGROUND
----------------------
Snare for Linux provides a 'C2' or 'CAPP' style audit 
subsystem for the Linux operating system. It can be
used as a standalone auditing tool for Linux, or can 
send data to the Snare Server for analysis and storage. 


II. DESCRIPTION
----------------------
A cross-site scripting vulnerability has been discovered 
in the web interface for Snare for Linux.  As part of 
Snare's intended functionality, one feature it provides
is the logging of shell commands issued by a given user 
which are then available for viewing through the web 
interface.  Due to the fact that this data was not validated
before being sent to the browser in versions prior to 1.7.0,
it is possible to inject JavaScript into the web console.


III. AFFECTED PRODUCTS
----------------------
All versions of Snare for Linux prior to 1.7.0 are vulnerable.


IV.
----------------------
Users should upgrade to version 1.7.0 of Snare for Linux.


V. Credit
----------------------
This vulnerability was discovered by Andrew Brooks.


VI. References
----------------------
CVE-2011-5249
http://rpmfind.net/linux/RPM/sourceforge/s/sn/snare/Snare%20for%20Linux/1.7.0/SnareLinux-1.7.0-0.i386.html


VII. Timeline
----------------------
7/11/11 - Vendor notification
8/09/11 - Fixed and closed
