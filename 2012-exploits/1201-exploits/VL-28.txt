Title:
======
Barracuda Spam/Virus WAF 600 - Multiple Web Vulnerabilities


Date:
=====
2012-01-19


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=28


VL-ID:
=====
28


Introduction:
=============
Barracuda Networks - Worldwide leader in email and Web security.
The Barracuda Spam & Virus Firewall is an integrated hardware and software solution for complete protection of 
your email server. It provides a powerful, easy-to-use and affordable solution to eliminating spam and viruses 
from your organization by providing the following protection:
Barracuda Spam & Virus Firewall
	
    * Anti-spam
    * Anti-virus
    * Anti-spoofing
    * Anti-phishing
    * Anti-spyware (Attachments)
    * Denial of Service

The Barracuda Spam & Virus Firewall is compatible with all email servers and can fit into nearly any corporate or 
small business environment. It is used by small organizations with as few as 10 employees and large organizations
with as many as 200,000 employees. A single Barracuda Spam & Virus Firewall handles up to 100,000 active email 
users. Multiple units can be clustered together for even greater capacity and high availability.

The Barracuda Spam & Virus Firewall protects your email server with twelve defense layers:

    * Network Denial of Service Protection
    * Rate Control
    * IP Reputation Analysis
    * Sender Authentication
    * Recipient Verification
    * Virus Scanning
...


(Copy of the Vendor Homepage: http://www.barracudanetworks.com/ns/products/spam_overview.php)


Abstract:
=========
Vulnerability Lab Team discovered  multiple persistent Web Vulnerabilities on Barracudas Spam & Virus Firewall 600 appliance application.


Report-Timeline:
================
2011-04-01:	Vendor Notification
2011-08-04:	Vendor Response/Feedback
2011-12-22:	Vendor Fix/Patch  by Check
2012-01-19:	Public or Non-Public Disclosure


Status:
========
Published


Exploitation-Technique:
=======================
Remote


Severity:
=========
Medium


Details:
========
Multiple persistent Input Validation vulnerabilities are detected on Barracudas Spam & Virus Web Firewall 600. Local low privileged user account can
implement/inject malicious persistent script code. When exploited by an authenticated user, the identified vulnerabilities 
can lead to information disclosure, access to intranet available servers, manipulated persistent content.

Vulnerable Module(s): 
								[+] Trace route Device - Troubleshooting
								[+] LDAP Configuration - LDAP Username

Affected Version(s):
								[+] Barracuda Spam & Virus Firewall 600

Affected Firmware(s):
								[+] Firmware v4.0.1.009 & older versions

Picture(s):
								../ldap.png


Proof of Concept:
=================
The persistent vulnerabilities can be exploited by local low privileged user accounts with low required user inter action or 
by remote attackers with high required user inter action.

Manually Steps ...
1. Login to the Barracuda Application
2. Open the vulnerable area were the persistent vulnerability is located
3. Include/Insert your own script code or poc and save/execute the content to inject
4. View the injected results which were stored on application side. The code is getting executed in the  output section

PoC: 
%3E%3E%22%3C%69%66%72%61%6D%65%20%73%72%63%3D%68%74%74%70%3A%2F%2F%77%77%77%2
E%76%75%6C%6E%65%72%61%62%69%6C%69%74%79%2D%6C%61%62%2E%63%6F%6D%20%77%69%64%
74%68%3D%36%30%30%20%68%65%69%67%68%74%3D%36%30%30%3E


Solution:
=========
2011-12-22:	Vendor Fix/Patch


Risk:
=====
The security risk of the persistent vulnerabilities are estimated as medium(+).


Credits:
========
Vulnerability Research Laboratory - Benjamin Kunz Mejri (Rem0ve)


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability-
Lab. Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of 
other media, are reserved by Vulnerability-Lab or its suppliers.

    						Copyright © 2012|Vulnerability-Lab




-- 
Website: www.vulnerability-lab.com ; vuln-lab.com or vuln-db.com
Contact: admin@vulnerability-lab.com or support@vulnerability-lab.com

