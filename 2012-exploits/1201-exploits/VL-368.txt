Title:
======
MegaSWF - Persistant Cross Site Scripting Vulnerability


Date:
=====
2012-01-12


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=368


VL-ID:
=====
368


Introduction:
=============
Do you create Flash games, Flash animations, or any other type of content saved in the .SWF extension? MegaSWF
offers you a free, stable .SWF file repository on our high-speed servers.

To take advantage of our service, simply click the Upload button. You can also create an account with MegaSWF
for more capacity and more functionality. We are always adding new features based on the feedback we get from
our users.

(Copy of the Vendor Homepage: http://megaswf.com/about)


Abstract:
=========
A Vulnerability-Lab Reseacher discovered a persistent cross site scripting vulnerability on the MegaSWF website.


Report-Timeline:
================
2011-12-03:	Vendor Notification
2012-01-12:	Public or Non-Public Disclosure


Status:
========
Published


Exploitation-Technique:
=======================
Remote


Severity:
=========
Medium


Details:
========
A persistent cross site scripting vulnerability is detected on the MegaSwf website service.
The vulnerability allows an remote attacker with required user inter action to hijack customer sessions via persistent cross site scripting.
Successful exploitation can result in account steal, client side exploitation or phishing & session hijacking.
The bug is located on the serve module in-/output of the megaswf service web application.

Vulnerbale Module(s):
                                                                    [+] serve

Picture(s):
                                                                    ../1.png


Proof of Concept:
=================
The vulnerability can be exploited by remote attacker with required user inter action.
For demonstration or reproduce ...

PoC:
[1] Create an URLRequest-Object with a JS-Code like : var alert:URLRequest = new URLRequest("javascript:alert('xss')");
[2] Publishing the swf in megaswf.com will exploit a persistent xss-vulnerability and run your JS code.

Full code-example that can be used on a frame as actionscript :

import flash.net.URLRequest;
var alert:URLRequest = new URLRequest("javascript:alert('xss')");
navigateToURL(alert, "_self");


Reference(s) :
http://megaswf.com/serve/1471214


Risk:
=====
The security risk of the persistant cross site scripting vulnerability is estimated as medium(+).


Credits:
========
Vulnerability Research Laboratory -  Sebastian Lüdtke  (yak0n)


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability-
Lab. Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of 
other media, are reserved by Vulnerability-Lab or its suppliers.

    						Copyright © 2011|Vulnerability-Lab

-- 
Website: www.vulnerability-lab.com ; vuln-lab.com or vuln-db.com
Contact: admin@vulnerability-lab.com or support@vulnerability-lab.com

