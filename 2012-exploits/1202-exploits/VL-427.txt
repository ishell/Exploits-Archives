Title:
======
Dolibarr CMS v3.2.0 Alpha - SQL Injection Vulnerabilities


Date:
=====
2012-02-09


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=427


VL-ID:
=====
427


Introduction:
=============
Dolibarr ERP & CRM is a modern software to manage your company or foundation activity (contacts, suppliers, 
invoices, orders, stocks, agenda, ...). It s an opensource free software designed for small and medium 
companies, foundations and freelances. You can install, use and distribute it as a standalone application 
or as a web application (on mutualized or dedicated server, or on SaaS or Cloud solutions) and use it with 
any devices (desktop, smartphone, tablet).

(Copy of the Vendor Homepage: http://www.dolibarr.org/)


Abstract:
=========
Vulnerability-Lab researcher discovered a remote SQL Injection vulnerability on Dolibarrs CMS v3.2.0 Alpha.


Report-Timeline:
================
2011-02-09:	Public or Non-Public Disclosure


Status:
========
Published


Exploitation-Technique:
=======================
Remote


Severity:
=========
High


Details:
========
Multiple remote SQL Injection vulnerabilities are detected on Dolibarrs Content Management System v3.2.0 Alpha.
The vulnerability allows an attacker (remote) or local low privileged user account to inject/execute own sql commands 
on the affected application dbms. Successful exploitation of the vulnerability results in dbms & application compromise.

Vulnerable Module(s):
					[+] Member List
					[+] Row ID


--- Error/Exception Logs ---
Das System hat einen technischen Fehler festgestellt.
Diese Informationen könnten bei der Diagnose des Fehlers behilflich sein:
Datum: 20120209164847
Dolibarr: 3.2.0-alpha
Funktions-Level: 0
PHP: 5.2.4-2ubuntu5.19
Server: Apache

Angeforderte URL: /adherents/fiche.php?rowid=-1%27
Menüverwaltung: eldy_backoffice.php

Datenbanktyp-Verwaltung: mysql
Anfrage des letzten Datenbankzugriffs mit Fehler: SELECT d.rowid, d.civilite, d.prenom as firstname, d.nom as lastname, 
d.societe, d.fk_soc, d.statut, d.public, d.adresse as address, d.cp as zip, d.ville as town, d.note, d.email, d.phone, 
d.phone_perso, d.phone_mobile, d.login, d.pass, d.photo, d.fk_adherent_type, d.morphy, d.datec as datec, d.tms as datem, 
d.datefin as datefin, d.naiss as datenaiss, d.datevalid as datev, d.pays, d.fk_departement, p.rowid as country_id, p.code 
as country_code, p.libelle as country, dep.nom as state, dep.code_departement as state_code, t.libelle as type, t.cotisation 
as cotisation, u.rowid as user_id, u.login as user_login FROM llx_adherent_type as t, llx_adherent as d LEFT JOIN llx_c_pays 
as p ON d.pays = p.rowid LEFT JOIN llx_c_departements as dep ON d.fk_departement = dep.rowid LEFT JOIN llx_user as u ON d.rowid 
= u.fk_member WHERE d.fk_adherent_type = t.rowid AND d.entity = 1 AND d.rowid=-1\\\\\\\'
Return-Code des letzten Datenbankzugriffs mit Fehler: DB_ERROR_SYNTAX
Inhalt des letzten Datenbankzugriffs mit Fehler: You have an error in your SQL syntax; check the manual that corresponds to 
your MySQL server version for the right syntax to use near \\\\\\\'\\\\\\\'\\\\\\\' at line 1

Message: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version 
for the right syntax to use near \\\\\\\'\\\\\\\'\\\\\\\' at line 1



Picture(s):
					../1.png
					../2.png


Proof of Concept:
=================
The vulnerabilities can be exploited by remote attackers or local low privileged user accounts. For demonstration or reproduce ...


1.1
1. Login to the Panel
2. Open the list.php
3. Include the following example string -
 on the memberslist -%20`


1.2
http://demo.dolibarr.org/adherents/fiche.php?rowid=-1%27[SQL Injection Vulnerability!]


Risk:
=====
The security risk of the sql injection vulnerabilities are stimated as high(+).


Credits:
========
Vulnerability Research Laboratory   -    Benjamin Kunz Mejri   & Ucha Gobejishvili


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability-
Lab. Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of 
other media, are reserved by Vulnerability-Lab or its suppliers.

    						Copyright © 2012|Vulnerability-Lab




-- 
Website: www.vulnerability-lab.com ; vuln-lab.com or vuln-db.com
Contact: admin@vulnerability-lab.com or support@vulnerability-lab.com

