Title:
======
Endian UTM Firewall v2.4.x - Cross Site Vulnerabilities


Date:
=====
2012-02-18


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=436


VL-ID:
=====
436


Introduction:
=============
The Endian Firewall is an open source GNU/Linux distribution that specializes on Routing/Firewalling and 
Unified Threat Management. It is being developed by the Italian Endian Srl and the community. Endian is originally 
based on IPCop, which itself was a fork of Smoothwall.

(Copy of the Vendor Website: http://en.wikipedia.org/wiki/Endian_Firewall )

Einfach, schnell und zukunftssicher! Die ideale Lösung, um Ihre Filialen und industriellen Zweigstellen rund um den Globus zu schützen.
Endian 4i ist die ideale Lösung für Büroaußenstellen oder Industrieinstallationen. Die Firewall ist in den zwei Varianten „Office“ und 
„Industrial“ erhältlich. Die Office-Version bietet alle Funktionen, um Netzwerke in der Firma und in Verbindung mit Außenstellen einfach 
und sicher zu verlinken. Derselbe Funktionsumfang ist bei der Industrial-Version vorhanden, die sich speziell an den Industriebereich 
richtet und 24V Support bietet sowie auf der Hutschiene installiert werden kann. Remote-Supporting, Remote-Konfiguration, Systemüberwachung 
bis hin zur einfachen, sicheren Vernetzung von Außenstellen – die Kostenvorteile dabei liegen auf der Hand. Sichern auch Sie sich die 
Konnektivität Ihres Unternehmens ab, und behalten Sie mit der Endian 4i stets die Nase vorn.

(Copy of the Vendor Homepage: http://www.endian.com/de/products/utm-hardware/4i/)


Abstract:
=========
The Vulnerability Lab Team discovered mutliple non persistent Cross Site Scripting Vulnerabilities on Endians UTM Firewall v2.4.x Application.


Report-Timeline:
================
2011-02-02:	Vendor Notification
2012-02-18:	Public or Non-Public Disclosure


Status:
========
Published


Affected Products:
==================
Endian
Product: UTM Firewall Appliance Application v2.4.x


Exploitation-Technique:
=======================
Remote


Severity:
=========
Medium


Details:
========
Multiple non persistent cross site scripting vulnerabilities are detected on Endian Firewall v2.4.x UTM Appliance Application.
The vulnerability allows remote attackers to hijack website customer, moderator or admin sessions with high required 
user inter action or local low privileged user account. Successful exploitation can result in account steal, phishing 
& client-side content request manipulation.

Vulnerable Module(s):
                                                                [+] openvpn_users.cgi
                                                                [+] dnat.cgi#createrule
                                                                [+] dansguardian.cgi#addrule

Picture(s):
                                                                ../1.png
                                                                ../2.png
                                                                ../3.png


Proof of Concept:
=================
The vulnerabilities can be exploited by local low privileged user accounts or remote attackers with high required user inter action.
For demonstration or reproduce ...


#1 https://demo.endian.com/cgi-bin/dnat.cgi#createrule
[XSS]

#2 https://demo.endian.com/cgi-bin/dansguardian.cgi#addrule[XSS]


#3 https://demo.endian.com/cgi-bin/openvpn_users.cgi
?=[XSS]



Risk:
=====
The security risk of the cross site scripting vulnerabilities are estimated as medium(-).


Credits:
========
Vulnerability Research Laboratory


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability-
Lab. Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of 
other media, are reserved by Vulnerability-Lab or its suppliers.

    						Copyright © 2012|Vulnerability-Lab


-- 
Website: www.vulnerability-lab.com ; vuln-lab.com or vuln-db.com
Contact: admin@vulnerability-lab.com or support@vulnerability-lab.com

