Title:
======
eFront Enterprise v3.6.11 - Multiple Web Vulnerabilities


Date:
=====
2012-08-06


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=668


VL-ID:
=====
668


Common Vulnerability Scoring System:
====================================
3.5


Introduction:
=============
Tailored with larger organizations in mind, eFront Enterprise offers solutions for the management of companies most 
valued asset - the people. Based on a coherent approach to human capital management which keeps the workforce actively 
engaged, the eFront Educational platform offers the means of aligning learning programs with business goals to cultivate 
employee skills and knowledge associated with business performance. eFront Enterprise builds on top of eFront Enterprise.

(Copy of the Vendor Homepage: http://efrontlearning.net/product/ )


Abstract:
=========
A Vulnerability Laboratory Researcher of the Vulnerability Laboratory Team discovered multiple web vulnerabilties in eFronts v3.6.11 Enterprise CMS.


Report-Timeline:
================
2011-07-27:	Vendor Notification
2011-08-06:	Public Disclosure


Status:
========
Published


Affected Products:
==================
eFront
Product: eLearning Enterprise Edition v3.6.11


Exploitation-Technique:
=======================
Remote


Severity:
=========
High


Details:
========
Multiple persistent input validation vulnerabilities are detected in the eFront Enterprise v3.6.11 Content Management System.
The vulnerabilities allow remote attackers to implement/inject malicious script code on the application side (persistent).

The first vulnerability is located in the Organization > Organizational Profile module with the bound vulnerable Father name 
parameter and listing. The bug allows a low privileged trainee account to exploit higher privileged professor or administrator 
user accounts via organisation registration listing. Exploitation of the first vulnerability requires low privileged trainee 
elearning application user account.

The secound vulnerability is located in the Files module with the bound vulnerable file name listing.
Exploitation of the secound vulnerability requires low privileged trainee elearning application user account.

The thrid vulnerability is located in the `Write something about yourself` input message box module with the bound vulnerable 
listing. Exploitation of the 3rd vulnerability requires privileged trainee/professor/admin elearning application user account.
The third issue is only local exploitable because no affected output listing is available for the vulnerable 
`Write something about yourself` application module.


Successful exploitation of the vulnerabilities can lead to persistent session hijacking (professor/admin), persistent phsishing
attacks or stable (persistent) context manipulation. 


Vulnerable Module(s):
				[+] Organization > Organizational Profile
				[+] Files
				[+] PANEL Index - Write something about yourself (Only local exploitable!)


Vulnerable Parameters(s):
				[+] Father name [Organisation Listing]
				[+] File Name [Listing]
				[+] Message - Index [Listing]


Proof of Concept:
=================
The persistent input validation vulnerabilities can be exploited by remote attackers with a low privileged trainee account.
For demonstration or reproduce ...


Review: Organization - Organization Profile (Fathername & Organisationname)

<tbody><tr><td class="labelCell">Father name: </td>
    <td class="elementCell"><input class="inputText" name="father" value="
"><[PERSISTENT INJECTED SCRIPT CODE!]) <" type="text"></td></tr>
   <tr><td class="labelCell">Gender: </td>
    <td class="elementCell"><select class="inputText" name="sex">
	<option value="0" selected="selected">Male</option>
	<option value="1">Female</option>
</select></td></tr>
   <tr><td class="labelCell">Birthday: </td>
    <td class="elementCell"><select name="birthday[d]">
	<option value="1" selected="selected">01</option>
	<option value="2">02</option>
	<option value="3">03</option>
	<option value="4">04</option>
	<option value="5">05</option>
	<option value="6">06</option>

URL: http://efront.127.0.0.1:1339/enterprise/www/student.php?ctg=personal&user=trainee&op=org_form


Review: Files - File Name [Listing]

<tr class="defaultRowHeight evenRowColor"><td class="centerAlign"><span style="display:none"></span>
<img src="student-Dateien/folder.png" alt="" title="" border="0"></td><td><span id="span_%2Fvar%2Fwww%2Fvhosts%2F
demo%2Fenterprise%2Fupload%2Ftrainee%2Fmodule_hcd%2Fpublic%2F%22%3E%3Ciframe+src%3Da+[PERSISTENT INJECTED SCRIPT CODE!]" 
style="display:none;">%2Fvar%2Fwww%2Fvhosts%2Fdemo%2Fenterprise%2Fupload%2Ftrainee%2Fmodule_hcd
%2Fpublic%2F%22%3E%3C[PERSISTENT INJECTED SCRIPT CODE!]</span><a class="editLink" href="javascript:void(0)" 
onclick="eF_js_rebuildTable($('filename_filesTable').down().getAttribute('tableIndex'), 0, '', 'desc', '%2Fvar%2Fwww
%2Fvhosts%2Fdemo%2Fenterprise%2Fupload%2Ftrainee%2Fmodule_hcd%2Fpublic%2F%22%3E%3C[PERSISTENT INJECTED SCRIPT CODE!]');">
"><iframe src="student-[PERSISTENT INJECTED SCRIPT CODE!])' <<="" a=""><span
id = "edit_%2Fvar%2Fwww%2Fvhosts%2Fdemo%2Fenterprise%2Fupload%2Ftrainee%2Fmodule_hcd%2Fpublic%2F%22%3E%3C[PERSISTENT INJECTED SCRIPT CODE!]"
 style = "display:none"><input type = "text" value = 
""><[PERSISTENT INJECTED SCRIPT CODE!]") <" onkeypress = "if 
(event.which == 13 || event.keyCode == 13) 
{Element.extend(this).next().down().onclick(); return 
false;}"/> <a href = "javascript:void(0)"><img id =
"editImage_%2Fvar%2Fwww%2Fvhosts%2Fdemo%2Fenterprise%2Fupload%2Ftrainee%2Fmodule_hcd%2Fpublic%2F%22%3E%3C[PERSISTENT INJECTED SCRIPT CODE!]"src
 = 'themes/default/images/others/transparent.gif' class = 'sprite16 
sprite16-success' style = "vertical-align:middle" onclick = 
"editFile(this, 
$('span_%2Fvar%2Fwww%2Fvhosts%2Fdemo%2Fenterprise%2Fupload%2Ftrainee%2Fmodule_hcd%2Fpublic%[PERSISTENT INJECTED SCRIPT CODE!]').innerHTML,
 Element.extend(this).up().previous().value, 
'directory','\"><[PERSISTENT INJECTED SCRIPT CODE!]") <')" border =
"0"></a></span></td><td></td>
 <td>27 Jul 2012, 23:38</td>

URL: http://efront.127.0.0.1:1339/enterprise/www/student.php?ctg=personal&user=trainee&op=files



Review: PANEL Index - Write something about yourself (Only local exploitable!)

<td>
<span class="leftOption">Trainee D. (trainee) </span>
<span style="" id="statusText" onclick="javascript:showStatusChange()">"
<i>"><iframe src="student3-[PERSISTENT INJECTED SCRIPT CODE!])' <<="" i="">"</iframe></i></span>
<input class="inputText" id="inputStatusText" style="display: none;" value="">
<[PERSISTENT INJECTED SCRIPT CODE!];) <" onblur="changeStatus()">
<img style="visibility: visible;" progressimage="anonymous_element_16" id="statusTextProgressImg" 
src="student3-Dateien/transparent.gif" class="ajaxHandle sprite32 sprite32-edit" alt="Click to change status" 
title="Click to change status" onclick="javascript:showStatusChange()">
</td>

URL: http://efront.127.0.0.1:1339/enterprise/www/student.php?ctg=personal&user=trainee&op=dashboard


Risk:
=====
The security risk of the persistent web vulnerabilities are estimated as high(-).


Credits:
========
Vulnerability Laboratory [Research Team]  -    Benjamin Kunz Mejri (bkm@vulnerability-lab.com)


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. We do not approve or encourage anybody to break any vendor licenses, policies, deface websites, hack into databases 
or trade with fraud/stolen material.

Domains:    www.vulnerability-lab.com   	- www.vuln-lab.com			       - www.vulnerability-lab.com/register
Contact:    admin@vulnerability-lab.com 	- support@vulnerability-lab.com 	       - research@vulnerability-lab.com
Section:    video.vulnerability-lab.com 	- forum.vulnerability-lab.com 		       - news.vulnerability-lab.com
Social:	    twitter.com/#!/vuln_lab 		- facebook.com/VulnerabilityLab 	       - youtube.com/user/vulnerability0lab
Feeds:	    vulnerability-lab.com/rss/rss.php	- vulnerability-lab.com/rss/rss_upcoming.php   - vulnerability-lab.com/rss/rss_news.php

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. 
Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other 
media, are reserved by Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, sourcecode, videos and 
other information on this website is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), 
modify, use or edit our material contact (admin@vulnerability-lab.com or support@vulnerability-lab.com) to get a permission.

    				   	Copyright © 2012 | Vulnerability Laboratory



-- 
VULNERABILITY RESEARCH LABORATORY
LABORATORY RESEARCH TEAM
CONTACT: research@vulnerability-lab.com

