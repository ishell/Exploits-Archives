SEC Consult Vulnerability Lab Security Advisory < 20121017-1 >
=======================================================================
              title: SQL Injection
            product: Unirgy uStoreLocator - Magento extension
 vulnerable version: <=2.0.0
      fixed version: >=2.0.1
             impact: High
           homepage: http://www.unirgy.com/
              found: 2012-06-18
                 by: K. Gudinavicius
                     SEC Consult Vulnerability Lab 
                     https://www.sec-consult.com
=======================================================================

Vendor description:
-------------------
"Help customers locate your stores, dealers, distributors, products or
services. StoreLocator is user friendly, simple yet flexible geo location and
directions service with worldwide location support."

Source: http://www.unirgy.com/products/ustorelocator/



Vulnerability overview/description:
-----------------------------------
Due to a programming error, the uStoreLocator module for Magento eCommerce 
platform allows the injection of direct SQL commands, which are executed on 
the backend database server through the web application.



Proof of concept:
-----------------
The SQL injection vulnerability exists in the location search action. The "?"
character (urlencoded representation: %3f) when included in the lat or lng
parameters is converted to the "'contents of the radius parameter'" string
that is added to the SQL query. This breaks the legitimate web
application's SQL query and allows the user to modify the original query.



Vulnerable / tested versions:
-----------------------------
Version 0.2.5 has been tested, furthermore the vendor confirmed that 2.0.0 is
affected too.


Vendor contact timeline:
------------------------
2012-06-19: Contacting vendor through <support@unirgy.com>.
2012-06-19: Vendor reply asking for detailed customer information.
2012-06-20: We won't provide such information, asking for security contact.
            again, receiving a contact.
2012-06-21: Sending advisory information to security contact and another.
            contact supplied by vendor support team.
2012-06-22: Vendor is unable to reproduce/exploit the issue
2012-06-22: Describing further steps, asking for affected versions.
2012-06-22: Vendor is able to reproduce SQL error message, asking for more
            information.
            v2.0.1 has been released containing "fix for passing the string".
2012-06-25: Sending more exploit details for error-based SQLi.
2012-10-13: Vendor confirms releasing advisory
2012-10-17: SEC Consult releases coordinated security advisory.



Solution:
---------
Upgrade to the latest version available v2.0.2:
http://www.unirgy.com/products/ustorelocator



Workaround:
-----------
None


Advisory URL:
-------------
https://www.sec-consult.com/en/advisories.html


~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SEC Consult Unternehmensberatung GmbH

Office Vienna
Mooslackengasse 17
A-1190 Vienna
Austria

Tel.: +43 / 1 / 890 30 43 - 0
Fax.: +43 / 1 / 890 30 43 - 25
Mail: research at sec-consult dot com
https://www.sec-consult.com

EOF K. Gudinavicius / @2012
