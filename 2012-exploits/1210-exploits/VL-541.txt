Title:
======
LAN Messenger v1.2.28 - Persistent Software Vulnerability


Date:
=====
2012-05-16


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=


VL-ID:
=====
541


Common Vulnerability Scoring System:
====================================
7.5


Introduction:
=============
LAN Messenger is a free and open source cross-platform instant messaging application for communication over a 
local network. It does not require a server. A number of useful features including event notifications, file transfer 
and message logging are provided.

(Copy of the Website: http://lanmsngr.sourceforge.net )


Abstract:
=========
The Vulnerability Laboratory Research Team discovered a persistent remote vulnerability in LAN Messenger v1.2.28.


Report-Timeline:
================
2012-05-16:	Public or Non-Public Disclosure


Status:
========
Published


Exploitation-Technique:
=======================
Remote


Severity:
=========
High


Details:
========
A persistent software vulnerability is detected in in LAN Messenger v1.2.28. The bug is located in the profile display 
& nickname validation of the software. The vulnerability allows an attacker (remote) to implement own malicious script codes as 
profile. The code is getting executed when the attacker writes the victim a message. The vulnerable nickname input is getting 
executed as output of the messagebox when processing to write a message. Successful exploitation can lead in persistent hijacking, 
external malicious redirects, persistent script code execution to compromise the connected network client system.

Vulnerable Module(s):
				[+] Username as seen by Contacts - Messagebox Display & Input

Picture(s):
				../1.png


Proof of Concept:
=================
The persistent profile vulnerability can be exploited by remote attackers with low required inter action. 
For demonstration or reproduce ...


1. Open LAN Messenger v1.2.28 click on the top menu > Tools 
2. Switch to > Preferences > Account
3. Include to the Username as seen by Contacts your own persistent script code with char obfuscation trick
4. write the target system your message to exploit persistent via profile display nickname


PoC:
"><iFrAmE sRc=A oNlOaD=aLeRt("VL") <
... or
%22%3E%3C%69%46%72%41%6D%45%20%73%52%63%3D%41%20%6F%4E%6C%4F%61%44%3D%61%4C%65%52%74%28%22%56%4C%22%29%20%3C


Risk:
=====
The security risk of the persistent remote web vulnerability is estimated as high.


Credits:
========
Vulnerability Research Laboratory - Benjamin Kunz Mejri  (bkm@vulerability-lab.com)


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. We do not approve or encourage anybody to break any vendor licenses, policies, deface websites, hack into databases 
or trade with fraud/stolen material.

Domains:    www.vulnerability-lab.com   	- www.vuln-lab.com			       - www.vulnerability-lab.com/register
Contact:    admin@vulnerability-lab.com 	- support@vulnerability-lab.com 	       - research@vulnerability-lab.com
Section:    video.vulnerability-lab.com 	- forum.vulnerability-lab.com 		       - news.vulnerability-lab.com
Social:	    twitter.com/#!/vuln_lab 		- facebook.com/VulnerabilityLab 	       - youtube.com/user/vulnerability0lab
Feeds:	    vulnerability-lab.com/rss/rss.php	- vulnerability-lab.com/rss/rss_upcoming.php   - vulnerability-lab.com/rss/rss_news.php

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. 
Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other 
media, are reserved by Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, sourcecode, videos and 
other information on this website is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), 
modify, use or edit our material contact (admin@vulnerability-lab.com or support@vulnerability-lab.com) to get a permission.

    				   	Copyright  2012 | Vulnerability Laboratory



-- 
VULNERABILITY RESEARCH LABORATORY
LABORATORY ADMINISTRATION
CONTACT: admin@vulnerability-lab.com

