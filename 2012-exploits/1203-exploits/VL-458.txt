Title:
======
LDAP Account Manager Pro v3.6 - Multiple Vulnerabilities


Date:
=====
2012-03-01


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=458


VL-ID:
=====
458


Introduction:
=============
LDAP Account Manager Pro is an extended version of LAM which focuses on enterprise usage. It helps you to lower your 
administration costs by providing enhanced tools for your users and deskside support staff.
Features LDAP Account Manager (LAM) is a webfrontend for managing entries (e.g. users, groups, DHCP settings) stored 
in an LDAP directory. LAM was designed to make LDAP management as easy as possible for the user. It abstracts from the 
technical details of LDAP and allows persons without technical background to manage LDAP entries. If needed, power 
users may still directly edit LDAP entries via the integrated LDAP browser.

(Copy of the Vendor Homepage: http://www.ldap-account-manager.org/lamcms/lamPro )


Abstract:
=========
Vulnerability-Lab Team  discovered multiple web vulnerabilities on LDAPs Account Manager Pro v3.6.


Report-Timeline:
================
2012-02-22:	Public or Non-Public Disclosure


Status:
========
Published


Affected Products:
==================
Open Source
Product: LDAP Account Manager Pro (lamp) v3.6


Exploitation-Technique:
=======================
Remote


Severity:
=========
Medium


Details:
========
1.1
Multiple persistant input validation vulnerabilities are detected  on LDAPs Account Manager Pro v3.6.
The bug allows remote attacker to implement malicious script code on the application side (persistent).
Successful exploitation of the vulnerability allows an attacker to manipulate modules/context (persistent) & can 
lead to session hijacking (user/mod/admin).

Vulnerable Module(s):
					[+] User Listing & List Input/Output
					[+] Export


Picture(s):
					../1.png
					../2.png

1.2
Multiple client-side Cross Site Scripting vulnerabilities are detected  on LDAPs Account Manager Pro v3.6.
The bug allows remote attacker hijack customer/admin sessions with medium required user inter action. 
Successful exploitation leads to session hijacking or client side module manipulation attacks and the result 
is account steal.

Vulnerable Module(s):
					[+] &attr=
					[+] Filter- Search & Listing


Picture(s):
					../3.png
					../4.png


Proof of Concept:
=================
The vulnerabilities can be exploited by remote attacker with low & high required user inter action. 
For demonstration or reproduce ...


1.1

Code Review: Exception handling of User Input & Listing

<div class="statusError ui-corner-all">
<table>
<tbody><tr>
<td>  <img src="list.php-filter-Dateien/error.png" alt="ERROR" height="32" width="32"></td>
<td><h2 class="statusError ui-corner-all">Please enter a valid filter. Only letters, numbers and 
" _*$.@-" are allowed.</h2><p class="statusError ui-corner-all">-1'"><[INJECTED PERSISTENT SCRIPT CODE!] <</p></td>
</tr>
</tbody></table>


... or


Code Review: Export Function - Persistent Error Output File

# Suchbereich: base
# Suchfilter: >"<iframe src=http://google.com>

# Anzahl Einträge: 0


# Generated by LDAP Account Manager (http://phpldapadmin.sourceforge.net) on February 22, 2012 4:51 pm

# Version: 3.6

version: 1



Reference(s):
				../export-import-p0c.ldif
				../list.php-filter.htm



1.2
http://www.ldap-account-manager.org/lam/templates/3rdParty/pla/htdocs/cmd.php?cmd=add_value_form&
server_id=1&dn=uid%3Dpc01%24%2Cou%3Dmachines%2Cdc%3Dlam-demo%2Cdc%3Dorg&attr=%3E%22%3Ciframe
%20src=http://www.vulnerability-lab.com%20width=1200%20height=800%3E

Reference(s):
				../cmd.php-attr.htm
				../&attr=.txt


Risk:
=====
The security risk of the persistent web vulnerabilities are estimated as medium(+).


Credits:
========
Vulnerability Research Laboratory   -    Benjamin Kunz Mejri


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability-
Lab. Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of 
other media, are reserved by Vulnerability-Lab or its suppliers.

    						Copyright © 2012|Vulnerability-Lab

-- 
Website: www.vulnerability-lab.com ; vuln-lab.com or vuln-db.com
Contact: admin@vulnerability-lab.com or support@vulnerability-lab.com

