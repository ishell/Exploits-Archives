Title:
======
Skype 5.8x 5.5x - Corruption & Persistent Vulnerability


Date:
=====
2012-03-29


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=455

MRSC ID: 12250

VIDEO: http://vulnerability-lab.com/get_content.php?id=457     ;)


VL-ID:
=====
455


Introduction:
=============
Skype is a software application that allows users to make voice and video calls and chats over the Internet. Calls to other users within the
Skype service are free, while calls to both traditional landline telephones and mobile phones can be made for a fee using a debit-based
user account system. Skype has also become popular for its additional features which include instant messaging, file transfer, and
videoconferencing. Skype has 663 million registered users as of 2010.  The network is operated by Skype Limited, which has its headquarters
in Luxembourg. Most of the development team and 44% of the overall employees of Skype are situated in the offices of Tallinn and Tartu, Estonia.

(Copy of the Vendor Homepage: http://en.wikipedia.org/wiki/Skype)


Abstract:
=========
The Vulnerability-Lab Team discovered a remote pointer corruption with persistent weakness on Skypes  v5.8.0.156  Windows 7 &  MacOS v5.5.2340.


Report-Timeline:
================
2012-02-24:	Vendor Notification
2012-02-25:	Vendor Response/Feedback
2012-03-20:	Vendor Fix/Patch by Check
2012-03-29:	Public or Non-Public Disclosure


Status:
========
Published


Affected Products:
==================
Skype Windows, MacOs & Linux


Exploitation-Technique:
=======================
Remote


Severity:
=========
High


Details:
========
A pointer corruption vulnerability is detected on the windows v5.6.59.10 & macos v5.5.2340 client of the skype software. 
The bug is located in the software when processing special crafted symbole messages via communication box. The vulnerability 
allows an attacker to freeze, block, crash or destroy the communication messagebox of the connected conference persons/teams. 
The bug also has an persistent weakness vector which allows an remote attacker to implement the symbole string to the contact 
user requests messagebox. The result is also a stable persistent error message and a client denial of service. Attackers can 
also implement the test poc to the group labelname which results in a stable group error with different exceptions. The facebook 
integration allows to sync the account with skype and can also redisplay the issue with the error via facebook module and wallposting.
The callto function allows an attacker to implement the issue persistent on a victim user profile by using the symbole string as nickname.

Vulnerable Module(s):
						[+] MessageBox & Request Contact
						[+] Contact Request Messagebox - Add Skype User
						[+] Group Topic & Group Information Name
						[+] Facebook integration - Connect Account Wall Postings

Affected OS version(s):
						[+] Windows v5.8.0.156, MacOS 5.5.0.2340 & Linux 2.2 Beta 


Picture(s):
						../1.png
						../2.png
						../3.png
						../4.png
						../5.png
						../6.png
						../7.png
						../8.png
						../9.png
						../10.png
						../11.png
						../12.png
						../13.png
						../14.png
						../5.png
						../6.png
						../7.png
						../8.png
						../9.png
						../10.png
						../11.png
						../12.png
						../13.png


The vulnerability can be exploited by remote attackers with & without required user inter action. For demonstration or reproduce ...

PoC:

็¬็ส็็็็็ -็็็็็็็็็็็็็็็็็็็็ส็¬็็็็็็็็¬็็็็็็็็็็็็็็็็ส็็็็¬็็็็็็็็็-็็็็็็็ ็็็็็ส็็็็็็็¬็็็็็็็็็็¬็็็็็็็็ส็็็็็็็็็็¬็็็็็็็็็็็ ¬็็็็ส็็็็็็็็็็็็็¬็็็็ ็็็็็็็็¬ส็็็็็็็็็็็็็็็็-็็็็็็็็็ส็็็็็็็็็็็็็็็็็็็ ¬็็็็็็ส็็็็็็็¬ส็็็็็็็็็็็็็็็็็็็็็็็็็ส็็็¬¬็็็็็็็็็็็็็็็็็็็็็็ส็็็็็็¬็ 

or as callto link:

<!--
Skype 'Skype Me™!' button
http://www.skype.com/go/skypebuttons
-->
<script type="text/javascript" src="http://download.skype.com/share/skypebuttons/js/skypeCheck.js"></script>
<a href="skype:?<!--
Skype 'Skype Me™!' button
http://www.skype.com/go/skypebuttons
-->
<script type="text/javascript" src="http://download.skype.com/share/skypebuttons/js/skypeCheck.js"></script>
<a href="
skype:็¬็ส็็็็็ -็็็็็็็็็็็็็็็็็็็็ส็¬็็็็็็็็¬็็็็็็็็็็็็็็็็ส็็็็¬็็็็็็็็็-็็็็็็็ ็็็็็ส็็็็็็็¬็็็็็็็็็็¬็็็็็็็็ส็็็็็็็็็็¬็็็็็็็็็็็ ¬็็็็ส็็็็็็็็็็็็็¬็็็็ ็็็็็็็็¬ส็็็็็็็็็็็็็็็็-็็็็็็็็็ส็็็็็็็็็็็็็็็็็็็ ¬็็็็็็ส็็็็็็็¬ส็็็็็็็็็็็็็็็็็็็็็็็็็ส็็็¬¬็็็็็็็็็็็็็็็็็็็็็็ส็็็็็็¬็ ?call
"><img src="http://download.skype.com/share/skypebuttons/buttons/call_blue_white_124x52.png" style="border: none;" width="124" 
height="52" alt="Skype Me™!" /></a>
 ?call"><img src="http://download.skype.com/share/skypebuttons/buttons/call_blue_white_124x52.png" style="border: none;" 
width="124" height="52" alt="Skype Me™!" /></a>



Reference(s):
						../poc1.txt
						../poc2.txt
						../callto.txt

Solution:
=========
The attack vector has been removed in the old version (5.8.0.156) via hotfix and the issue is addressed by skype.

Update to Skype v5.8.0.158


Risk:
=====
The security risk of the remote denial of service vulnerability via pointer corruption is estimated as high(-).


Credits:
========
Vulnerability Research Laboratory - Benjamin Kunz Mejri (Rem0ve), Alexander Fuchs (f0x23) & Ucha Gobejishvili


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability-
Lab. Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of 
other media, are reserved by Vulnerability-Lab or its suppliers.

    						Copyright © 2012|Vulnerability-Lab

-- 
VULNERABILITY RESEARCH LABORATORY TEAM
Website: www.vulnerability-lab.com
Mail: research@vulnerability-lab.com

