Hello list!

I want to warn you about multiple security vulnerabilities in Enterprise
Java Beans Certificate Authority (EJBCA). These are Cross-Site Scripting,
Brute Force and Abuse of Functionality vulnerabilities.

EJBCA it's a PKI server. Citation from official web site: A Certification
Authority and a complete enterprise PKI management system, EJBCA is a PKI
server used to issue, manage and maintain digital certificates - with
exceptional flexibility and strength.

-------------------------
Affected products:
-------------------------

Vulnerable are EJBCA 4.0.7 and previous versions.

Developers have fixed this XSS vulnerability in new version EJBCA 4.0.8, 
which has been released at 09.02.2012, but at that they decided to not fix 
BF and AoF vulnerabilities, considering them as low risk. But I've suggested 
them to fix them too.

----------
Details:
----------

XSS (WASC-08):

http://site/ejbca/publicweb/webdist/certdist?cmd=revoked&issuer=%3Cscript%3Ealert(document.cookie)%3C/script%3E&serno=1

Brute Force (WASC-11):

http://site/ejbca/enrol/browser.jsp

http://site/ejbca/enrol/server.jsp

http://site/ejbca/enrol/keystore.jsp

http://site/ejbca/enrol/cvcert.jsp

Abuse of Functionality (Login enumeration) (WASC-42):

Login enumeration is possible in above-mentioned four functionalities. In
these forms different messages are shown at correct and incorrect login,
which allows to enumeration logins of the users.

------------
Timeline:
------------

2012.01.17 - found vulnerabilities.
2012.02.01 - announced at my site.
2012.02.05 - informed developers.
2012.02.09 - developers released version EJBCA 4.0.8 with fixed XSS
(http://primekey.se/News/All+Releases/Release+detail/EJBCA_4.0.8_release_Feb_2012.cid3129).
2012.03.10 - disclosed at my site.

I mentioned about these vulnerabilities at my site
(http://websecurity.com.ua/5646/).

Best wishes & regards,
MustLive
Administrator of Websecurity web site
http://websecurity.com.ua

