Title:
======
Astaro Security Gateway v7.504 - Multiple Web Vulnerabilities


Date:
=====
2012-04-08


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=8


VL-ID:
=====
8


Introduction:
=============
Das Astaro Security Gateway 625 wurde speziell für den Schutz großer Unternehmen konzipiert. 
Basierend auf hochwertigen Intel-kompatiblen Serversystemen, einschließlich Dual IntelTM Xeon-Multi-Core-Prozessoren 
sowie redundanten Highspeed-Festplatten, bietet es selbst für die herausforderndsten Umgebungen optimale Performance 
und Zuverlässigkeit. Dieser Abschnitt beschreibt detailliert die verfügbaren Sicherheitsanwendungen, technischen 
Einzelheiten und Einsatzszenarien.

(Copy of the Vendor Homepage: https://www.astaro.com/de-de/produkte/hardware-appliance/astaro-security-gateway-625)


Abstract:
=========
The vulnerability research team discovers multiple input validation vulnerabilities on Astaros Security Web Gateway v7.504.


Report-Timeline:
================
2011-01-13: Verified by Vulnerability-Lab
2011-06-15: Secure Vendor Notification
2011-11-17: Vendor Reply/Feedback
2012-03-09: Fix/Patch by Vulnerability Lab Check
2012-04-08: Discovery by Vulnerability-Lab


Status:
========
Published


Affected Products:
==================

Exploitation-Technique:
=======================
Remote


Severity:
=========
Medium


Details:
========
Multiple persistent Input Validation Vulnerabilities are detected on the Astaros Security Gateway application(appliance).
The vulnerability allows a local low privileged user account or remote attacker with medium required user inter action to manipulate 
module contexts on application-side.  Result of successful exploitation is session hijacking, phishing & stable context manipulation
or client side target exploitation out of the gateway web application context.


Vulnerable Module(s):

			---- Management
  				-- System Settings (Time&Date | Shell Access) 

			---- Users
				  -- New User
				  -- New Group
				  -- Authentication / New Server


			---- Definitions
				  -- New Interface
				  -- Comment Static Route
				  -- OSPF Interface Settings
				  -- View/Edit Traffic Selector
 				  -- New PIM-SM Interface
				  -- New Rendezvous Point Router
				  -- Uplink Monitoring

	
			---- Network
				  -- New Network & Listing
				  -- New Service Definition
				  -- New Time Event Definition

Affected:
                                   Astaro Security Web Gateway v7.504
                                   Astaro Security Web Gateway v8.x | 2011 Q1-4
                                   -  110, 120, 220, 320, 425, 525 & 625


Pictures:
			../1.png
			../2.png
			../3.png
			../4.png
			../5.png


Proof of Concept:
=================
The vulnerabilities can be exploited by local attackers with restricted accounts or with medium user inter-action on the remote way.
For demonstration or reproduce ...


Code Review: Users - User Listing

<div style="display: inline; vertical-align: middle; white-space: nowrap; padding: 4px 2px 4px 0px;">>"<INCLUDE PERSISTENT SCRIPTCODE HERE!!!>
</div> <span>Known IP addresses of user '>"<INCLUDE PERSISTENT SCRIPTCODE HERE!!!>'</iframe></span>



Code Review: Add New Network Listing

<td style="font-weight: bold; padding-right: 4px; width: 300px;"><span>>"<INCLUDE PERSISTENT SCRIPTCODE HERE!!!> 
(User Network)</iframe></span></td>



Code Review: Site to Site VPN - Certificate Listing

<span>WebAdmin certificate for >"<INCLUDE PERSISTENT SCRIPTCODE HERE!!!>.astaro.com</iframe></span>



Code Review: Extra RBL Zones - AntiSpam

<div style="overflow: hidden; font-size: 10px; margin: 0px; width: 212px; color: darkgreen;">>"<INCLUDE PERSISTENT SCRIPTCODE HERE!!!></frame>
</div><td><img src="core/img/icons/trash.png" stlye="margin:0px 2px 0px 0px;cursor:pointer;" class="
listMember_btnTrash" height="16" width="16"></td>


Solution:
=========
Upgrade available since January 2012 (Sophos)


Risk:
=====
The security risk of the persistent input validation vulnerabilities are estimated as medium(+)/(-)high.


Credits:
========
Vulnerability Research Laboratory  - Benjamin Kunz Mejri (Rem0ve) & Pim J.F.P. Campers (X4lt)


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability-
Lab. Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of 
other media, are reserved by Vulnerability-Lab or its suppliers.

    						Copyright © 2012|Vulnerability-Lab




-- 
VULNERABILITY RESEARCH LABORATORY TEAM
Website: www.vulnerability-lab.com
Mail: research@vulnerability-lab.com

