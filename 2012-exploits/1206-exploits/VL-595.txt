Title:
======
Jobs Portal v3.0 NetArtMedia - Multiple Web Vulnerabilites


Date:
=====
2012-06-06


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=595


VL-ID:
=====
595


Common Vulnerability Scoring System:
====================================
8.3


Introduction:
=============
Jobs Portal is a web product for running powerful and customized job portals. The product may be used also to 
empower existing websites with jobs portal functionality. Jobs Portal comes with a front site (fully customizable 
and template based), jobseekers administration space (with functionality for the users to edit their profile, 
consult the job offers, manage their resume etc.), employers administration space (allowing the employers to post 
job ads, manage their company profile, search the database with the jobseekers resumes and many others) and powerful 
back office for the administrators (providing full control over the website, structure and content management, 
detailed user management, search engines reports, statistics and many others).


Abstract:
=========
The Vulnerability Laboratory Research Team discovered multiple web vulnerabilities in Jobs Portal v3.0, a powerful jobs board software.


Report-Timeline:
================
2012-06-06:	Public or Non-Public Disclosure


Status:
========
Published


Exploitation-Technique:
=======================
Remote


Severity:
=========
Critical


Details:
========
1.1
A SQL Injection vulnerability is detected in Jobs Portal v3.0, a powerful jobs board software.
The vulnerability allows an attacker (remote) or local low privileged user account to inject/execute own sql commands 
on the affected application dbms. Successful exploitation of the vulnerability results in dbms & application compromise.
The sql injection bug is located on the apply_id parameter request in the index.php file.

Vulnerable File(s):
			[+] index.php

Vulnerable Parameter(s):
			[+] category=application_management&folder=my&page=details&posting_id=113&apply_id=


1.2
A persistent input validation vulnerability is detected in Jobs Portal v3.0.
The bugs allow remote attackers to implement/inject malicious script code on the application side (persistent). 
Successful exploitation of the vulnerability can lead to session hijacking (manager/admin) or stable (persistent) 
context manipulation. Exploitation requires low user inter action & privileged user account.


Vulnerable Module(s):
			[+]/JOBSEEKERS/index.php?category=profile&action=edit [First Name]-[Last Name]-[Address]
			[+]/JOBSEEKERS/index.php?category=jobmail&action=rules - adding rule - [Title]
			[+]/JOBSEEKERS/index.php?category=documents&action=list - adding file - [Description]

			[+]/EMPLOYERS/index.php?category=profile&action=current- [Company] - [Company Description] - [Contact Person] - [Address] - [Web site]
			[+]/EMPLOYERS/index.php?category=postings&action=add - [Title] - [Text]
			[+]/EMPLOYERS/index.php?category=postings&folder=banners&page=edit&id=43 - [Name] - [Link]
			[+]/EMPLOYERS/index.php?category=application_management&folder=list&page=reply&Proceed=approve&id=65&posting_id=88 - [ Reason ] in case you 			accept an applicant or you reject him


Proof of Concept:
=================
1.1
The sql injection vulnerability can be exploited by remote attackers without user inter action. For demonstration or reproduce ...

PoC:
http://127.0.0.1:80/EMPLOYERS/index.php?category=application_management&folder=my&page=details&posting_id=113&apply_id=68+order+%20by+1--%20[SQL INJECTION]--


1.2
The persistent input validation vulnerabilities can be exploited by remote attackers with low required user inter action.
For demonstration or reproduce ...

There are many strategies to launch an attack against the admin ...

1.
Attacker: The attacker can create an account and inject  malicious script code in his First name, Last name, and if he uploaded a file. 
Target: When the admin or a job seekers opens the attacker profile, the script code will be executed out of the web context listing.

2.
Attacker: The employer can add a job and inject malicious script code in the job title and the text that describes the job. 
Target: When the admin or boss is watching the job incoming to verify them the malicious script code will be executed out of the web context listing.


Risk:
=====
1.1
The security risk of the sql injection vulnerability is estimated as critical.

1.2
The security risk of the persistent input validation vulnerabilities are estimated as medium(+).


Credits:
========
Vulnerability Laboratory [Research Team]  -    Ibrahim El-Sayed [the stOrM) (storm@vulnerability-lab.com)


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. 

Domains:	www.vulnerability-lab.com   	- www.vuln-lab.com
Contact:	admin@vulnerability-lab.com 	- support@vulnerability-lab.com 	- research@vulnerability-lab.com
Section:	video.vulnerability-lab.com 	- forum.vulnerability-lab.com 		- news.vulnerability-lab.com
Social:		twitter.com/#!/vuln_lab 	- facebook.com/VulnerabilityLab 	- youtube.com/user/vulnerability0lab

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. 
Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other 
media, are reserved by Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, sourcecode, videos and 
other information on this website is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), 
modify, use or edit our material contact (admin@vulnerability-lab.com or support@vulnerability-lab.com) to get a permission.

    						Copyright © 2012 Vulnerability-Lab




-- 
VULNERABILITY RESEARCH LABORATORY TEAM
Website: www.vulnerability-lab.com
Mail: research@vulnerability-lab.com

