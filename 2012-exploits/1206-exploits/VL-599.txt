Title:
======
Simple Forum PHP 2.1 - SQL Injection Vulnerabilities


Date:
=====
2012-06-10


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=599


VL-ID:
=====
599


Common Vulnerability Scoring System:
====================================
7.5


Introduction:
=============
Simple Forum PHP is a script that is very easy to install and administer.
Visitors to your forum will be able to post new topics as well as discuss and reply to other topics.
The administration section of the script was made for user simplicity. By utilizing menu items, 
categories and features—anyone with little to no knowledge of websites or programming can easily get 
their forum to function and look just like they want.
Simple Forum PHP features:

    password protected admin area with multiple options and features that you can control
    multiple language support
    visual(css) style control in admin area
    control the number of topics per page
    option to approve topics/replies before having them posted
    visitors are able to upload Icon(Avatar image) per each topics or reply
    choose order (assending or descending) of replies
    counter for the number of replies for each topic
    views counter for each topic
    option to receive email notices of new topics or replies that are posted
    ability to send email approval notice to the forum user when posting a topic or reply
    allowable HTML tags options for images, links, embeded vodeos etc...
    option to choose the type of anti-spam code - reCaptcha, math captcha and simple captcha
    breaking long(spam) words
    ability to create a list of banned words which will prevent unwanted words from being posted
    html and javascript injection prevent
    RSS Feed with links to topics
    simple and readable php source code
    easy to place on your webpage - copy and paste a single line of code
    we provide free email support for script installation and setup


Simple Forum PHP minimum requirements are: PHP and MySQL running on your web server. Current stable 
version of Simple Forum PHP is 2.1 (May 19, 2012)

(Copy of the Vendor Homepage: http://www.simpleforumphp.com )


Abstract:
=========
The Vulnerability Laboratory Research Team discovered multiple SQL Injection vulnerabilites in Simple Forum PHP v2.1 CMS.


Report-Timeline:
================
2012-06-10:	Public or Non-Public Disclosure


Status:
========
Published


Exploitation-Technique:
=======================
Remote


Severity:
=========
High


Details:
========
Multiple SQL Injection vulnerabilities  are detected in Simple Forum PHP v2.1 Content Management System.
The vulnerability allows an attacker (remote) or local low privileged user account to inject/execute own sql commands 
on the affected application dbms without user inter action. Successful exploitation of the vulnerability results in 
dbms & application compromise. The vulnerabilities are located in the forum.php and admin.php files and bound parameters 
orderType, orderBy, & p. The vulnerability in forum.php can be exploited by remote attackers without required user 
inter action or privileged user account. A privileged user account is required to the exploit the sql bug in the admin.php.

Vulnerable File(s):
				[+] forum.php
				[+] admin.php

Vulnerable Parameter(s):
				[+] orderType
				[+] orderBy
				[+] p


Proof of Concept:
=================
The sql injection vulnerabilities can be exploited by remote attacker with and without privileged user account. 
For demonstration or reproduce ...

http://127.0.0.1/cms/forum.php?p=-1 [SQL-INJECTION]--
http://127.0.0.1/cms/forum.php?orderType=-1 [SQL-INJECTION]--
http://127.0.0.1/cms/forum.php?orderType=[ASC/DESC]&orderBy=-1 [SQL-INJECTION]--

http://127.0.0.1/cms/forum/admin.php?act=topics&orderType=-1 [SQL-INJECTION]--
http://127.0.0.1/cms/forum/admin.php?act=topics&orderType=[ASC/DESC]&search=&orderBy=-1 [SQL-INJECTION]--
http://127.0.0.1/cms/forum/admin.php?act=replies&topic_id=&orderType=-1 [SQL-INJECTION]--
http://127.0.0.1/cms/forum/admin.php?act=replies&topic_id=&orderType=[ASC/DESC]&search=&orderBy=-1 [SQL-INJECTION]--


Risk:
=====
The security risk of the sql injection vulnerabilities are estimated as critical.


Credits:
========
Vulnerability Laboratory [Research Team]  -    snup (snup@vulnerability-lab.com) [http://snup1.blogspot.com]



Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. 

Domains:	www.vulnerability-lab.com   	- www.vuln-lab.com
Contact:	admin@vulnerability-lab.com 	- support@vulnerability-lab.com 	- research@vulnerability-lab.com
Section:	video.vulnerability-lab.com 	- forum.vulnerability-lab.com 		- news.vulnerability-lab.com
Social:		twitter.com/#!/vuln_lab 	- facebook.com/VulnerabilityLab 	- youtube.com/user/vulnerability0lab

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. 
Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other 
media, are reserved by Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, sourcecode, videos and 
other information on this website is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), 
modify, use or edit our material contact (admin@vulnerability-lab.com or support@vulnerability-lab.com) to get a permission.

    						Copyright © 2012 Vulnerability-Lab




-- 
VULNERABILITY RESEARCH LABORATORY TEAM
Website: www.vulnerability-lab.com
Mail: research@vulnerability-lab.com

