Title:
======
Lepton v1.2.0 CMS - Multiple Web Vulnerabilities


Date:
=====
2012-06-23


References:
===========
http://www.vulnerability-lab.com/get_content.php?id=626


VL-ID:
=====
626


Common Vulnerability Scoring System:
====================================
4


Introduction:
=============
LEPTON is an easy-to-use but full customizable Content Management System (CMS). LEPTON enables you to run nearly all 
the websites most others current CMS promise you but has the big advantage of extremely short learning and training 
curves, and this is a great argument to those who work with LEPTON. LEPTON needs a MySQL database, the most common 
database on webspaces. LEPTON is easily installed and started, and - what is really important - can easily be adapted 
to fit the needs of nearly all web appearences. Besides many other features LEPTON got  ...

    easy to use backend
    content input via wysiwyg-editors
    multi-language-support
    file and media management
    design via template system
    addons to extend cms
    scaling access system
    and much more...

(Copy of the Vendor Homepage: http://www.lepton-cms.org/english.php?lang=EN )


Abstract:
=========
The Vulnerability Laboratory Research Team discovered multiple Web Vulnerabilities in the Lepton v1.2.0 Content Management System.


Report-Timeline:
================
2012-06-23:	Public or Non-Public Disclosure


Status:
========
Published


Exploitation-Technique:
=======================
Remote


Severity:
=========
Medium


Details:
========
Multiple persistent input validation vulnerabilities are detected in iScripts Reserve Logic v1.2 Booking Content Management System.
The bugs allow remote attackers to implement/inject malicious script code on the application side (persistent). The persistent 
vulnerabilities are located in the modify groups, add user, listing, Profile & add page module(s) with the bound vulnerable parameters 
Groupname, Username, Display Name & list_page_title. Exploitation requires low user inter action & privileged application user account. 
Successful exploitation of the vulnerability can lead to session hijacking (admin) or stable (persistent) context manipulation. 


Vulnerable Module(s):
				[+] Modify Groups - Group
				[+] Access - Add User
				[+] Preferences - My Settings - Profile
				[+] Add Page

Vulnerable Parameter(s):
				[+] Group Name
				[+] Username
				[+] Display Name
				[+] list_page_title & url (modify_link)


Proof of Concept:
=================
The persistent web vulnerabilities can be exploited by remote attacker with privileged user account or without user account.
To exploit the vulnerability low or medium user inter action is required. For demonstration or reproduce ...


Review: Access - Add User > Username

<form name="user" action="http://demo.xxx.com/lepton/admins/users/add.php?leptoken=462c08f506b7992a08a40z1340321337" method="post" class="">
<input name="user_id" value="" type="hidden">
<input name="username_fieldname" value="username_Age0ll2" type="hidden">
<p>Minimum length for user name: 3 chars, Minimum length for Password: 6 chars!</p>
<table 0"="" border="0" cellpadding="0 cellspacing=" width="100%">
<tbody><tr>
<td width="150">Username:</td>
<td class="value_input">
<input name="username_Age0ll2" value="\" type="text"><[PERSISTENT INJECTED SCRIPT CODE])' <"="">
</td>
</tr>
<tr>
<td>Password:</td>
<td class="value_input">
<input type="password" name="password" value=""><[PERSISTENT INJECTED SCRIPT CODE]) <" />
</td>
</tr>
<tr>
<td>Re-type Password:</td>
<td class="value_input">
<input type="password" name="password2" value=""><[PERSISTENT INJECTED SCRIPT CODE]<" />
</td>


URL: http://127.0.0.1:8080/lepton/admins/users/index.php?leptoken=0644c1632f2de642c422az1340321400



Review: Preferences - My Settings - Profile > Displayname

<optgroup label="Pages"><option value="pages/modify.php?page_id=2" selected="selected">
"><[PERSISTENT INJECTED SCRIPT CODE]<</option>
<option value="pages/modify.php?page_id=1">hello world</option>
</optgroup></select>


URL: http://127.0.0.1:8080/lepton/admins/preferences/index.php?leptoken=43842ae95ec290c5dc346z1340321767




Review: Modify Groups - Group

<table border="0" cellpadding="2" cellspacing="0" width="100%">
<tbody><tr>
<td width="150">Name:</td>
<td>
<input name="group_name" maxlength="255" type="text"><[PERSISTENT INJECTED SCRIPT CODE]' <"="" style="width: 98%;">
</td>


URL: http://127.0.0.1:8080/lepton/admins/groups/groups.php?leptoken=b966d35413402c86743a7z1340321327




Review: Add Page - Listing (url or link)

<img src="index.php2-Dateien/visible_16.png" alt="Visibility: Public" class="page_list_rights">
<span class="modify_link">"><[PERSISTENT INJECTED SCRIPT CODE]") <</span></a>
</td>
<td class="list_page_title">"><[PERSISTENT INJECTED SCRIPT CODE]") <</td>
<td class="list_page_URL">/hello-world/[PERSISTENT INJECTED SCRIPT CODE]28vl29.php</td>        
<td class="list_page_id">2</td>


URL: http://127.0.0.1:8080/lepton/admins/pages/index.php?leptoken=aa02a5f10be74d8702542z1340321827


Risk:
=====
The security risk of the persistent input validation vulnerabilities are estimated as medium.


Credits:
========
Vulnerability Laboratory [Research Team]  - Benjamin Kunz Mejri (bkm@vulnerability-lab.com)
Vulnerability Laboratory [Research Team]  - Ibrahim El-Sayed [storm] (strom@vulnerability-lab.com)


Disclaimer:
===========
The information provided in this advisory is provided as it is without any warranty. Vulnerability-Lab disclaims all warranties, 
either expressed or implied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-
Lab or its suppliers are not liable in any case of damage, including direct, indirect, incidental, consequential loss of business 
profits or special damages, even if Vulnerability-Lab or its suppliers have been advised of the possibility of such damages. Some 
states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation 
may not apply. 

Domains:	www.vulnerability-lab.com   	- www.vuln-lab.com
Contact:	admin@vulnerability-lab.com 	- support@vulnerability-lab.com 	- research@vulnerability-lab.com
Section:	video.vulnerability-lab.com 	- forum.vulnerability-lab.com 		- news.vulnerability-lab.com
Social:		twitter.com/#!/vuln_lab 	- facebook.com/VulnerabilityLab 	- youtube.com/user/vulnerability0lab

Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. 
Permission to electronically redistribute this alert in its unmodified form is granted. All other rights, including the use of other 
media, are reserved by Vulnerability-Lab Research Team or its suppliers. All pictures, texts, advisories, sourcecode, videos and 
other information on this website is trademark of vulnerability-lab team & the specific authors or managers. To record, list (feed), 
modify, use or edit our material contact (admin@vulnerability-lab.com or support@vulnerability-lab.com) to get a permission.

    						Copyright © 2012 Vulnerability-Lab

-- 
VULNERABILITY RESEARCH LABORATORY TEAM
Website: www.vulnerability-lab.com
Mail: research@vulnerability-lab.com

