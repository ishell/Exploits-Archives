
Digital Security Research Group [DSecRG] Advisory       #DSECRG-08-008


Application:                    Txp CMS
Versions Affected:              4.0.5
Vendor URL:                     http://www.textpattern.com
Bugs:                           DOS, multiple XSS, etc.
Exploits:                       YES
Reported:                       11.01.2008
Vendor response:                14.01.2008
Patch Released:                 03.02.2008
Date of Public Advisory:        04.02.2008
Authors:                        Alexandr Polyakov, Stas Svistunovich
                                Digital Security Research Group [DSecRG] (research [at] dsec [dot] ru)



Description
***********

Textpattern system has multiple security vulnerabilities:

1. Parameter Value Overflow
2. Linked XSS
3. XSS in POST
4. Stored XSS
5. Insecure password changing algorithm


Details
*******

1. Parameter Value Overflow

Vulnerability found in script index.php in comments section. Post parameter "message".

The application does not ensure that the parameter value length. It can be used for performing a DOS attack. 


Example:

message = [A]x10000

--------------------------------------------------------------------------------------------


2. Linked XSS vulnerability found in /textpattern/setup/index.php, attacker can inject XSS in URL string.


Example:

http://[server]/[installdir]/textpattern/setup/index.php/"><script>alert('DSecRG XSS')</script>

--------------------------------------------------------------------------------------------


3. XSS in POST

Vulnerability found in script index.php in comments section. Post parameter "name".


Example:

name = <img src="javascript:alert('DSecRG XSS')">

name = <script>alert('DSecRG XSS')</script>

--------------------------------------------------------------------------------------------


4. Stored XSS

Vulnerability found in script textpattern/index.php?event=article in post parameter "Body". 


Example:

Body = <IMG SRC=javascript:alert(&quot;DSecRG_XSS&quot;)>

--------------------------------------------------------------------------------------------


5. Insecure password changing algorithm

Previous password not required to set a new password.

If attacker gain access to admin session by using XSS vulnerability, he can change admin password without knowing old password.

It will be more secure to ask old password when changing password or primary email.


Fix Information
***************

Textpattern was altered to fix this flaw on 03.02.2008. Updated version (4.0.6) can be downloaded here:
        http://textpattern.com/download



About
*****

Digital Security is leading IT security company in Russia, providing information security consulting, audit and penetration testing services, risk analysis and ISMS-related services and certification for ISO/IEC 27001:2005 and PCI DSS standards. Digital Security Research Group focuses on web application and database security problems with vulnerability reports, advisories and whitepapers posted regularly on our website.


Contact:        research [at] dsec [dot] ru
                http://www.dsec.ru (in Russian)



-- 

  Digital Security Research Group  mailto:research@dsec.ru
